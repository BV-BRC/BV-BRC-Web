!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";n(136),t.exports=n(53)},function(t,e,n){(function(e){!function(e,n){t.exports=n()}(this,function(){function t(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),i=Array(n),r=0;r<n;r++)i[r]=arguments[r+e];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var o=Array(e+1);for(r=0;r<e;r++)o[r]=arguments[r];return o[e]=i,t.apply(this,o)}}function n(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function i(t){return null===t}function r(t){return void 0===t}function o(t){return t===!0||t===!1||"[object Boolean]"===he.call(t)}function s(t){return!(!t||1!==t.nodeType)}function a(t){var e="[object "+t+"]";return function(t){return he.call(t)===e}}function l(t){return null!=t&&Le(t.getInt8)&&Te(t.buffer)}function h(t,e){return null!=t&&ue.call(t,e)}function u(t){return!ze(t)&&be(t)&&!isNaN(parseFloat(t))}function c(t){return Se(t)&&ve(t)}function f(t){return function(){return t}}function d(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=we}}function g(t){return function(e){return null==e?void 0:e[t]}}function p(t){return me?me(t)&&!Oe(t):We(t)&&Be.test(he.call(t))}function m(t){for(var e={},n=t.length,i=0;i<n;++i)e[t[i]]=!0;return{contains:function(t){return e[t]===!0},push:function(n){return e[n]=!0,t.push(n)}}}function v(t,e){e=m(e);var n=ye.length,i=t.constructor,r=Le(i)&&i.prototype||oe,o="constructor";for(h(t,o)&&!e.contains(o)&&e.push(o);n--;)o=ye[n],o in t&&t[o]!==r[o]&&!e.contains(o)&&e.push(o)}function b(t){if(!n(t))return[];if(ge)return ge(t);var e=[];for(var i in t)h(t,i)&&e.push(i);return xe&&v(t,e),e}function x(t){if(null==t)return!0;var e=Ve(t);return"number"==typeof e&&(Ie(t)||_e(t)||He(t))?0===e:0===Ve(b(t))}function y(t,e){var n=b(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;o<i;o++){var s=n[o];if(e[s]!==r[s]||!(s in r))return!1}return!0}function w(t){return t instanceof w?t:this instanceof w?void(this._wrapped=t):new w(t)}function _(t){return new Uint8Array(t.buffer||t,t.byteOffset||0,De(t))}function S(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return!1;if(t!==t)return e!==e;var r=typeof t;return("function"===r||"object"===r||"object"==typeof e)&&C(t,e,n,i)}function C(t,e,n,i){t instanceof w&&(t=t._wrapped),e instanceof w&&(e=e._wrapped);var r=he.call(t);if(r!==he.call(e))return!1;if(qe&&"[object Object]"==r&&Oe(t)){if(!Oe(e))return!1;r=Ue}switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return se.valueOf.call(t)===se.valueOf.call(e);case"[object ArrayBuffer]":case Ue:return C(_(t),_(e),n,i)}var o="[object Array]"===r;if(!o&&Pe(t)){var s=De(t);if(s!==De(e))return!1;if(t.buffer===e.buffer&&t.byteOffset===e.byteOffset)return!0;o=!0}if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,l=e.constructor;if(a!==l&&!(Le(a)&&a instanceof a&&Le(l)&&l instanceof l)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),o){if(u=t.length,u!==e.length)return!1;for(;u--;)if(!S(t[u],e[u],n,i))return!1}else{var c,f=b(t);if(u=f.length,b(e).length!==u)return!1;for(;u--;)if(c=f[u],!h(e,c)||!S(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0}function E(t,e){return S(t,e)}function k(t){if(!n(t))return[];var e=[];for(var i in t)e.push(i);return xe&&v(t,e),e}function z(t){var e=Ve(t);return function(n){if(null==n)return!1;var i=k(n);if(Ve(i))return!1;for(var r=0;r<e;r++)if(!Le(n[t[r]]))return!1;return t!==$e||!Le(n[Ge])}}function T(t){for(var e=b(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i}function j(t){for(var e=b(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i}function M(t){for(var e={},n=b(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e}function L(t){var e=[];for(var n in t)Le(t[n])&&e.push(n);return e.sort()}function R(t,e){return function(n){var i=arguments.length;if(e&&(n=Object(n)),i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],s=t(o),a=s.length,l=0;l<a;l++){var h=s[l];e&&void 0!==n[h]||(n[h]=o[h])}return n}}function q(){return function(){}}function A(t){if(!n(t))return{};if(pe)return pe(t);var e=q();e.prototype=t;var i=new e;return e.prototype=null,i}function N(t,e){var n=A(t);return e&&on(n,e),n}function O(t){return n(t)?Ie(t)?t.slice():rn({},t):t}function I(t,e){return e(t),t}function F(t){return Ie(t)?t:[t]}function H(t){return w.toPath(t)}function D(t,e){for(var n=e.length,i=0;i<n;i++){if(null==t)return;t=t[e[i]]}return n?t:void 0}function W(t,e,n){var i=D(t,H(e));return r(i)?n:i}function B(t,e){e=H(e);for(var n=e.length,i=0;i<n;i++){var r=e[i];if(!h(t,r))return!1;t=t[r]}return!!n}function P(t){return t}function V(t){return t=on({},t),function(e){return y(e,t)}}function U(t){return t=H(t),function(e){return D(e,t)}}function G(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}}function X(t,e,i){return null==t?P:Le(t)?G(t,e,i):n(t)&&!Ie(t)?V(t):U(t)}function J(t,e){return X(t,e,1/0)}function Z(t,e,n){return w.iteratee!==J?w.iteratee(t,e):X(t,e,n)}function Y(t,e,n){e=Z(e,n);for(var i=b(t),r=i.length,o={},s=0;s<r;s++){var a=i[s];o[a]=e(t[a],a,t)}return o}function $(){}function K(t){return null==t?$:function(e){return W(t,e)}}function Q(t,e,n){var i=Array(Math.max(0,t));e=G(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i}function tt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}function et(t){var e=function(e){return t[e]},n="(?:"+b(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}}function nt(t){return"\\"+gn[t]}function it(t,e,n){!e&&n&&(e=n),e=sn({},e,w.templateSettings);var i=RegExp([(e.escape||dn).source,(e.interpolate||dn).source,(e.evaluate||dn).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,s,a){return o+=t.slice(r,a).replace(pn,nt),r=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n";var s=e.variable;if(s){if(!mn.test(s))throw new Error("variable is not a bare identifier: "+s)}else o="with(obj||{}){\n"+o+"}\n",s="obj";o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";var a;try{a=new Function(s,"_",o)}catch(t){throw t.source=o,t}var l=function(t){return a.call(this,t,w)};return l.source="function("+s+"){\n"+o+"}",l}function rt(t,e,n){e=H(e);var i=e.length;if(!i)return Le(n)?n.call(t):n;for(var r=0;r<i;r++){var o=null==t?void 0:t[e[r]];void 0===o&&(o=n,r=i),t=Le(o)?o.call(t):o}return t}function ot(t){var e=++vn+"";return t?t+e:e}function st(t){var e=w(t);return e._chain=!0,e}function at(t,e,i,r,o){if(!(r instanceof e))return t.apply(i,o);var s=A(t.prototype),a=t.apply(s,o);return n(a)?a:s}function lt(t,e,n,i){if(i=i||[],e||0===e){if(e<=0)return i.concat(t)}else e=1/0;for(var r=i.length,o=0,s=Ve(t);o<s;o++){var a=t[o];if(yn(a)&&(Ie(a)||He(a)))if(e>1)lt(a,e-1,n,i),r=i.length;else for(var l=0,h=a.length;l<h;)i[r++]=a[l++];else n||(i[r++]=a)}return i}function ht(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return h(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n}function ut(t,e,n){var i,r,o,s,a=0;n||(n={});var l=function(){a=n.leading===!1?0:an(),i=null,s=t.apply(r,o),i||(r=o=null)},h=function(){var h=an();a||n.leading!==!1||(a=h);var u=e-(h-a);return r=this,o=arguments,u<=0||u>e?(i&&(clearTimeout(i),i=null),a=h,s=t.apply(r,o),i||(r=o=null)):i||n.trailing===!1||(i=setTimeout(l,u)),s};return h.cancel=function(){clearTimeout(i),a=0,i=r=o=null},h}function ct(e,n,i){var r,o,s,a,l,h=function(){var t=an()-o;n>t?r=setTimeout(h,n-t):(r=null,i||(a=e.apply(l,s)),r||(s=l=null))},u=t(function(t){return l=this,s=t,o=an(),r||(r=setTimeout(h,n),i&&(a=e.apply(l,s))),a});return u.cancel=function(){clearTimeout(r),r=s=l=null},u}function ft(t,e){return bn(e,t)}function dt(t){return function(){return!t.apply(this,arguments)}}function gt(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}}function pt(t,e){return function(){if(--t<1)return e.apply(this,arguments)}}function mt(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}function vt(t,e,n){e=Z(e,n);for(var i,r=b(t),o=0,s=r.length;o<s;o++)if(i=r[o],e(t[i],i,t))return i}function bt(t){return function(e,n,i){n=Z(n,i);for(var r=Ve(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(n(e[o],o,e))return o;return-1}}function xt(t,e,n,i){n=Z(n,i,1);for(var r=n(e),o=0,s=Ve(t);o<s;){var a=Math.floor((o+s)/2);n(t[a])<r?o=a+1:s=a}return o}function yt(t,e,n){return function(i,r,o){var s=0,a=Ve(i);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=e(le.call(i,s,a),c),o>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(i[o]===r)return o;return-1}}function wt(t,e,n){var i=yn(t)?En:vt,r=i(t,e,n);if(void 0!==r&&r!==-1)return t[r]}function _t(t,e){return wt(t,V(e))}function St(t,e,n){e=G(e,n);var i,r;if(yn(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var o=b(t);for(i=0,r=o.length;i<r;i++)e(t[o[i]],o[i],t)}return t}function Ct(t,e,n){e=Z(e,n);for(var i=!yn(t)&&b(t),r=(i||t).length,o=Array(r),s=0;s<r;s++){var a=i?i[s]:s;o[s]=e(t[a],a,t)}return o}function Et(t){var e=function(e,n,i,r){var o=!yn(e)&&b(e),s=(o||e).length,a=t>0?0:s-1;for(r||(i=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var l=o?o[a]:a;i=n(i,e[l],l,e)}return i};return function(t,n,i,r){var o=arguments.length>=3;return e(t,G(n,r,4),i,o)}}function kt(t,e,n){var i=[];return e=Z(e,n),St(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i}function zt(t,e,n){return kt(t,dt(Z(e)),n)}function Tt(t,e,n){e=Z(e,n);for(var i=!yn(t)&&b(t),r=(i||t).length,o=0;o<r;o++){var s=i?i[o]:o;if(!e(t[s],s,t))return!1}return!0}function jt(t,e,n){e=Z(e,n);for(var i=!yn(t)&&b(t),r=(i||t).length,o=0;o<r;o++){var s=i?i[o]:o;if(e(t[s],s,t))return!0}return!1}function Mt(t,e,n,i){return yn(t)||(t=T(t)),("number"!=typeof n||i)&&(n=0),zn(t,e,n)>=0}function Lt(t,e){return Ct(t,U(e))}function Rt(t,e){return kt(t,V(e))}function qt(t,e,n){var i,r,o=-(1/0),s=-(1/0);if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=yn(t)?t:T(t);for(var a=0,l=t.length;a<l;a++)i=t[a],null!=i&&i>o&&(o=i)}else e=Z(e,n),St(t,function(t,n,i){r=e(t,n,i),(r>s||r===-(1/0)&&o===-(1/0))&&(o=t,s=r)});return o}function At(t,e,n){var i,r,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t){t=yn(t)?t:T(t);for(var a=0,l=t.length;a<l;a++)i=t[a],null!=i&&i<o&&(o=i)}else e=Z(e,n),St(t,function(t,n,i){r=e(t,n,i),(r<s||r===1/0&&o===1/0)&&(o=t,s=r)});return o}function Nt(t){return t?Ie(t)?le.call(t):_e(t)?t.match(Rn):yn(t)?Ct(t,P):T(t):[]}function Ot(t,e,n){if(null==e||n)return yn(t)||(t=T(t)),t[tt(t.length-1)];var i=Nt(t),r=Ve(i);e=Math.max(Math.min(e,r),0);for(var o=r-1,s=0;s<e;s++){var a=tt(s,o),l=i[s];i[s]=i[a],i[a]=l}return i.slice(0,e)}function It(t){return Ot(t,1/0)}function Ft(t,e,n){var i=0;return e=Z(e,n),Lt(Ct(t,function(t,n,r){return{value:t,index:i++,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")}function Ht(t,e){return function(n,i,r){var o=e?[[],[]]:{};return i=Z(i,r),St(n,function(e,r){var s=i(e,r,n);t(o,e,s)}),o}}function Dt(t){return null==t?0:yn(t)?t.length:b(t).length}function Wt(t,e,n){return e in n}function Bt(t,e,n){return le.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function Pt(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Bt(t,t.length-e)}function Vt(t,e,n){return le.call(t,null==e||n?1:e)}function Ut(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:Vt(t,Math.max(0,t.length-e))}function Gt(t){return kt(t,Boolean)}function Xt(t,e){return lt(t,e,!1)}function Jt(t,e,n,i){o(e)||(i=n,n=e,e=!1),null!=n&&(n=Z(n,i));for(var r=[],s=[],a=0,l=Ve(t);a<l;a++){var h=t[a],u=n?n(h,a,t):h;e&&!n?(a&&s===u||r.push(h),s=u):n?Mt(s,u)||(s.push(u),r.push(h)):Mt(r,h)||r.push(h)}return r}function Zt(t){for(var e=[],n=arguments.length,i=0,r=Ve(t);i<r;i++){var o=t[i];if(!Mt(e,o)){var s;for(s=1;s<n&&Mt(arguments[s],o);s++);s===n&&e.push(o)}}return e}function Yt(t){for(var e=t&&qt(t,Ve).length||0,n=Array(e),i=0;i<e;i++)n[i]=Lt(t,i);return n}function $t(t,e){for(var n={},i=0,r=Ve(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n}function Kt(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;o<i;o++,t+=n)r[o]=t;return r}function Qt(t,e){if(null==e||e<1)return[];for(var n=[],i=0,r=t.length;i<r;)n.push(le.call(t,i,i+=e));return n}function te(t,e){return t._chain?w(e).chain():e}function ee(t){return St(L(t),function(e){var n=w[e]=t[e];w.prototype[e]=function(){var t=[this._wrapped];return ae.apply(t,arguments),te(this,n.apply(w,t))}}),w}var ne="1.13.4",ie="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||Function("return this")()||{},re=Array.prototype,oe=Object.prototype,se="undefined"!=typeof Symbol?Symbol.prototype:null,ae=re.push,le=re.slice,he=oe.toString,ue=oe.hasOwnProperty,ce="undefined"!=typeof ArrayBuffer,fe="undefined"!=typeof DataView,de=Array.isArray,ge=Object.keys,pe=Object.create,me=ce&&ArrayBuffer.isView,ve=isNaN,be=isFinite,xe=!{toString:null}.propertyIsEnumerable("toString"),ye=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],we=Math.pow(2,53)-1,_e=a("String"),Se=a("Number"),Ce=a("Date"),Ee=a("RegExp"),ke=a("Error"),ze=a("Symbol"),Te=a("ArrayBuffer"),je=a("Function"),Me=ie.document&&ie.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof Me&&(je=function(t){return"function"==typeof t||!1});var Le=je,Re=a("Object"),qe=fe&&Re(new DataView(new ArrayBuffer(8))),Ae="undefined"!=typeof Map&&Re(new Map),Ne=a("DataView"),Oe=qe?l:Ne,Ie=de||a("Array"),Fe=a("Arguments");!function(){Fe(arguments)||(Fe=function(t){return h(t,"callee")})}();var He=Fe,De=g("byteLength"),We=d(De),Be=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,Pe=ce?p:f(!1),Ve=g("length");w.VERSION=ne,w.prototype.value=function(){return this._wrapped},w.prototype.valueOf=w.prototype.toJSON=w.prototype.value,w.prototype.toString=function(){return String(this._wrapped)};var Ue="[object DataView]",Ge="forEach",Xe="has",Je=["clear","delete"],Ze=["get",Xe,"set"],Ye=Je.concat(Ge,Ze),$e=Je.concat(Ze),Ke=["add"].concat(Je,Ge,Xe),Qe=Ae?z(Ye):a("Map"),tn=Ae?z($e):a("WeakMap"),en=Ae?z(Ke):a("Set"),nn=a("WeakSet"),rn=R(k),on=R(b),sn=R(k,!0);w.toPath=F,w.iteratee=J;var an=Date.now||function(){return(new Date).getTime()},ln={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},hn=et(ln),un=M(ln),cn=et(un),fn=w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},dn=/(.)^/,gn={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},pn=/\\|'|\r|\n|\u2028|\u2029/g,mn=/^\s*(\w|\$)+\s*$/,vn=0,bn=t(function(t,e){var n=bn.placeholder,i=function(){for(var r=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===n?arguments[r++]:e[a];for(;r<arguments.length;)s.push(arguments[r++]);return at(t,i,this,this,s)};return i});bn.placeholder=w;var xn=t(function(e,n,i){if(!Le(e))throw new TypeError("Bind must be called on a function");var r=t(function(t){return at(e,r,n,this,i.concat(t))});return r}),yn=d(Ve),wn=t(function(t,e){e=lt(e,!1,!1);var n=e.length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=e[n];t[i]=xn(t[i],t)}return t}),_n=t(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),Sn=bn(_n,w,1),Cn=bn(mt,2),En=bt(1),kn=bt(-1),zn=yt(1,En,xt),Tn=yt(-1,kn),jn=Et(1),Mn=Et(-1),Ln=t(function(t,e,n){var i,r;return Le(e)?r=e:(e=H(e),i=e.slice(0,-1),e=e[e.length-1]),Ct(t,function(t){var o=r;if(!o){if(i&&i.length&&(t=D(t,i)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)})}),Rn=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g,qn=Ht(function(t,e,n){h(t,n)?t[n].push(e):t[n]=[e]}),An=Ht(function(t,e,n){t[n]=e}),Nn=Ht(function(t,e,n){h(t,n)?t[n]++:t[n]=1}),On=Ht(function(t,e,n){t[n?0:1].push(e)},!0),In=t(function(t,e){var n={},i=e[0];if(null==t)return n;Le(i)?(e.length>1&&(i=G(i,e[1])),e=k(t)):(i=Wt,e=lt(e,!1,!1),t=Object(t));for(var r=0,o=e.length;r<o;r++){var s=e[r],a=t[s];i(a,s,t)&&(n[s]=a)}return n}),Fn=t(function(t,e){var n,i=e[0];return Le(i)?(i=dt(i),e.length>1&&(n=e[1])):(e=Ct(lt(e,!1,!1),String),i=function(t,n){return!Mt(e,n)}),In(t,i,n)}),Hn=t(function(t,e){return e=lt(e,!0,!0),kt(t,function(t){return!Mt(e,t)})}),Dn=t(function(t,e){return Hn(t,e)}),Wn=t(function(t){return Jt(lt(t,!0,!0))}),Bn=t(Yt);St(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=re[t];w.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),te(this,n)}}),St(["concat","join","slice"],function(t){var e=re[t];w.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),te(this,t)}});var Pn={__proto__:null,VERSION:ne,restArguments:t,isObject:n,isNull:i,isUndefined:r,isBoolean:o,isElement:s,isString:_e,isNumber:Se,isDate:Ce,isRegExp:Ee,isError:ke,isSymbol:ze,isArrayBuffer:Te,isDataView:Oe,isArray:Ie,isFunction:Le,isArguments:He,isFinite:u,isNaN:c,isTypedArray:Pe,isEmpty:x,isMatch:y,isEqual:E,isMap:Qe,isWeakMap:tn,isSet:en,isWeakSet:nn,keys:b,allKeys:k,values:T,pairs:j,invert:M,functions:L,methods:L,extend:rn,extendOwn:on,assign:on,defaults:sn,create:N,clone:O,tap:I,get:W,has:B,mapObject:Y,identity:P,constant:f,noop:$,toPath:F,property:U,propertyOf:K,matcher:V,matches:V,times:Q,random:tt,now:an,escape:hn,unescape:cn,templateSettings:fn,template:it,result:rt,uniqueId:ot,chain:st,iteratee:J,partial:bn,bind:xn,bindAll:wn,memoize:ht,delay:_n,defer:Sn,throttle:ut,debounce:ct,wrap:ft,negate:dt,compose:gt,after:pt,before:mt,once:Cn,findKey:vt,findIndex:En,findLastIndex:kn,sortedIndex:xt,indexOf:zn,lastIndexOf:Tn,find:wt,detect:wt,findWhere:_t,each:St,forEach:St,map:Ct,collect:Ct,reduce:jn,foldl:jn,inject:jn,reduceRight:Mn,foldr:Mn,filter:kt,select:kt,reject:zt,every:Tt,all:Tt,some:jt,any:jt,contains:Mt,includes:Mt,include:Mt,invoke:Ln,pluck:Lt,where:Rt,max:qt,min:At,shuffle:It,sample:Ot,sortBy:Ft,groupBy:qn,indexBy:An,countBy:Nn,partition:On,toArray:Nt,size:Dt,pick:In,omit:Fn,first:Pt,head:Pt,take:Pt,initial:Bt,last:Ut,rest:Vt,tail:Vt,drop:Vt,compact:Gt,flatten:Xt,without:Dn,uniq:Jt,unique:Jt,union:Wn,intersection:Zt,difference:Hn,unzip:Yt,transpose:Yt,zip:Bn,object:$t,range:Kt,chunk:Qt,mixin:ee,default:w},Vn=ee(Pn);return Vn._=Vn,Vn})}).call(e,function(){return this}())},function(t,e,n){t.exports.Model=n(43),t.exports.Collection=n(89),t.exports.Events=n(11),t.exports.extend=n(17)},function(t,e,n){var i=n(1),r=n(11),o=n(17),s=n(7),a=function(t){this.cid=i.uniqueId("view"),t||(t={}),i.extend(this,i.pick(t,h)),this._ensureElement(),this.initialize.apply(this,arguments)},l=/^(\S+)\s*(.*)$/,h=["model","collection","el","id","attributes","className","tagName","events"];i.extend(a.prototype,r,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof s?t:s(t),this.el=this.$el[0]},delegateEvents:function(t){if(!t&&!(t=i.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),n){var r=e.match(l);this.delegate(r[1],r[2],i.bind(n,this))}}return this},delegate:function(t,e,n){this.$el.on(t+".delegateEvents"+this.cid,e,n)},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){this.$el.off(t+".delegateEvents"+this.cid,e,n)},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),a.extend=o,t.exports=a},function(t,e,n){"use strict";var i,r=n(115);t.exports=i=r.extend({buildDOM:function(){return this.on("new:node",this.buildNode),this.on("new:button",this.buildButton),this.on("new:menu",this.buildMenu),r.prototype.buildDOM.call(this)},buildNode:function(t){if(null!=this.g)return t.style.lineHeight=this.g.menuconfig.get("menuItemLineHeight")},buildButton:function(t){if(null!=this.g)return t.style.fontSize=this.g.menuconfig.get("menuFontsize"),t.style.marginLeft=this.g.menuconfig.get("menuMarginLeft"),t.style.padding=this.g.menuconfig.get("menuPadding")},buildMenu:function(t){if(null!=this.g)return t.style.fontSize=this.g.menuconfig.get("menuItemFontsize")}})},function(t,e,n){function i(t){var e=t.parentNode,n=t.nextSibling;return e.removeChild(t),function(){n?e.insertBefore(t,n):e.appendChild(t)}}var r,o=n(1),s=n(3),a=function(t){for(var e;e=t.lastChild;)t.removeChild(e)};t.exports=r=s.extend({renderSubviews:function(){var t=this.el,e=void 0!=t.parentNode;if(e)var n=i(t);a(t);for(var r,s,l=document.createDocumentFragment(),h=this._views(),u=o.sortBy(h,function(t){return t.ordering}),c=0;c<u.length;c++)r=u[c],r.render(),s=r.el,null!=s&&l.appendChild(s);return t.appendChild(l),e&&n(),t},addView:function(t,e){var n=this._views();if(null==e)throw"Invalid plugin. ";return null==e.ordering&&(e.ordering=t),n[t]=e},removeViews:function(){var t,e,n=this._views();for(e in n)t=n[e],t.undelegateEvents(),t.unbind(),null!=t.removeViews&&t.removeViews(),t.remove();return this.views={}},removeView:function(t){var e=this._views();return e[t].remove(),delete e[t]},getView:function(t){var e=this._views();return e[t]},remove:function(){return this.removeViews(),s.prototype.remove.apply(this)},_views:function(){return null==this.views&&(this.views={}),this.views}})},function(t,e){var n={};n.removeToInsertLater=function(t){var e,n;return n=t.parentNode,e=t.nextSibling,n.removeChild(t),function(){e?n.insertBefore(t,e):n.appendChild(t)}},n.removeAllChilds=function(t){var e;for(e=0;t.firstChild;)e++,t.removeChild(t.firstChild)},t.exports=n},function(t,e,n){var i;(function(t){/*!
	 * jBone v1.2.1 - 2017-09-19 - Library for DOM manipulation
	 *
	 * http://jbone.js.org
	 *
	 * Copyright 2017 Alexey Kupriyanenko
	 * Released under the MIT license.
	 */
!function(r){function o(t){var e=t.length,n=typeof t;return!b(n)&&t!==r&&(!(1!==t.nodeType||!e)||(x(n)||0===e||"number"==typeof e&&e>0&&e-1 in t))}function s(t,e){var n,i;this.originalEvent=t,i=function(t,e){"preventDefault"===t?this[t]=function(){return this.defaultPrevented=!0,e[t]()}:"stopImmediatePropagation"===t?this[t]=function(){return this.immediatePropagationStopped=!0,e[t]()}:b(e[t])?this[t]=function(){return e[t]()}:this[t]=e[t]};for(n in t)(t[n]||"function"==typeof t[n])&&i.call(this,n,t);y.extend(this,e,{isImmediatePropagationStopped:function(){return!!this.immediatePropagationStopped}})}var a,l=r.$,h=r.jBone,u=/^<(\w+)\s*\/?>$/,c=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,f=[].slice,d=[].splice,g=Object.keys,p=r.document,m=function(t){return"string"==typeof t},v=function(t){return t instanceof Object},b=function(t){return"[object Function]"==={}.toString.call(t)},x=function(t){return Array.isArray(t)},y=function(t,e){return new a.init(t,e)};y.noConflict=function(){return r.$=l,r.jBone=h,y},a=y.fn=y.prototype={init:function(t,e){var n,i,r,o;if(!t)return this;if(m(t)){if(i=u.exec(t))return this[0]=p.createElement(i[1]),this.length=1,v(e)&&this.attr(e),this;if((i=c.exec(t))&&i[1]){for(o=p.createDocumentFragment(),r=p.createElement("div"),r.innerHTML=t;r.lastChild;)o.appendChild(r.firstChild);return n=f.call(o.childNodes),y.merge(this,n)}if(y.isElement(e))return y(e).find(t);try{return n=p.querySelectorAll(t),y.merge(this,n)}catch(t){return this}}return t.nodeType?(this[0]=t,this.length=1,this):b(t)?t():t instanceof y?t:y.makeArray(t,this)},pop:[].pop,push:[].push,reverse:[].reverse,shift:[].shift,sort:[].sort,splice:[].splice,slice:[].slice,indexOf:[].indexOf,forEach:[].forEach,unshift:[].unshift,concat:[].concat,join:[].join,every:[].every,some:[].some,filter:[].filter,map:[].map,reduce:[].reduce,reduceRight:[].reduceRight,length:0},a.constructor=y,a.init.prototype=a,y.setId=function(t){var e=t.jid;t===r?e="window":void 0===t.jid&&(t.jid=e=++y._cache.jid),y._cache.events[e]||(y._cache.events[e]={})},y.getData=function(t){t=t instanceof y?t[0]:t;var e=t===r?"window":t.jid;return{jid:e,events:y._cache.events[e]}},y.isElement=function(t){return t&&t instanceof y||t instanceof HTMLElement||m(t)},y._cache={events:{},jid:0},a.pushStack=function(t){var e=y.merge(this.constructor(),t);return e},y.merge=function(t,e){for(var n=e.length,i=t.length,r=0;r<n;)t[i++]=e[r++];return t.length=i,t},y.contains=function(t,e){return t.contains(e)},y.extend=function(t){var e;return d.call(arguments,1).forEach(function(n){if(e=t,n)for(var i in n)e[i]=n[i]}),t},y.makeArray=function(t,e){var n=e||[];return null!==t&&(o(t)?y.merge(n,m(t)?[t]:t):n.push(t)),n},y.unique=function(t){if(null==t)return[];for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.indexOf(r)<0&&e.push(r)}return e},y.Event=function(t,e){var n,i;return t.type&&!e&&(e=t,t=t.type),n=t.split(".").splice(1).join("."),i=t.split(".")[0],t=p.createEvent("Event"),t.initEvent(i,!0,!0),y.extend(t,{namespace:n,isDefaultPrevented:function(){return t.defaultPrevented}},e)},y.event={add:function(t,e,n,i,r){y.setId(t);var o,s,a,l=function(e){y.event.dispatch.call(t,e)},h=y.getData(t).events;for(e=e.split(" "),s=e.length;s--;)a=e[s],o=a.split(".")[0],h[o]=h[o]||[],h[o].length?l=h[o][0].fn:t.addEventListener&&t.addEventListener(o,l,!1),h[o].push({namespace:a.split(".").splice(1).join("."),fn:l,selector:r,data:i,originfn:n})},remove:function(t,e,n,i){var r,o,s=function(t,e,i,r,o){var s;(n&&o.originfn===n||!n)&&(s=o.fn),t[e][i].fn===s&&(t[e].splice(i,1),t[e].length||r.removeEventListener(e,s))},a=y.getData(t).events;if(a)return!e&&a?g(a).forEach(function(e){for(o=a[e],r=o.length;r--;)s(a,e,r,t,o[r])}):void e.split(" ").forEach(function(e){var n,l=e.split(".")[0],h=e.split(".").splice(1).join(".");if(a[l])for(o=a[l],r=o.length;r--;)n=o[r],(!h||h&&n.namespace===h)&&(!i||i&&n.selector===i)&&s(a,l,r,t,n);else h&&g(a).forEach(function(e){for(o=a[e],r=o.length;r--;)n=o[r],n.namespace.split(".")[0]===h.split(".")[0]&&s(a,e,r,t,n)})})},trigger:function(t,e){var n=[];m(e)?n=e.split(" ").map(function(t){return y.Event(t)}):(e=e instanceof Event?e:y.Event(e),n=[e]),n.forEach(function(e){e.type&&t.dispatchEvent&&t.dispatchEvent(e)})},dispatch:function(t){for(var e,n,i,r,o,a=0,l=0,h=this,u=y.getData(h).events[t.type],c=u.length,f=[],d=[];a<c;a++)f.push(u[a]);for(a=0,c=f.length;a<c&&~u.indexOf(f[a])&&(!r||!r.isImmediatePropagationStopped());a++)if(n=null,o={},i=f[a],i.data&&(o.data=i.data),i.selector){if(~(d=y(h).find(i.selector)).indexOf(t.target)&&(n=t.target)||h!==t.target&&h.contains(t.target)){if(!n)for(e=d.length,l=0;l<e;l++)d[l]&&d[l].contains(t.target)&&(n=d[l]);if(!n)continue;o.currentTarget=n,r=new s(t,o),t.namespace&&t.namespace!==i.namespace||i.originfn.call(n,r)}}else r=new s(t,o),t.namespace&&t.namespace!==i.namespace||i.originfn.call(h,r)}},a.on=function(t,e,n,i){var r=this.length,o=0;if(null==n&&null==i?(i=e,n=e=void 0):null==i&&("string"==typeof e?(i=n,n=void 0):(i=n,n=e,e=void 0)),!i)return this;for(;o<r;o++)y.event.add(this[o],t,i,n,e);return this},a.one=function(t){var e,n=arguments,i=0,r=this.length,o=f.call(n,1,n.length-1),s=f.call(n,-1)[0];for(e=function(e){var n=y(e);t.split(" ").forEach(function(t){var i=function(r){n.off(t,i),s.call(e,r)};n.on.apply(n,[t].concat(o,i))})};i<r;i++)e(this[i]);return this},a.trigger=function(t){var e=0,n=this.length;if(!t)return this;for(;e<n;e++)y.event.trigger(this[e],t);return this},a.off=function(t,e,n){var i=0,r=this.length;for(b(e)&&(n=e,e=void 0);i<r;i++)y.event.remove(this[i],t,n,e);return this},a.find=function(t){for(var e=[],n=0,i=this.length,r=function(n){b(n.querySelectorAll)&&[].forEach.call(n.querySelectorAll(t),function(t){e.push(t)})};n<i;n++)r(this[n]);return y(e)},a.get=function(t){return null!=t?t<0?this[t+this.length]:this[t]:f.call(this)},a.eq=function(t){return y(this[t])},a.parent=function(){for(var t,e=[],n=0,i=this.length;n<i;n++)!~e.indexOf(t=this[n].parentElement)&&t&&e.push(t);return y(e)},a.toArray=function(){return f.call(this)},a.is=function(){var t=arguments;return this.some(function(e){return e.tagName.toLowerCase()===t[0]})},a.has=function(){var t=arguments;return this.some(function(e){return e.querySelectorAll(t[0]).length})},a.add=function(t,e){return this.pushStack(y.unique(y.merge(this.get(),y(t,e))))},a.attr=function(t,e){var n,i=arguments,r=0,o=this.length;if(m(t)&&1===i.length)return this[0]&&this[0].getAttribute(t);for(2===i.length?n=function(n){n.setAttribute(t,e)}:v(t)&&(n=function(e){g(t).forEach(function(n){e.setAttribute(n,t[n])})});r<o;r++)n(this[r]);return this},a.removeAttr=function(t){for(var e=0,n=this.length;e<n;e++)this[e].removeAttribute(t);return this},a.val=function(t){var e=0,n=this.length;if(0===arguments.length)return this[0]&&this[0].value;for(;e<n;e++)this[e].value=t;return this},a.css=function(t,e){var n,i=arguments,o=0,s=this.length;if(m(t)&&1===i.length)return this[0]&&r.getComputedStyle(this[0])[t];for(2===i.length?n=function(n){n.style[t]=e}:v(t)&&(n=function(e){g(t).forEach(function(n){e.style[n]=t[n]})});o<s;o++)n(this[o]);return this},a.data=function(t,e){var n,i=arguments,r={},o=0,s=this.length,a=function(t,e,n){v(n)?(t.jdata=t.jdata||{},t.jdata[e]=n):t.dataset[e]=n},l=function(t){return"true"===t||"false"!==t&&t};if(0===i.length)return this[0].jdata&&(r=this[0].jdata),g(this[0].dataset).forEach(function(t){r[t]=l(this[0].dataset[t])},this),r;if(1===i.length&&m(t))return this[0]&&l(this[0].dataset[t]||this[0].jdata&&this[0].jdata[t]);for(1===i.length&&v(t)?n=function(e){g(t).forEach(function(n){a(e,n,t[n])})}:2===i.length&&(n=function(n){a(n,t,e)});o<s;o++)n(this[o]);return this},a.removeData=function(t){for(var e,n,i=0,r=this.length;i<r;i++)if(e=this[i].jdata,n=this[i].dataset,t)e&&e[t]&&delete e[t],delete n[t];else{for(t in e)delete e[t];for(t in n)delete n[t]}return this},a.addClass=function(t){for(var e=0,n=0,i=this.length,r=t?t.trim().split(/\s+/):[];e<i;e++)for(n=0,n=0;n<r.length;n++)this[e].classList.add(r[n]);return this},a.removeClass=function(t){for(var e=0,n=0,i=this.length,r=t?t.trim().split(/\s+/):[];e<i;e++)for(n=0,n=0;n<r.length;n++)this[e].classList.remove(r[n]);return this},a.toggleClass=function(t,e){var n=0,i=this.length,r="toggle";if(e===!0&&(r="add")||e===!1&&(r="remove"),t)for(;n<i;n++)this[n].classList[r](t);return this},a.hasClass=function(t){var e=0,n=this.length;if(t)for(;e<n;e++)if(this[e].classList.contains(t))return!0;return!1},a.html=function(t){var e,n=arguments;return 1===n.length&&void 0!==t?this.empty().append(t):0===n.length&&(e=this[0])?e.innerHTML:this},a.append=function(t){var e,n=0,i=this.length;for(m(t)&&c.exec(t)?t=y(t):v(t)||(t=document.createTextNode(t)),t=t instanceof y?t:y(t),e=function(e,n){t.forEach(function(t){n?e.appendChild(t.cloneNode(!0)):e.appendChild(t)})};n<i;n++)e(this[n],n);return this},a.appendTo=function(t){return y(t).append(this),this},a.empty=function(){for(var t,e=0,n=this.length;e<n;e++)for(t=this[e];t.lastChild;)t.removeChild(t.lastChild);return this},a.remove=function(){var t,e=0,n=this.length;for(this.off();e<n;e++)t=this[e],delete t.jdata,t.parentNode&&t.parentNode.removeChild(t);return this},"object"==typeof t&&t&&"object"==typeof t.exports?t.exports=y:(i=function(){return y}.call(e,n,e,t),!(void 0!==i&&(t.exports=i)),r.jBone=r.$=y)}("undefined"!=typeof window?window:this)}).call(e,n(40)(t))},function(t,e,n){"use strict";var i=n(1),r=n(2).Model,o=r.extend({defaults:{type:"super"}}),s=o.extend({defaults:i.extend({},o.prototype.defaults,{type:"row",seqId:""}),inRow:function(t){return t===this.get("seqId")},inColumn:function(t){return!0},getLength:function(){return 1}}),a=o.extend({defaults:i.extend({},o.prototype.defaults,{type:"column",xStart:-1,xEnd:-1}),inRow:function(){return!0},inColumn:function(t){return xStart<=t&&t<=xEnd},getLength:function(){return xEnd-xStart}}),l=s.extend(i.extend({},i.pick(a,"inColumn"),i.pick(a,"getLength"),{defaults:i.extend({},a.prototype.defaults,s.prototype.defaults,{type:"pos"})}));t.exports.sel=o,t.exports.possel=l,t.exports.rowsel=s,t.exports.columnsel=a},function(t,e,n){"use strict";var i,r=n(8),o=n(1),s=n(2).Collection;t.exports=i=s.extend({model:r.sel,initialize:function(t,e){if("undefined"!=typeof e&&null!==e)return this.g=e.g,this.listenTo(this.g,"residue:click",function(t){return this._handleE(t.evt,new r.possel({xStart:t.rowPos,xEnd:t.rowPos,seqId:t.seqId}))}),this.listenTo(this.g,"row:click",function(t){return this._handleE(t.evt,new r.rowsel({seqId:t.seqId}))}),this.listenTo(this.g,"column:click",function(t){return this._handleE(t.evt,new r.columnsel({xStart:t.rowPos,xEnd:t.rowPos+t.stepSize-1}))})},getSelForRow:function(t){return this.filter(function(e){return e.inRow(t)})},getSelForColumns:function(t){return this.filter(function(e){return e.inColumn(t)})},addJSON:function(t){return this.add(this._fromJSON(t))},_fromJSON:function(t){switch(t.type){case"column":return new r.columnsel(t);case"row":return new r.rowsel(t);case"pos":return new r.possel(t)}},resetJSON:function(t){return t=o.map(t,this._fromJSON),this.reset(t)},getBlocksForRow:function(t,e){for(var n,i=this.filter(function(e){return e.inRow(t)}),r=[],o=0;o<i.length;o++){if(n=i[o],"row"===n.attributes.type){r=function(){var t=[],n=0;if(0<=e)for(;n<=e;)t.push(n++);else for(;n>=e;)t.push(n--);return t}();break}r=r.concat(function(){var t=[],e=n.attributes.xStart;if(n.attributes.xStart<=n.attributes.xEnd)for(;e<=n.attributes.xEnd;)t.push(e++);else for(;e>=n.attributes.xEnd;)t.push(e--);return t}())}return r},getAllColumnBlocks:function(t){var e=(t.maxLen,t.withPos,[]);if(t.withPos)var n=this.filter(function(t){return null!=t.get("xStart")});else n=this.filter(function(t){return"column"===t.get("type")});for(var i,r=0;r<n.length;r++)i=n[r],e=e.concat(function(){var t=[],e=i.attributes.xStart;if(i.attributes.xStart<=i.attributes.xEnd)for(;e<=i.attributes.xEnd;)t.push(e++);else for(;e>=i.attributes.xEnd;)t.push(e--);return t}());return e=o.uniq(e)},invertRow:function(t){var e=this.where({type:"row"});e=o.map(e,function(t){return t.attributes.seqId});for(var n,i=o.filter(t,function(t){return!(e.indexOf(t)>=0)}),s=[],a=0;a<i.length;a++)n=i[a],s.push(new r.rowsel({seqId:n}));return this.reset(s)},invertCol:function(t){var e,n=this.where({type:"column"});n=o.reduce(n,function(t,e){return t.concat(function(){var t=[],n=e.attributes.xStart;if(e.attributes.xStart<=e.attributes.xEnd)for(;n<=e.attributes.xEnd;)t.push(n++);else for(;n>=e.attributes.xEnd;)t.push(n--);return t}())},[]);var i=o.filter(t,function(t){return!(n.indexOf(t)>=0)});if(0!==i.length){for(var s,a=[],l=e=i[0],h=0;h<i.length;h++)s=i[h],e+1===s?e=s:(a.push(new r.columnsel({xStart:l,xEnd:e})),l=e=s);return l!==e&&a.push(new r.columnsel({xStart:l,xEnd:i[i.length-1]})),this.reset(a)}},_handleE:function(t,e){return t.ctrlKey||t.metaKey?this.add(e):this.reset([e])},_reduceColumns:function(){return this.each(function(t,e,n){for(var i,r=o.filter(n,function(t){return"column"===t.get("type")}),s=t.get("xStart"),a=t.get("xEnd"),l=o.filter(r,function(t){return t.get("xEnd")===s-1}),h=0;h<l.length;h++)i=l[h],i.set("xEnd",s);for(var u,c=o.filter(r,function(t){return t.get("xStart")===a+1}),f=0;f<c.length;f++)u=c[f],u.set("xStart",a);if(l.length>0||c.length>0)return console.log("removed el"),t.collection.remove(t)})}})},function(t,e){"use strict";var n="http://www.w3.org/2000/svg",i=function(t,e){for(var n in e){var i=e[n];t.setAttributeNS(null,n,i)}return t},r=function(t){var e=document.createElementNS(n,"svg");return e.setAttribute("width",t.width),e.setAttribute("height",t.height),e},o=function(t){var e=document.createElementNS(n,"rect");return i(e,t)},s=function(t){var e=document.createElementNS(n,"line");return i(e,t)},a=function(t){var e=document.createElementNS(n,"polygon");return i(e,t)};t.exports.rect=o,t.exports.line=s,t.exports.polygon=a,t.exports.base=r},function(t,e,n){t.exports=n(88)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();t.exports=function(){function t(){n(this,t)}return i(t,null,[{key:"randomInt",value:function(t,e){if("undefined"==typeof e||null===e){var n=[0,t];t=n[0],e=n[1]}if(t>e){var i=[e,t];t=i[0],e=i[1]}return Math.floor(Math.random()*(e-t+1)+t)}},{key:"uniqueId",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e="";e.length<t;)e+=Math.random().toString(36).substr(2);return e.substr(0,t)}},{key:"getRandomInt",value:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}}]),t}()},function(t,e,n){"use strict";var i,r=n(19),o=n(37),s=n(21),a=n(109),l=n(110),h=n(1);t.exports=i={openInJalview:function(t,e){if("."===t.charAt(0)&&(t=document.URL.substr(0,document.URL.lastIndexOf("/"))+"/"+t),t.indexOf("http")<0){var n="http://"+window.location.hostname;t=n+t}t=encodeURIComponent(t);var i="http://www.jalview.org/services/launchApp?open="+t;return i+="&colour="+e,window.open(i,"_blank")},publishWeb:function(t,e){var n=r.write(t.seqs.toJSON());n=encodeURIComponent(n);var i="http://sprunge.biojs.net";return s({method:"POST",body:"sprunge="+n,uri:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(t,n,i){var r=i.trim();return e(r)})},shareLink:function(t,e){var n=t.g.config.get("importURL"),r="http://msa.biojs.net/app/?seq=",o=function(t){var n=r+t;if(e)return e(n)};return n?o(n):i.publishWeb(t,o)},saveAsFile:function(t,e){var n=r.write(t.seqs.toJSON()),i=new Blob([n],{type:"text/plain"});return l(i,e)},saveSelection:function(t,e){var n=t.g.selcol.pluck("seqId");if(console.log(n),n.length>0){n=t.seqs.filter(function(t){return h.contains(n,t.get("id"))});for(var i=n.length-1,o=0;0<i?o<=i:o>=i;0<i?o++:o--)n[o]=n[o].toJSON()}else n=t.seqs.toJSON(),console.warn("no selection found");var s=r.write(n),a=new Blob([s],{type:"text/plain"});return l(a,e)},saveAnnots:function(t,e){var n=t.seqs.map(function(t){if(n=t.get("features"),0!==n.length){var e=t.get("name");return n.each(function(t){return t.set("seqname",e)}),n.toJSON()}});n=h.flatten(h.compact(n)),console.log(n);var i=o.exportLines(n),r=new Blob([i],{type:"text/plain"});return l(r,e)},saveAsImg:function(t,e){var n=t.getView("stage").getView("body").getView("seqblock").el;if("undefined"!=typeof n&&null!==n){var i=n.toDataURL("image/png");return l(a(i),e,"image/png")}}}},function(t,e,n){"use strict";var i,r=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(19),s=n(44),a=n(37),l=n(1),h=n(21);t.exports=i=function(t){return this.msa=t,this};var u={guessFileType:function(t){t=t.split(".");var e=t[t.length(-1)];switch(e){case"aln":case"clustal":return s;case"fasta":return o;default:return o}},guessFileFromText:function(t){if("undefined"==typeof t||null===t)return console.warn("invalid file format"),["","error"];if("CLUSTAL"===t.substring(0,7))var e=s,n="seqs";else">"===t.substring(0,1)?(e=o,n="seqs"):"("===t.substring(0,1)?n="newick":(e=a,n="features");return[e,n]},parseText:function(t){var e=this.guessFileFromText(t),n=r(e,2),i=n[0],o=n[1];if("seqs"===o){var s=i.parse(t);return[s,o]}if("features"===o){var a=i.parseSeqs(t);return[a,o]}return[t,o]},importFiles:function(t){var e=this;return function(){for(var n=[],i=t.length-1,r=0;0<i?r<=i:r>=i;0<i?r++:r--){var o=t[r],s=new FileReader;s.onload=function(t){return e.importFile(t.target.result)},n.push(s.readAsText(o))}return n}()},importFile:function(t){var e,n=this,i=this.parseText(t),o=r(i,2),s=o[0],a=o[1];return"error"===a?"error":("seqs"===a?(this.msa.seqs.reset(s),this.msa.g.config.set("url","userimport"),this.msa.g.trigger("url:userImport")):"features"===a?this.msa.seqs.addFeatures(s):"newick"===a&&this.msa.u.tree.loadTree(function(){return n.msa.u.tree.showTree(t)}),e=t.name)},importURL:function(t,e){var n=this;return t=this.msa.u.proxy.corsURL(t),this.msa.g.config.set("url",t),h({url:t,timeout:0},function(i,r,o){if(i)return console.log(i);var s=n.importFile(o);if("error"!==s)return n.msa.g.trigger("import:url",t),e?e():void 0})}};l.extend(i.prototype,u)},function(t,e,n){"use strict";var i,r=n(20);t.exports=i={loadScript:function(t,e){var n=r.mk("script");n.type="text/javascript",n.src=t,n.async=!0,n.onload=n.onreadystatechange=function(){if(!(t||this.readyState&&"complete"!==this.readyState)){var t=!0;return e()}};var i=document.getElementsByTagName("script")[0];return i.parentNode.appendChild(n)},joinCb:function(t,e,n){e=e||1;var i=0,r=function(t,e){return"undefined"==typeof t||null===t?o():function(){var n;return n="apply",t.indexOf(n)>=0&&t.apply(e,arguments),o()}},o=function(){if(i++,i===e)return t.call(n)};return r}}},function(t,e,n){"use strict";var i,r=n(1);t.exports=i=function(t){return this.g=t.g,this};var o={corsURL:function(t){return document.URL.indexOf("localhost")>=0&&"/"===t[0]?t:"."===t.charAt(0)||"/"===t.charAt(0)?t:(this.g.config.get("importProxyStripHttp")&&(t=t.replace("http://",""),t=t.replace("https://","")),t=this.g.config.get("importProxy")+t)}};r.extend(i.prototype,o)},function(t,e,n){!function(e){t.exports=e()}(function(){"use strict";var t={has:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},extend:function(t){for(var e=1;e<arguments.length;++e){var n=arguments[e];if(n)for(var i in n)t[i]=n[i]}return t}},e=function(e,n){var i,r=this;i=e&&t.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},t.extend(i,r,n);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,e&&t.extend(i.prototype,e),i.__super__=r.prototype,i};return e})},function(t,e,n){var i=n(11);i.onAll=function(t,e){return this.on("all",t,e),this},i.oldMixin=i.mixin,i.mixin=function(t){i.oldMixin(t);for(var e=["onAll"],n=0;n<e.length;n++){var r=e[n];t[r]=this[r]}return t},t.exports=i},function(t,e,n){var i,r;r=n(38),i=n(91),t.exports=i,r.mixin(i)},function(t,e,n){(function(t){var e={};e.d=e.defaultValue=function(t,e){return void 0===t?"function"==typeof t?e():e:t},e.id=function(t){return document.getElementById(t)},e.mk=function(t){return document.createElement(t)},void 0!==t&&void 0!==t.exports&&(t.exports=e)}).call(e,n(40)(t))},function(t,e,n){function i(t,e){function n(){4===p.readyState&&S()}function i(){var t=null;if(p.response?t=p.response:"text"!==p.responseType&&p.responseType||(t=p.responseText||p.responseXML),_)try{t=JSON.parse(t)}catch(t){}return t}function o(){return 1223===p.status?204:p.status}function c(t,e){var n=null;if(0===t||t>=400&&t<600){var i="string"==typeof e&&e||l[String(t).charAt(0)];n=new Error(i),n.statusCode=t}return n}function f(){var t=o(),n=i(),r=c(t,n),s={body:n,statusCode:t,statusText:p.statusText,raw:p};p.getAllResponseHeaders?s.headers=a(p.getAllResponseHeaders()):s.headers={},e(r,s,s.body)}function d(){var t=o(),n=c(t);p.status=p.statusCode=t,p.body=i(),p.headers=a(p.getAllResponseHeaders()),e(n,p,p.body)}function g(t){e(t,p)}"string"==typeof t&&(t={uri:t}),t=t||{},e=s(e);var p=t.xhr||null;p||(p=t.cors||t.useXDR?new u:new h);var m,v=p.url=t.uri||t.url,b=p.method=t.method||"GET",x=t.body||t.data,y=p.headers=t.headers||{},w=!!t.sync,_=!1,S=t.response?f:d;if("json"in t&&(_=!0,y.Accept="application/json","GET"!==b&&"HEAD"!==b&&(y["Content-Type"]="application/json",x=JSON.stringify(t.json))),p.onreadystatechange=n,p.onload=S,p.onerror=g,p.onprogress=function(){},p.ontimeout=r,p.open(b,v,!w),(t.withCredentials||t.cors&&t.withCredentials!==!1)&&(p.withCredentials=!0),w||(p.timeout="timeout"in t?t.timeout:5e3),p.setRequestHeader)for(m in y)y.hasOwnProperty(m)&&p.setRequestHeader(m,y[m]);else if(t.headers)throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(p.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(p),p.send(x),p}function r(){}var o=n(113),s=n(139),a=n(50),l={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},h=o.XMLHttpRequest||r,u="withCredentials"in new h?h:o.XDomainRequest;t.exports=i},function(t,e,n){"use strict";var i,r=n(123),o=n(2).Model;t.exports=i=o.extend({defaults:{scheme:"taylor",colorBackground:!0,showLowerCase:!0,opacity:.6},initialize:function(t,e,n){return this.colors=new r({seqs:e,conservation:function(){return n.scale(n.conservation())}}),n.on("reset",function(){if("dyn"===this.getSelectedScheme().type){var t;if(t="reset",this.getSelectedScheme().indexOf(t)>=0)return this.getSelectedScheme().reset()}},this)},addStaticScheme:function(t,e){return this.colors.addStaticScheme(t,e)},addDynScheme:function(t,e){return this.colors.addDynScheme(t,e)},getScheme:function(t){return this.colors.getScheme(t)},getSelectedScheme:function(){return this.colors.getScheme(this.get("scheme"))}})},function(t,e,n){"use strict";var i,r=n(2).Model;n(1);t.exports=i=r.extend({initialize:function(t,e){return null==this.get("hidden")&&this.set("hidden",[]),this.stats=e},calcHiddenColumns:function(t){for(var e,n=this.get("hidden"),i=t,r=0;r<n.length;r++)e=n[r],e<=i&&i++;return i-t}})},function(t,e,n){"use strict";var i,r=n(2).Model;t.exports=i=r.extend({defaults:{registerMouseHover:!1,registerMouseClicks:!0,importProxy:"https://cors-anywhere.herokuapp.com/",importProxyStripHttp:!0,eventBus:!0,alphabetSize:20,dropImport:!1,debug:!1,hasRef:!1,bootstrapMenu:!1,manualRendering:!1}})},function(t,e,n){"use strict";var i,r=n(15),o=n(2).Model;t.exports=i=o.extend({initialize:function(t){return this.g=t},development:{"msa-tnt":"/node_modules/msa-tnt/build/bundle.js","biojs-io-newick":"/node_modules/biojs-io-newick/build/biojs-io-newick.min.js"},loadPackage:function(t,e){try{var i=n(141)(t);return e(i)}catch(n){return r.loadScript(this._pkgURL(t),e)}},loadPackages:function(t,e){var n=this,i=r.joinCb(function(){return e()},t.length);return t.forEach(function(t){return n.loadPackage(t,i)})},_pkgURL:function(t){if(this.g.config.get("debug"))var e=this.development[t];else e="http://wzrd.in/bundle/"+t+"@latest";return e}})},function(t,e,n){"use strict";var i,r=n(2).Model;t.exports=i=r.extend({defaults:{searchText:""}})},function(t,e,n){"use strict";var i,r=n(2).Model;t.exports=i=r.extend({defaults:{searchBox:-10,overviewBox:30,headerBox:-1,alignmentBody:0}})},function(t,e,n){"use strict";var i,r=n(2).Model;t.exports=i=r.extend({defaults:{sequences:!0,markers:!0,metacell:!1,conserv:!1,overviewbox:!1,seqlogo:!1,gapHeader:!1,leftHeader:!0,labels:!0,labelName:!0,labelId:!0,labelPartition:!1,labelCheckbox:!1,metaGaps:!0,metaIdentity:!0,metaLinks:!0},constructor:function(t,e){return this.calcDefaults(e.model),r.apply(this,arguments)},initialize:function(){return this.listenTo(this,"change:metaLinks change:metaIdentity change:metaGaps",function(){return this.trigger("change:metacell")},this),this.listenTo(this,"change:labelName change:labelId change:labelPartition change:labelCheckbox",function(){return this.trigger("change:labels")},this),this.listenTo(this,"change:markers change:conserv change:seqlogo change:gapHeader",function(){return this.trigger("change:header")},this)},calcDefaults:function(t){if(t.length>0){var e=t.at(0),n=e.get("ids");if(void 0!==n&&0===Object.keys(n).length)return this.defaults.metaLinks=!1}}})},function(t,e,n){"use strict";var i,r=n(2).Model;t.exports=i=r.extend({constructor:function(t,e){return this.calcDefaults(e.model),r.apply(this,arguments),this.g=e.g,this.listenTo(this,"change:labelIdLength change:labelNameLength change:labelPartLength change:labelCheckLength",function(){return this.trigger("change:labelWidth",this.getLabelWidth())},this),this.listenTo(this,"change:metaLinksWidth change:metaIdentWidth change:metaGapWidth",function(){return this.trigger("change:metaWidth",this.getMetaWidth())},this),this},defaults:{alignmentWidth:"auto",alignmentHeight:225,columnWidth:15,rowHeight:15,autoResize:!0,textVisible:!0,labelIdLength:20,labelNameLength:100,labelPartLength:15,labelCheckLength:15,labelFontsize:13,labelLineHeight:"13px",markerFontsize:"10px",stepSize:1,markerStepSize:2,markerHeight:20,residueFont:"13",canvasEventScale:1,boxRectHeight:2,boxRectWidth:2,overviewboxPaddingTop:10,metaGapWidth:35,metaIdentWidth:40,_alignmentScrollLeft:0,_alignmentScrollTop:0},calcDefaults:function(t){var e=t.getMaxLength();if(e<200&&t.length<30)return this.defaults.boxRectWidth=this.defaults.boxRectHeight=5},getAlignmentWidth:function(t){return this.get("autoResize")&&void 0!==t?this.get("columnWidth")*t:void 0===this.get("alignmentWidth")||"auto"===this.get("alignmentWidth")||0===this.get("alignmentWidth")?this._adjustWidth():this.get("alignmentWidth")},setLeftOffset:function(t){var e=t;return e=Math.max(0,e),e-=this.g.columns.calcHiddenColumns(e),this.set("_alignmentScrollLeft",e*this.get("columnWidth"))},setTopOffset:function(t){for(var e=Math.max(0,t-1),n=0,i=0;0<e?i<=e:i>=e;0<e?i++:i--){var r=this.model.at(i);n+=r.attributes.height||1}return this.set("_alignmentScrollTop",n*this.get("rowHeight"))},getLeftBlockWidth:function(){var t=0;return this.g.vis.get("labels")&&(t+=this.getLabelWidth()),this.g.vis.get("metacell")&&(t+=this.getMetaWidth()),t},getMetaWidth:function(){var t=0;return this.g.vis.get("metaGaps")&&(t+=this.get("metaGapWidth")),this.g.vis.get("metaIdentity")&&(t+=this.get("metaIdentWidth")),this.g.vis.get("metaLinks")&&(t+=this.get("metaLinksWidth")),t},getLabelWidth:function(){var t=0;return this.g.vis.get("labelName")&&(t+=this.get("labelNameLength")),this.g.vis.get("labelId")&&(t+=this.get("labelIdLength")),this.g.vis.get("labelPartition")&&(t+=this.get("labelPartLength")),this.g.vis.get("labelCheckbox")&&(t+=this.get("labelCheckLength")),t},_adjustWidth:function(){if(void 0!==this.el&&void 0!==this.model){if(null!=this.el.parentNode&&0!==this.el.parentNode.offsetWidth)var t=this.el.parentNode.offsetWidth;else t=document.body.clientWidth-35;var e=t-this.getLeftBlockWidth(),n=this.getAlignmentWidth(this.model.getMaxLength()-this.g.columns.get("hidden").length),i=Math.min(e,n);return i=Math.floor(i/this.get("columnWidth"))*this.get("columnWidth"),this.attributes.alignmentWidth=i}},autoResize:function(){if(this.get("autoResize"))return this._adjustWidth(this.el,this.model)},autoHeight:function(t){var e=this.getMaxAlignmentHeight();return void 0!==t&&t>0&&(e=Math.min(e,t)),this.set("alignmentHeight",e)},setEl:function(t,e){return this.el=t,this.model=e},_checkScrolling:function(t,e){var n=t[0],i=t[1];return this.set("_alignmentScrollLeft",n,e),this.set("_alignmentScrollTop",i,e)},getMaxAlignmentHeight:function(){var t=0;return this.model.each(function(e){return t+=e.attributes.height||1}),t*this.get("rowHeight")},getMaxAlignmentWidth:function(){return this.model.getMaxLength()*this.get("columnWidth")}})},function(t,e,n){"use strict";var i=n(30),r=n(2).Model;t.exports=i=r.extend({defaults:{xStart:-1,xEnd:-1,height:-1,text:"",fillColor:"red",fillOpacity:.5,type:"rectangle",borderSize:1,borderColor:"black",borderOpacity:.5,validate:!0,row:0},initialize:function(t){if(null!=t.start&&this.set("xStart",t.start-1),null!=t.end&&this.set("xEnd",t.end-1),null!=t.attributes&&(null!=t.attributes.Name&&this.set("text",t.attributes.Name),null!=t.attributes.Color&&this.set("fillColor",t.attributes.Color)),this.attributes.xEnd<this.attributes.xStart&&console.warn("invalid feature range for",this.attributes),!_.isNumber(this.attributes.xStart)||!_.isNumber(this.attributes.xEnd))return console.warn("please provide numeric feature ranges",t),this.set("xStart",parseInt(this.attributes.xStart)),this.set("xEnd",parseInt(this.attributes.xEnd))},validate:function(){if(isNaN(this.attributes.xStart||isNaN(this.attributes.xEnd)))return"features need integer start and end."},contains:function(t){return this.attributes.xStart<=t&&t<=this.attributes.xEnd}})},function(t,e,n){"use strict";var i,r=n(30),o=n(2).Collection,s=n(1);t.exports=i=o.extend({model:r,constructor:function(){return this.startOnCache=[],this.on("all",function(){return this.startOnCache=[]},this),o.apply(this,arguments)},startOn:function(t){return null==this.startOnCache[t]&&(this.startOnCache[t]=this.where({xStart:t})),this.startOnCache[t]},contains:function(t){return this.reduce(function(e,n){return n||e.contains(t)},!1)},getFeatureOnRow:function(t,e){return this.filter(function(n){return n.get("row")===t&&n.get("xStart")<=e&&e<=n.get("xEnd")})},assignRows:function(){var t=this.max(function(t){return t.get("xEnd")}).attributes.xEnd,e=function(){for(var e=[],n=0;0<t?n<=t:n>=t;0<t?n++:n--)e.push(0);return e}();return this.each(function(t){for(var n=0,i=t.get("xStart"),r=t.get("xEnd"),o=i;i<r?o<=r:o>=r;i<r?o++:o--)e[o]>n&&(n=e[o]),e[o]++;return t.set("row",n)}),s.max(e)},getCurrentHeight:function(){return this.max(function(t){return t.get("row")}).attributes.row+1},getMinRows:function(){var t=this.max(function(t){return t.get("xEnd")}).attributes.xEnd,e=function(){for(var e=[],n=0;0<t?n<=t:n>=t;0<t?n++:n--)e.push(0);return e}();return this.each(function(t){return function(){for(var n=[],i=t.get("xStart"),r=t.get("xEnd"),o=i;i<r?o<=r:o>=r;i<r?o++:o++)n.push(e[o]++);return n}()}),s.max(e)}})},function(t,e,n){"use strict";var i,r=n(33),o=n(31),s=n(2).Collection;t.exports=i=s.extend({model:r,constructor:function(t,e){var n=this;return s.apply(this,arguments),this.g=e,this.on("add reset remove",function(){return n.lengthCache=null,n._bindSeqsWithFeatures()},this),this.on("reset",function(){return n._autoSetRefSeq()}),this._autoSetRefSeq(),this.lengthCache=null,this.features={},this},getMaxLength:function(){return 0===this.models.length?0:(null===this.lengthCache&&(this.lengthCache=this.max(function(t){
return t.get("seq").length}).get("seq").length),this.lengthCache)},prev:function(t,e){var n=this.indexOf(t)-1;return n<0&&e&&(n=this.length-1),this.at(n)},next:function(t,e){var n=this.indexOf(t)+1;return n===this.length&&e&&(n=0),this.at(n)},calcHiddenSeqs:function(t){for(var e=t,n=0;0<e?n<=e:n>=e;0<e?n++:n--)this.at(n).get("hidden")&&e++;return e-t},addFeatures:function(t){var e=this;if(null!=t.config){var n=t;if(t=t.seqs,null!=n.config.colors){var i=n.config.colors;_.each(t,function(t){return _.each(t,function(t){if(null!=i[t.feature])return t.fillColor=i[t.feature]})})}}return _.isEmpty(this.features)?this.features=t:_.each(t,function(t,n){return e.features.hasOwnProperty(n)?e.features[n]=_.union(e.features[n],t):e.features[n]=t}),this._bindSeqsWithFeatures()},_bindSeqWithFeatures:function(t){var e=this.features[t.attributes.name];if(e)return t.set("features",new o(e)),t.attributes.features.assignRows(),t.set("height",t.attributes.features.getCurrentHeight()+1)},_bindSeqsWithFeatures:function(){var t=this;return this.each(function(e){return t._bindSeqWithFeatures(e)})},removeAllFeatures:function(){return delete this.features},_autoSetRefSeq:function(){if(this.length>0)return this.at(0).set("ref",!0)},setRef:function(t){var e=this.get(t);return this.each(function(n){if(t.cid)return e.cid===n.cid?n.set("ref",!0):n.set("ref",!1)}),this.g.config.set("hasRef",!0),this.trigger("change:reference",t)}})},function(t,e,n){"use strict";var i,r=n(2).Model,o=n(31);t.exports=i=r.extend({defaults:{name:"",id:"",seq:"",height:1,ref:!1},initialize:function(){if(this.set("grey",[]),null==this.get("features"))return this.set("features",new o)}})},function(t,e,n){"use strict";t.exports.bmath=n(12),t.exports.proxy=n(16),t.exports.seqgen=n(35),t.exports.file=n(14),t.exports.export=n(13)},function(t,e,n){"use strict";var i=n(95).seq,r=n(12),o=n(52),s=t.exports={_generateSequence:function(t){for(var e="",n=t-1,i=0;0<n?i<=n:i>=n;0<n?i++:i--)e+=s.getRandomChar();return e},getDummySequences:function(t,e){var n=[];"undefined"!=typeof t&&null!==t||(t=r.getRandomInt(3,5)),"undefined"!=typeof e&&null!==e||(e=r.getRandomInt(50,200));for(var o=1;1<t?o<=t:o>=t;1<t?o++:o--)n.push(new i(s._generateSequence(e),"seq"+o,"r"+o));return n},getRandomChar:function(t){var e=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZ";return e.charAt(Math.floor(Math.random()*e.length))},genConservedSequences:function(t,e,n){var a=[];"undefined"!=typeof t&&null!==t||(t=r.getRandomInt(3,5)),"undefined"!=typeof e&&null!==e||(e=r.getRandomInt(50,200)),n=n||"ACDEFGHIKLMNPQRSTVWY---";for(var l=1;1<t?l<=t:l>=t;1<t?l++:l--)a[l-1]="";for(var h=.2,u=1,c=e-1,l=0;0<c?l<=c:l>=c;0<c?l++:l--){l%3===0&&(u=r.getRandomInt(50,100)/100);for(var f=[],d=t-1,g=0;0<d?g<=d:g>=d;0<d?g++:g--){for(var p=0;p<100;){var m=s.getRandomChar(n),v=o(f);if(v.addSeq(m),p++,Math.abs(u-v.scale(v.conservation())[0])<h)break}a[g]+=m,f.push(m)}}for(var b=[],l=1;1<t?l<=t:l>=t;1<t?l++:l--)b.push(new i(a[l-1],"seq"+l,"r"+l));return b}}},function(t,e,n){"use strict";var i,r=n(1);n(32);t.exports=i=function(t){return this.msa=t,this};var o={loadTree:function(t){return this.msa.g.package.loadPackages(["msa-tnt","biojs-io-newick"],t)},showTree:function(t){var e=this.require("biojs-io-newick");if("string"==typeof t)var i=e.parse_newick(t);else i=t;var o=this.require("msa-tnt"),s=new o.selections,a=document.createElement("div");this.msa.el.appendChild(a),console.log(this.msa.seqs.models),console.log(i);var l=o.app({seqs:this.msa.seqs.toJSON(),tree:i});console.log("nodes",l);new o.adapters.tree({model:l,el:a,sel:s}),new o.adapters.msa({model:l,sel:s,msa:this.msa});return r.each(l.models,function(t){return delete t.collection,Object.setPrototypeOf(t,n(2).Model.prototype)}),this.msa.seqs.reset(l.models),console.log(this.msa.seqs)},require:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return n(142)(t)})};r.extend(i.prototype,o)},function(t,e,n){var i=n(38),r=function(){};i.mixin(r),t.exports=r;var o=n(45),s=n(92);r.parseLines=function(t){var e=t.split("\n"),n={},i=[];n.type=r._guessType(e);var o=0;if("jalview"===n.type){var a=s.readHeader(e);o=a.offset,n.colors=a.colors,i=a.features}for(var l=o;l<e.length;l++){var h=e[l];0!==h.length&&"#"!==h[0]&&(h=r.parseLine(h),void 0!==h&&i.push(h))}return{features:i,config:n}},r._guessType=function(t){return"##gff-version 3"===t[0].substring(0,15)?"gff3":t[0].indexOf("#")<0&&2===t[0].split("\t").length?"jalview":"gff3"},r.parseSeqs=r.parse=function(t){var e=r.parseLines(t),n={};return e.features.forEach(function(t){var e=t.seqname;void 0===n[e]&&(n[e]=[]),delete t.seqname,n[e].push(t)}),delete e.features,e.seqs=n,e},r.parseLine=function(t){var e={},n=t.split(/\s+/);if(1!==n.length){e.seqname=n[0],e.source=n[1],e.feature=n[2],e.start=parseInt(n[3]),e.end=parseInt(n[4]),e.score=n[5],e.strand=n[6],e.frame=n[7];var i=n.slice(8).join(" ");return Object.keys(e).forEach(function(t){"string"==typeof e[t]&&(e[t]=e[t].trim()),"."===e[t]&&(e[t]=void 0)}),e.score&&(e.score=parseFloat(e.score)),e.frame&&(e.frame=parseInt(e.frame)),e.attributes=o.extractKeys(i),e}},r.exportLine=function(t){var e=Object.keys(t.attributes).map(function(e){return e+"="+t.attributes[e]}).join(";"),n=[t.seqname,t.source,t.feature,t.start,t.end,t.score,t.strand,t.frame,e];return n=n.map(function(t){return void 0===t?".":t}),n.join("\t")},r.exportLines=function(t){return"##gff-version 3\n"+t.map(r.exportLine).join("\n")},r.exportSeqs=r.export=function(t){var e=[],n=function(t){t.seqname=i,e.push(t)};for(var i in t)t[i].forEach(n);return r.exportLines(e)}},function(t,e,n){var i,r=n(94),o=n(138);t.exports=i=function(){function t(){}return t.read=function(e,n){var i;if(i=function(e){return function(i,r,o){return t._onRetrieval(i,o,n,e)}}(this),"undefined"==typeof n){var s=o.defer();return n=function(t,e){t?s.reject(t):s.resolve(e)},r(e,i),s.promise()}return r(e,i)},t._onRetrieval=function(t,e,n,i){var r;return"undefined"!=typeof t&&(r=i.parse(e)),n.call(i,t,r)},t.extend=function(e,n){return extend(t,e,n)},t.mixin=function(e){var n=["read"];return"object"!=typeof e&&(e=e.prototype),n.forEach(function(n){e[n]=t[n]},this),e},t}()},function(t,e){var n={};t.exports=n,n.getMeta=function(t){var e,n,i=!1,r=!1,o={},s={},a=t.split(" ");if(a.length>=1?(i=a.shift(),r=a.join(" ")):i=t,i){var l=i.split("|");for(e=l.pop(),s.en=e;0!=l.length;){var h=l.shift(),u=l.shift();o[h]=u}}else e=i;if(r){var c=r.split("=");if(c.length>1){var f,d;c.length-1;c.forEach(function(t){t=t.trim();var e,i=t.split(" ");if(i.length>1?(d=i.pop(),e=i.join(" ")):e=t,f){var r=f.toLowerCase();s[r]=e}else n=e;f=d})}else n=c.shift()}var g={name:e,ids:o,details:s};return n&&(g.desc=n),g};var i={sp:{link:"http://www.uniprot.org/%s",name:"Uniprot"},tr:{link:"http://www.uniprot.org/%s",name:"Trembl"},gb:{link:"http://www.ncbi.nlm.nih.gov/nuccore/%s",name:"Genbank"},pdb:{link:"http://www.rcsb.org/pdb/explore/explore.do?structureId=%s",name:"PDB"}};n.buildLinks=function(t){var e={};return t=t||{},Object.keys(t).forEach(function(n){if(n in i){var r=i[n],o=r.link.replace("%s",t[n]);e[r.name]=o}}),e},n.contains=function(t,e){return"".indexOf.call(t,e,0)!==-1},n.splitNChars=function(t,e){var n,i;e=e||80;var r=[];for(n=0,i=t.length-1;n<=i;n+=e)r.push(t.substr(n,e));return r},n.reverse=function(t){return t.split("").reverse().join("")},n.complement=function(t){var e=t+"",n=[[/g/g,"0"],[/c/g,"1"],[/0/g,"c"],[/1/g,"g"],[/G/g,"0"],[/C/g,"1"],[/0/g,"C"],[/1/g,"G"],[/a/g,"0"],[/t/g,"1"],[/0/g,"t"],[/1/g,"a"],[/A/g,"0"],[/T/g,"1"],[/0/g,"T"],[/1/g,"A"]];for(var i in n)e=e.replace(n[i][0],n[i][1]);return e},n.reverseComplement=function(t){return n.reverse(n.complement(t))},n.model=function(t,e,n){this.seq=t,this.name=e,this.id=n,this.ids={}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,n){"use strict";t.exports.SelectionManager=n(9)},function(t,e,n){"use strict";t.exports.seq=n(33),t.exports.seqcol=n(32),t.exports.feature=n(30),t.exports.featurecol=n(31)},function(t,e,n){var i=n(11),r=n(17),o=n(1),s=function(t,e){var n=t||{};e||(e={}),this.cid=o.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(n=this.parse(n,e)||{}),n=o.defaults({},n,o.result(this,"defaults")),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};o.extend(s.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return o.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,s,a,l,h,u,c;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;s=n.unset,l=n.silent,a=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=o.clone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)e=r[i],o.isEqual(c[i],e)||a.push(i),o.isEqual(u[i],e)?delete this.changed[i]:this.changed[i]=e,s?delete c[i]:c[i]=e;if(!l){a.length&&(this._pending=n);for(var f=0,d=a.length;f<d;f++)this.trigger("change:"+a[f],this,c[a[f]],n)}if(h)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,o.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!o.isEmpty(this.changed):o.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&o.clone(this.changed);var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in t)o.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return!!e.set(e.parse(i,t),t)&&(n&&n(e,i,t),void e.trigger("sync",e,i,t))},wrapError(this,t),this.sync("read",this,t)},save:function(t,e,n){var i,r,s,a=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,n=o.extend({validate:!0},n),i&&!n.wait){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=o.extend({},a,i)),void 0===n.parse&&(n.parse=!0);var l=this,h=n.success;return n.success=function(t){l.attributes=a;var e=l.parse(t,n);return n.wait&&(e=o.extend(i||{},e)),!(o.isObject(e)&&!l.set(e,n))&&(h&&h(l,t,n),void l.trigger("sync",l,t,n))},wrapError(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"!==r||n.attrs||(n.attrs=i),s=this.sync(r,this,n),i&&n.wait&&(this.attributes=a),s},destroy:function(t){t=t?o.clone(t):{};var e=this,n=t.success,i=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};if(t.success=function(r){(t.wait||e.isNew())&&i(),n&&n(e,r,t),e.isNew()||e.trigger("sync",e,r,t)},this.isNew())return t.success(),!1;wrapError(this,t);var r=this.sync("delete",this,t);return t.wait||i(),r},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||urlError();return this.isNew()?t:t.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},o.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=o.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return!n||(this.trigger("invalid",this,n,o.extend(e,{validationError:n})),!1)}});var a=["keys","values","pairs","invert","pick","omit","chain","isEmpty"];o.each(a,function(t){o[t]&&(s.prototype[t]=function(){var e=slice.call(arguments);return e.unshift(this.attributes),o[t].apply(o,e)})}),s.extend=r,t.exports=s},function(t,e,n){var i,r,o;r=n(38),o=n(39),t.exports=i={parse:function(t){var e,n,i,r,s,a,l,h,u,c,f,d,g;if(d=[],l="[object Array]"===Object.prototype.toString.call(t)?t:t.split("\n"),l[0].slice(0,6)===!1)throw new Error("Invalid CLUSTAL Header");for(i=0,e=1,f=0;i<l.length;)i++,a=l[i],null!=a&&0!==a.length&&0!==a.trim().length?o.contains(a,"*")||(1===e&&(f=0,e=0),c=/^(?:\s*)(\S+)(?:\s+)(\S+)(?:\s*)(\d*)(?:\s*|$)/g,h=c.exec(a),null!=h?(s=h[1],g=h[2],f>=d.length?(u=o.getMeta(s),s=u.name,n=new o.model(g,s,f),n.ids=u.ids||{},n.details=u.details||{},r=Object.keys(n.ids),r.length>0&&(n.id=n.ids[r[0]]),d.push(n)):d[f].seq+=g,f++):console.log("parse error",a)):e=1;return d}},r.mixin(i)},function(t,e){function n(t){var e=t.toString(16);return 1===e.length?"0"+e:e}var i={};t.exports=i,i.extractKeys=function(t){var e={},n=t.split(";");return n.forEach(function(t){var n,i,r;t.indexOf("=")>0?(n=t.split("="),i=n[0],r=n[1],e[i]=r):t.indexOf(" ")>0&&(n=t.split(" "),i=n[0],r=n[1].replace(/"/g,""),e[i]=r)}),e},i.rgbToHex=function(t,e,r){return 3===t.length?i.rgbToHex(t[0],t[1],t[2]):"#"+n(t)+n(e)+n(r)}},function(t,e){t.exports=function(t,e,n){t.beginPath(),t.moveTo(0,e),t.lineTo(n,e),t.lineWidth=1,t.strokeStyle="#999999",t.stroke()}},function(t,e){t.exports=function(t,e,n,i,r,o,s){t.font=o+"px Arial",t.textAlign=s?"right":"center",t.fillStyle="#666666",t.fillText(r,e+i/2,n)}},function(t,e){t.exports=function(t,e,n,i,r){r=r||"#999999",t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+i),t.lineWidth=1,t.strokeStyle=r,t.stroke()}},function(t,e){var n;t.exports=n={rel:function(t){var e,n,i,r;return e=t.offsetX,n=t.offsetY,void 0==e&&(i=r.getBoundingClientRect(),r=t.target||t.srcElement,void 0==e&&(e=t.clientX-i.left,n=t.clientY-i.top),void 0==e&&(e=t.pageX-r.offsetLeft,n=t.pageY-r.offsetTop),void 0==e)?void console.log(t,"no mouse event defined. your browser sucks"):[e,n]},abs:function(t){var e,n;return e=t.pageX,n=t.pageY,void 0==e&&(e=t.layerX,n=t.layerY),void 0==e&&(e=t.clientX,n=t.clientY),void 0==e&&(e=t.x,n=t.y),[e,n]},wheelDelta:function(t){var e;return e=[t.deltaX,t.deltaY],void 0==e[0]&&t.mozMovementX&&(e=[0,t.mozMovementX]),isNaN(e[0])&&(e[0]=0),isNaN(e[1])&&(e[1]=0),e}}},function(t,e){var n=function(t){return t.replace(/^\s+|\s+$/g,"")},i=function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t){if(!t)return{};for(var e={},r=n(t).split("\n"),o=0;o<r.length;o++){var s=r[o],a=s.indexOf(":"),l=n(s.slice(0,a)).toLowerCase(),h=n(s.slice(a+1));"undefined"==typeof e[l]?e[l]=h:i(e[l])?e[l].push(h):e[l]=[e[l],h]}return e}},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function o(t){if(c===clearTimeout)return clearTimeout(t);if((c===i||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}function s(){p&&d&&(p=!1,d.length?g=d.concat(g):m=-1,g.length&&a())}function a(){if(!p){var t=r(s);p=!0;for(var e=g.length;e;){for(d=g,g=[];++m<e;)d&&d[m].run();m=-1,e=g.length}d=null,p=!1,o(t)}}function l(t,e){this.fun=t,this.array=e}function h(){}var u,c,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{c="function"==typeof clearTimeout?clearTimeout:i}catch(t){c=i}}();var d,g=[],p=!1,m=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];g.push(new l(t,e)),1!==g.length||p||r(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=h,f.addListener=h,f.once=h,f.off=h,f.removeListener=h,f.removeAllListeners=h,f.emit=h,f.prependListener=h,f.prependOnceListener=h,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){var i=n(1),r=function(t,e){if(!this||this.constructor!==r)return new r(t);if(void 0===t||"string"==typeof t)throw new TypeError("you need to give the seq stat an array");this.resetSeqs(t),this.alphabetSize=4,this._useBackground=!1,this.useGaps=!1,this.ignoredChars=["-","*"],i.extend(this,e)};r.prototype.addSeq=function(t){this.seqs.push(t),this._reset()},r.prototype.removeSeq=function(t){"number"==typeof t?this.seqs.splice(t,1):i.each(this.seqs,function(e,n){t===e&&this.seqs.splice(n,1)}.bind(this)),this._reset()},r.prototype.addSeqs=function(t){t.forEach(function(t){this.addSeq(t)}.bind(this))},r.prototype.resetSeqs=function(t){if(this.seqs=[],!t instanceof Array||"_byId"in t){this.mseqs=t;var e=function(){var t=this.mseqs.pluck("seq");this.resetSeqs(t)};t.on("add change reset ",e,this),e.call(this)}else this.addSeqs(t),this._reset(),this.trigger("reset")};var o=["consensus","frequency","maxLength","ic","gaps"];r.prototype._reset=function(){for(var t=0;t<o.length;t++)this["_"+o[t]]=void 0;this._identity=void 0,this._background=void 0},r.prototype.setBackground=function(t){this._useBackground=t,this._reset()},r.prototype.useBackground=function(){this.setBackground(!0)},r.prototype.setDNA=function(){this.alphabetSize=4},r.prototype.setProtein=function(){this.alphabetSize=20},o.forEach(function(t){r.prototype[t]=function(){return void 0===this["_"+t]&&(this["_"+t]=this[t+"Calc"]()),this["_"+t]}}),r.prototype.identity=function(t){var e;return(void 0===this._identity||t)&&(e=this.identityCalc(t),this._identity=void 0),this._identity||e},r.prototype.background=function(){return void 0!==this.bg?this.bg:(void 0===this._background&&this.backgroundCalc(),this._background)},r.prototype.frequencyCalc=function(t){var e,n;e=new Array(this.maxLength()),n=new Array(this.seqs.length);var r=this.ignoredChars;return void 0!==t&&t.all&&(r=[]),i.each(this.seqs,function(t){i.each(t,function(t,i){r.indexOf(t)>=0||(void 0===e[i]&&(e[i]={}),void 0===e[i][t]&&(e[i][t]=0),e[i][t]++,void 0===n[i]&&(n[i]=0),n[i]++)})}),i.each(e,function(t,r){return i.each(t,function(t,i){return e[r][i]=t/n[r]})}),this._frequency=e,e},r.prototype.backgroundCalc=function(){var t={},e=0;return i.each(this.seqs,function(n){i.each(n,function(n){return void 0===t[n]&&(t[n]=0),t[n]++,e++})}),t=i.mapValues(t,function(t){return t/e}),this._background=t,t},r.prototype.icCalc=function(){var t=this.frequency();if(this._useBackground)var e=this.background();var n=this.ignoredChars,r=this._useBackground,o=i.map(t,function(t){return i.reduce(t,function(t,i,o){return n.indexOf(o)>=0?t:(r&&(i/=e[o]),t-i*(Math.log(i)/Math.log(2)))},0)});return this._ic=o,o},r.prototype.conservation=function(t){var e=this.ic(),n=this.gaps(),r=this;t=t||this.alphabetSize;var o=Math.log(t)/Math.log(2),s=0,a=i.map(e,function(t){var e=o-t;return r.useGaps&&(e*=1-n[s++]),e});return a},r.prototype.conservResidue=function(t){var e,n=t?t.alphabetSize:void 0,r=this.ignoredChars;e=void 0!==t&&t.scaled?this.scale(this.conservation(n)):this.conservation(n);var o,s=this.frequency(),a=i.map(s,function(t,n){o=i.reject(i.keys(t),function(t){return r.indexOf(t)>=0});var s={};return i.each(o,function(i){s[i]=t[i]*e[n]}),s});return a},r.prototype.conservResidue2=function(t){var e=this.frequency(),n=this.conservation(t),r=this.background(),o=i.map(e,function(t,o){return i.map(t,function(t){var s=i.reduce(e[o],function(t,e){return t+e/r[o]},0);return t/r[o]/s*n[o]},0)});return o},r.prototype.scale=function(t,e){e=e||this.alphabetSize;var n=Math.log(e)/Math.log(2),r=i.map(t,function(t){return t/n});return r},r.prototype.maxLengthCalc=function(){return 0===this.seqs.length?0:i.max(this.seqs,function(t){return t.length}).length},r.prototype.consensusCalc=function(){var t=new Array(this.maxLength());return i.each(this.seqs,function(e){i.each(e,function(e,n){void 0===t[n]&&(t[n]={}),void 0===t[n][e]&&(t[n][e]=0),t[n][e]++})}),this._consensus=i.reduce(t,function(t,e){var n;return n=i.keys(e),t+=i.max(n,function(t){return e[t]})},""),this._consensus},r.prototype.identityCalc=function(t){var e=t||this.consensus();return this._identity=this.seqs.map(function(t){for(var n=0,i=0,r=0;r<t.length;r++)"-"!==t[r]&&"-"!==e[r]&&(i++,t[r]===e[r]&&n++);return n/i}),this._identity},r.prototype.gapsCalc=function(){var t=this.maxLength();if(t<=1||"undefined"==typeof t)return[];var e=new Array(this.maxLength());return i.each(this.seqs,function(t){i.each(t,function(t,n){void 0===e[n]&&(e[n]={g:0,t:0}),t="-"===t?"g":"t",e[n][t]++})}),this._gaps=i.map(e,function(t){return t.g/(t.g+t.t)}),this._gaps},i.mixin({mapValues:function(t,e){return i.object(i.keys(t),i.map(t,e))}}),n(18).mixin(r.prototype),t.exports=r},function(t,e,n){"use strict";var i=n(67);t.exports=window.msa=function(){var t=function(t){return i.apply(this,t)};return t.prototype=i.prototype,new t(arguments)},t.exports.msa=i,t.exports.model=n(42),t.exports.menu=n(55),t.exports.utils=n(34),t.exports.selection=n(8),t.exports.selcol=n(9),t.exports.view=n(3),t.exports.boneView=n(5),t.exports._=n(1),t.exports.$=n(7),t.exports.io={},t.exports.io.xhr=n(21),t.exports.io.fasta=n(19),t.exports.io.clustal=n(44),t.exports.io.gff=n(37),t.exports.version="0.2.0"},function(t,e,n){"use strict";var i,r=n(5),o=n(63),s=n(61),a=n(65),l=n(66),h=n(57),u=n(64),c=n(60),f=n(59),d=n(62),g=n(58),p=n(56);t.exports=i=r.extend({initialize:function(t){if(!t.msa)throw new Error("No msa instance provided. Please provide .msa");if(this.msa=t.msa,this.msa.g.menuconfig=new p(t.menu),this.addView("10_import",new o({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("15_ordering",new u({model:this.msa.seqs,g:this.msa.g})),this.addView("20_filter",new s({model:this.msa.seqs,g:this.msa.g})),this.addView("30_selection",new a({model:this.msa.seqs,g:this.msa.g})),this.addView("40_vis",new l({model:this.msa.seqs,g:this.msa.g})),this.addView("50_color",new h({model:this.msa.seqs,g:this.msa.g})),this.addView("70_extra",new c({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("80_export",new f({model:this.msa.seqs,g:this.msa.g,msa:this.msa})),this.addView("90_help",new d({g:this.msa.g})),this.msa.g.config.get("debug"))return this.addView("95_debug",new g({g:this.msa.g}))},render:function(){return this.renderSubviews(),this.el.setAttribute("class","smenubar"),this.el.appendChild(document.createElement("p"))}})},function(t,e,n){"use strict";t.exports.defaultmenu=n(54),t.exports.menubuilder=n(4)},function(t,e,n){"use strict";var i,r=n(2).Model;t.exports=i=r.extend({constructor:function(t,e){return"small"==t&&(t=this.small),r.apply(this,[t])},small:{menuFontsize:"12px"},defaults:{menuFontsize:"14px",menuItemFontsize:"14px",menuItemLineHeight:"14px",menuMarginLeft:"3px",menuPadding:"3px 4px 3px 4px"}})},function(t,e,n){"use strict";var i,r=n(4),o=(n(1),n(6));t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.listenTo(this.g.colorscheme,"change",function(){return this.render()})},render:function(){var t=this.setName("Color scheme");this.removeAllNodes();for(var e,n=this.getColorschemes(),i=0;i<n.length;i++)e=n[i],this.addScheme(t,e);return this.grey(t),o.removeAllChilds(this.el),this.el.appendChild(this.buildDOM()),this},addScheme:function(t,e){var n=this,i={},r=this.g.colorscheme.get("scheme");return r===e.id&&(i.backgroundColor="#77ED80"),this.addNode(e.name,function(){n.g.colorscheme.set("scheme",e.id)},{style:i})},getColorschemes:function(){var t=[];return t.push({name:"Taylor",id:"taylor"}),t.push({name:"Buried",id:"buried"}),t.push({name:"Cinema",id:"cinema"}),t.push({name:"Clustal",id:"clustal"}),t.push({name:"Clustal2",id:"clustal2"}),t.push({name:"Helix",id:"helix"}),t.push({name:"Hydrophobicity",id:"hydro"}),t.push({name:"Lesk",id:"lesk"}),t.push({name:"MAE",id:"mae"}),t.push({name:"Nucleotide",id:"nucleotide"}),t.push({name:"Purine",id:"purine"}),t.push({name:"PID",id:"pid"}),t.push({name:"Strand",id:"strand"}),t.push({name:"Turn",id:"turn"}),t.push({name:"Zappo",id:"zappo"}),t.push({name:"No color",id:"foo"}),t},grey:function(t){}})},function(t,e,n){"use strict";var i,r=n(4);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){var t=this;return this.setName("Debug"),this.addNode("Get the code",function(){return window.open("https://github.com/wilzbach/msa")}),this.addNode("Toggle mouseover events",function(){return t.g.config.set("registerMouseHover",!t.g.config.get("registerMouseHover")),t.g.onAll(function(){return console.log(arguments)})}),this.addNode("Minimized width",function(){return t.g.zoomer.set("alignmentWidth",600)}),this.addNode("Minimized height",function(){return t.g.zoomer.set("alignmentHeight",120)}),this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4),o=(n(19).writer,n(1),n(13));t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.msa=t.msa,this.el.style.display="inline-block"},render:function(){var t=this;return this.setName("Export"),this.addNode("Share view (URL) ",function(){return o.shareLink(t.msa,function(t){return window.open(t,"_blank")})}),this.addNode("View in Jalview",function(){var e=t.g.config.get("url");return"undefined"==typeof e||null===e?alert("Sequence weren't imported via an URL"):e.indexOf("localhost")?o.publishWeb(t.msa,function(e){return o.openInJalview(e,t.g.colorscheme.get("scheme"))}):o.openInJalview(e,t.g.colorscheme.get("scheme"))}),this.addNode("Export alignment (FASTA)",function(){return o.saveAsFile(t.msa,"all.fasta")}),this.addNode("Export alignment (URL)",function(){return o.publishWeb(t.msa,function(t){return window.open(t,"_blank")})}),this.addNode("Export selected sequences (FASTA)",function(){return o.saveSelection(t.msa,"selection.fasta")}),this.addNode("Export features (GFF)",function(){return o.saveAnnots(t.msa,"features.gff3")}),this.addNode("Export MSA image (PNG)",function(){return o.saveAsImg(t.msa,"biojs-msa.png")}),this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4),o=n(33);n(15),n(21);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.msa=t.msa},render:function(){var t=this;this.setName("Extras");var e=this.g.stats;this.msa;return this.addNode("Add consensus seq",function(){var n=e.consensus(),i=new o({seq:n,id:"0c",name:"Consenus"});return t.model.add(i),t.model.setRef(i),t.model.comparator=function(t){return!t.get("ref")},t.model.sort()}),this.addNode("Increase font size",function(){var e=t.g.zoomer.get("columnWidth"),n=e+5;t.g.zoomer.set("columnWidth",n),t.g.zoomer.set("rowHeight",n);var i=.7*n;return t.g.zoomer.set("residueFont",i),t.g.zoomer.set("labelFontSize",i)}),this.addNode("Decrease font size",function(){var e=t.g.zoomer.get("columnWidth"),n=e-2;t.g.zoomer.set("columnWidth",n),t.g.zoomer.set("rowHeight",n);var i=.6*n;if(t.g.zoomer.set("residueFont",i),t.g.zoomer.set("labelFontSize",i),t.g.zoomer.get("columnWidth")<8)return t.g.zoomer.set("textVisible",!1)}),this.addNode("Jump to a column",function(){var e=prompt("Column","20");return e<0||e>t.model.getMaxLength()||isNaN(e)?void alert("invalid column"):t.g.zoomer.setLeftOffset(e)}),this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4),o=n(1);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){var t=this;return this.setName("Filter"),this.addNode("Hide columns by threshold",function(e){var n=prompt("Enter threshold (in percent)",20);n/=100;for(var i=t.model.getMaxLength(),r=[],o=t.g.stats.scale(t.g.stats.conservation()),s=i-1,a=0;0<s?a<=s:a>=s;0<s?a++:a--)o[a]<n&&r.push(a);return t.g.columns.set("hidden",r)}),this.addNode("Hide columns by selection",function(){var e=t.g.columns.get("hidden"),n=e.concat(t.g.selcol.getAllColumnBlocks({maxLen:t.model.getMaxLength(),withPos:!0}));return t.g.selcol.reset([]),t.g.columns.set("hidden",n)}),this.addNode("Hide columns by gaps",function(){var e=prompt("Enter threshold (in percent)",20);e/=100;for(var n=t.model.getMaxLength(),i=[],r=n-1,o=0;0<r?o<=r:o>=r;0<r?o++:o--){var s=0,a=0;t.model.each(function(t){return"-"===t.get("seq")[o]&&s++,a++});var l=s/a;l>e&&i.push(o)}return t.g.columns.set("hidden",i)}),this.addNode("Hide seqs by identity",function(){var e=prompt("Enter threshold (in percent)",20);return e/=100,t.model.each(function(t){if(t.get("identity")<e)return t.set("hidden",!0)})}),this.addNode("Hide seqs by selection",function(){var e=t.g.selcol.where({type:"row"}),n=o.map(e,function(t){return t.get("seqId")});return t.g.selcol.reset([]),t.model.each(function(t){if(n.indexOf(t.get("id"))>=0)return t.set("hidden",!0)})}),this.addNode("Hide seqs by gaps",function(){var e=prompt("Enter threshold (in percent)",40);return t.model.each(function(t,n){var i=t.get("seq"),r=o.reduce(i,function(t,e){return"-"===e?++t:void 0},0);if(r>e)return t.set("hidden",!0)})}),this.addNode("Reset",function(){return t.g.columns.set("hidden",[]),t.model.each(function(t){if(t.get("hidden"))return t.set("hidden",!1)})}),this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4);t.exports=i=r.extend({initialize:function(t){return this.g=t.g},render:function(){return this.setName("Help"),this.addNode("About the project",function(){return window.open("https://github.com/wilzbach/msa")}),this.addNode("Report issues",function(){return window.open("https://github.com/wilzbach/msa/issues")}),this.addNode("User manual",function(){return window.open("https://github.com/wilzbach/msa/wiki")}),this.el.style.display="inline-block",this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4),o=n(20);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.msa=t.msa},render:function(){var t=this,e=this.msa,n=o.mk("input");n.type="file",n.style.display="none",n.multiple=!0,n.addEventListener("change",function(){var t=n.files||[];return e.u.file.importFiles(t)}),this.el.appendChild(n);var i="(Fasta, Clustal, GFF, Jalview features, Newick)";return this.setName("Import"),this.addNode("URL",function(e){var n=prompt("URL "+i,"http://rostlab.org/~goldberg/clustalw2-I20140818-215249-0556-53699878-pg.clustalw");if(n.length>5)return t.msa.u.file.importURL(n,function(){})}),this.addNode("From file "+i,function(){return n.click()}),this.addNode("Drag & Drop",function(){return alert("Yep. Just drag & drop your file "+i)}),this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4),o=n(6),s=n(1);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.order="ID",this.el.style.display="inline-block"},setOrder:function(t){return this.order=t,this.render()},render:function(){this.setName("Sorting"),this.removeAllNodes();for(var t,e=this.getComparators(),n=0;n<e.length;n++)t=e[n],this._addNode(t);var i=this.buildDOM();return o.removeAllChilds(this.el),this.el.appendChild(i),this},_addNode:function(t){var e=this,n=t.text,i={};return n===this.order&&(i.backgroundColor="#77ED80"),this.addNode(n,function(){return null!=t.precode&&t.precode(),e.model.comparator=t.comparator,e.model.sort(),e.setOrder(t.text)},{style:i})},getComparators:function(){var t=this,e=[];e.push({text:"ID ",comparator:"id"}),e.push({text:"ID ",comparator:function(t,e){return-(""+t.get("id")).localeCompare(""+e.get("id"),[],{numeric:!0})}}),e.push({text:"Label ",comparator:"name"
}),e.push({text:"Label ",comparator:function(t,e){return-t.get("name").localeCompare(e.get("name"))}}),e.push({text:"Seq ",comparator:"seq"}),e.push({text:"Seq ",comparator:function(t,e){return-t.get("seq").localeCompare(e.get("seq"))}});var n=function(){return t.ident=t.g.stats.identity()},i=function(){return t.gaps={},t.model.each(function(e){var n=e.attributes.seq;return t.gaps[e.id]=s.reduce(n,function(t,e){return"-"===e?++t:void 0},0)/n.length})};return e.push({text:"Identity ",comparator:function(e,n){var i=t.ident[e.id]-t.ident[n.id];return console.log(t.ident[e.id],t.ident[n.id]),i>0?1:i<0?-1:0},precode:n}),e.push({text:"Identity ",comparator:function(e,n){var i=t.ident[e.id]-t.ident[n.id];return i>0?-1:i<0?1:0},precode:n}),e.push({text:"Gaps ",comparator:function(e,n){var i=t.gaps[e.id]-t.gaps[n.id];return i>0?1:i<0?-1:0},precode:i}),e.push({text:"Gaps ",comparator:function(e,n){var i=t.gaps[e.id]-t.gaps[n.id];return i<0?1:i>0?-1:0},precode:i}),e.push({text:"Consensus to top",comparator:function(t){return!t.get("ref")}}),e}})},function(t,e,n){"use strict";var i,r=n(4);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block"},render:function(){var t=this;return this.setName("Selection"),this.addNode("Find Motif (supports RegEx)",function(){var e=prompt("your search","D");return t.g.user.set("searchText",e)}),this.addNode("Invert columns",function(){return t.g.selcol.invertCol(function(){var t=[],e=this.model.getMaxLength(),n=0;if(0<=e)for(;n<=e;)t.push(n++);else for(;n>=e;)t.push(n--);return t}())}),this.addNode("Invert rows",function(){return t.g.selcol.invertRow(t.model.pluck("id"))}),this.addNode("Reset",function(){return t.g.selcol.reset()}),this.el.appendChild(this.buildDOM()),this}})},function(t,e,n){"use strict";var i,r=n(4),o=n(6);t.exports=i=r.extend({initialize:function(t){return this.g=t.g,this.el.style.display="inline-block",this.listenTo(this.g.vis,"change",this.render)},render:function(){var t=this;this.removeAllNodes(),this.setName("Vis.elements");for(var e,n=this.getVisElements(),i=0;i<n.length;i++)e=n[i],this._addVisEl(e);return this.addNode("Reset",function(){return t.g.vis.set("labels",!0),t.g.vis.set("sequences",!0),t.g.vis.set("metacell",!0),t.g.vis.set("conserv",!0),t.g.vis.set("labelId",!0),t.g.vis.set("labelName",!0),t.g.vis.set("labelCheckbox",!1),t.g.vis.set("seqlogo",!1),t.g.vis.set("gapHeader",!1),t.g.vis.set("leftHeader",!0),t.g.vis.set("metaGaps",!0),t.g.vis.set("metaIdentity",!0),t.g.vis.set("metaLinks",!0)}),o.removeAllChilds(this.el),this.el.appendChild(this.buildDOM()),this},_addVisEl:function(t){var e=this,n={};if(this.g.vis.get(t.id)){var i="Hide ";n.color="red"}else i="Show ",n.color="green";return this.addNode(i+t.name,function(){return e.g.vis.set(t.id,!e.g.vis.get(t.id))},{style:n})},getVisElements:function(){var t=[];return t.push({name:"residues indices",id:"markers"}),t.push({name:"ID/Label",id:"labels"}),t.push({name:"meta info (Gaps/Ident)",id:"metacell"}),t.push({name:"overview panel",id:"overviewbox"}),t.push({name:"sequence logo",id:"seqlogo"}),t.push({name:"gap weights",id:"gapHeader"}),t.push({name:"conservation weights",id:"conserv"}),t.push({name:"Label",id:"labelName"}),t.push({name:"ID",id:"labelId"}),t.push({name:"gaps %",id:"metaGaps"}),t.push({name:"identity score",id:"metaIdentity"}),t}})},function(t,e,n){"use strict";var i=n(32),r=n(22),o=n(23),s=n(24),a=n(25),l=n(9),h=n(26),u=n(28),c=n(27),f=n(29),d=n(5),g=n(18),p=n(71),m=n(52),v=n(7),b=n(14),x=n(36),y=n(16);t.exports=d.extend({initialize:function(t){var e=this;if("undefined"!=typeof t&&null!==t||(t={}),null==t.colorscheme&&(t.colorscheme={}),null==t.columns&&(t.columns={}),null==t.conf&&(t.conf={}),null==t.vis&&(t.vis={}),null==t.visorder&&(t.visorder={}),null==t.zoomer&&(t.zoomer={}),this.g=g.mixin({}),this.seqs=this.g.seqs=new i(t.seqs,this.g),this.g.config=new s(t.conf),this.g.package=new a(this.g),this.g.selcol=new l([],{g:this.g}),this.g.user=new h,this.g.vis=new u(t.vis,{model:this.seqs}),this.g.visorder=new c(t.visorder),this.g.zoomer=new f(t.zoomer,{g:this.g,model:this.seqs}),"localhost"===window.location.hostname&&this.g.config.set("debug",!0),this._loadSeqs(t),this.u={},this.u.file=new b(this),this.u.proxy=new y({g:this.g}),this.u.tree=new x(this),this.g.config.get("eventBus")===!0&&this.startEventBus(),this.g.config.get("dropImport")){var n={dragover:this.dragOver,drop:this.dropFile};this.delegateEvents(n)}return t.importURL&&this.u.file.importURL(t.importURL,function(){return e.render()}),t.bootstrapMenu&&(t.menu&&(this.menuConfig=t.menu),this.g.config.set("bootstrapMenu",!0)),this.draw(),this.m()},_loadSeqs:function(t){var e=this.seqs.pluck("seq");return this.g.stats=new m(this.seqs,{useGaps:!0}),this.g.stats.alphabetSize=this.g.config.get("alphabetSize"),this.g.columns=new o(t.columns,this.g.stats),this.g.colorscheme=new r(t.colorscheme,e,this.g.stats),this.g.zoomer.setEl(this.el,this.seqs)},importURL:function(){return this.u.file.importURL.apply(this.u.file,arguments)},m:function t(){var t={};return t.model=n(42),t.selection=n(8),t.selcol=n(9),t.view=n(3),t.boneView=n(5),this.m=t},draw:function(){var t=this;if(this.removeViews(),this.addView("stage",new p({model:this.seqs,g:this.g})),this.el.setAttribute("class","biojs_msa_div"),this.g.config.get("bootstrapMenu")){var e=document.createElement("div"),n=document.createElement("div");this.el.parentNode?(this.el.parentNode.replaceChild(n,this.el),n.appendChild(e),n.appendChild(this.el)):(n.appendChild(e),n.appendChild(this.el));var i={el:e,msa:this};this.menuConfig&&(i.menu=this.menuConfig);var r=new msa.menu.defaultmenu(i);r.render()}return v(window).on("resize",function(e){var n=function(){return this.g.zoomer.autoResize()};return setTimeout(n.bind(t),5)})},dragOver:function(t){return t.preventDefault(),t.target.className="hover",!1},dropFile:function(t){t.preventDefault();var e=t.target.files||t.dataTransfer.files;return this.u.file.importFiles(e),!1},startEventBus:function(){var t=this,e=["config","columns","colorscheme","selcol","vis","visorder","zoomer"];return function(){for(var n,i=[],r=0;r<e.length;r++)n=e[r],i.push(t._proxyToG(n));return i}()},_proxyToG:function(t){return this.listenTo(this.g[t],"all",function(e,n,i,r){if("change"!==e)return"undefined"!=typeof r&&null!==r?this.g.trigger(t+":"+e,i,n,r):this.g.trigger(t+":"+e,i,n)})},render:function(){return void 0!==this.seqs&&0!==this.seqs.length||console.log("warning. empty seqs."),this.renderSubviews(),this.g.vis.set("loaded",!0),this}})},function(t,e,n){"use strict";var i=n(5),r=n(75),o=n(84);t.exports=i.extend({initialize:function(t){this.g=t.g;var e=new o({model:this.model,g:this.g});if(e.ordering=-1,this.addView("labelblock",e),this.g.vis.get("sequences")){var n=new r({model:this.model,g:this.g});n.ordering=0,this.addView("seqblock",n)}return this.listenTo(this.g.zoomer,"change:alignmentHeight",this.adjustHeight),this.listenTo(this.g.zoomer,"change:alignmentWidth",this.adjustWidth),this.listenTo(this.g.columns,"change:hidden",this.adjustHeight)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_albody",this.el.style.whiteSpace="nowrap",this.adjustHeight(),this.adjustWidth(),this},adjustHeight:function(){return"auto"===this.g.zoomer.get("alignmentHeight")?this.el.style.height=this.g.zoomer.get("rowHeight")*this.model.length+5:this.el.style.height=this.g.zoomer.get("alignmentHeight")},adjustWidth:function(){return this.el.style.width=this.getWidth()},getWidth:function(){var t=0;return t+=this.g.zoomer.getLeftBlockWidth(),this.g.vis.get("sequences")&&(t+=this.g.zoomer.get("alignmentWidth")),t}})},function(t,e,n){"use strict";var i,r=n(3),o=n(49),s=n(8),a=n(7),l=n(1);t.exports=i=r.extend({className:"biojs_msa_overviewbox",tagName:"canvas",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:boxRectWidth change:boxRectHeight change:overviewboxPaddingTop",this.rerender),this.listenTo(this.g.selcol,"add reset change",this.rerender),this.listenTo(this.g.columns,"change:hidden",this.rerender),this.listenTo(this.g.colorscheme,"change:showLowerCase",this.rerender),this.listenTo(this.model,"change",l.debounce(this.rerender,5)),this.color=this.g.colorscheme.getSelectedScheme(),this.listenTo(this.g.colorscheme,"change:scheme",function(){return this.color=this.g.colorscheme.getSelectedScheme(),this.rerender()}),this.dragStart=[]},events:{click:"_onclick",mousedown:"_onmousedown"},rerender:function(){if(!this.g.config.get("manualRendering"))return this.render()},render:function(){this._createCanvas(),this.el.textContent="overview",this.el.style.marginTop=this.g.zoomer.get("overviewboxPaddingTop"),this.ctx.fillStyle="#999999",this.ctx.fillRect(0,0,this.el.width,this.el.height);for(var t=this.g.zoomer.get("boxRectWidth"),e=this.g.zoomer.get("boxRectHeight"),n=this.g.columns.get("hidden"),i=this.g.colorscheme.get("showLowerCase"),r=-e,o=this.model.length-1,s=0;0<o?s<=o:s>=o;0<o?s++:s--){var a=this.model.at(s).get("seq"),l=0;if(r+=e,this.model.at(s).get("hidden"))console.log(this.model.at(s).get("hidden")),this.ctx.fillStyle="grey",this.ctx.fillRect(0,r,a.length*t,e);else for(var h=a.length-1,u=0;0<h?u<=h:u>=h;0<h?u++:u--){var c=a[u];i&&(c=c.toUpperCase());var f=this.color.getColor(c,{pos:u});n.indexOf(u)>=0&&(f="grey"),"undefined"!=typeof f&&null!==f&&(this.ctx.fillStyle=f,this.ctx.fillRect(l,r,t,e)),l+=t}}return this._drawSelection()},_drawSelection:function(){if(!(this.dragStart.length>0)||this.prolongSelection){var t=this.g.zoomer.get("boxRectWidth"),e=this.g.zoomer.get("boxRectHeight"),n=e*this.model.length;this.ctx.fillStyle="#666666",this.ctx.globalAlpha=.9;for(var i=this.g.selcol.length-1,r=0;0<i?r<=i:r>=i;0<i?r++:r--){var o=this.g.selcol.at(r);if(o)if("column"===o.get("type"))this.ctx.fillRect(t*o.get("xStart"),0,t*(o.get("xEnd")-o.get("xStart")+1),n);else if("row"===o.get("type")){var s=this.model.filter(function(t){return t.get("id")===o.get("seqId")})[0],a=this.model.indexOf(s);this.ctx.fillRect(0,e*a,t*s.get("seq").length,e)}else"pos"===o.get("type")&&(s=this.model.filter(function(t){return t.get("id")===o.get("seqId")})[0],a=this.model.indexOf(s),this.ctx.fillRect(t*o.get("xStart"),e*a,t*(o.get("xEnd")-o.get("xStart")+1),e))}return this.ctx.globalAlpha=1}},_onclick:function(t){return this.g.trigger("meta:click",{seqId:this.model.get("id",{evt:t})})},_onmousemove:function(t){if(0!==this.dragStart.length){this.render(),this.ctx.fillStyle="#666666",this.ctx.globalAlpha=.9;var e=this._calcSelection(o.abs(t));return this.ctx.fillRect(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0]),t.preventDefault(),t.stopPropagation()}},_onmousedown:function(t){var e=this;return this.dragStart=o.abs(t),this.dragStartRel=o.rel(t),t.ctrlKey||t.metaKey?this.prolongSelection=!0:this.prolongSelection=!1,a(document.body).on("mousemove.overmove",function(t){return e._onmousemove(t)}),a(document.body).on("mouseup.overup",function(t){return e._onmouseup(t)}),this.dragStart},_calcSelection:function(t){for(var e=[t[0]-this.dragStart[0],t[1]-this.dragStart[1]],n=0;n<=1;n++)e[n]=this.dragStartRel[n]+e[n];for(var i=[[this.dragStartRel[0],e[0]],[this.dragStartRel[1],e[1]]],n=0;n<=1;n++)i[n][1]<i[n][0]&&(i[n]=[i[n][1],i[n][0]]),i[n][0]=Math.max(i[n][0],0);return i},_endSelection:function(t){if(a(document.body).off(".overmove"),a(document.body).off(".overup"),0!==this.dragStart.length){for(var e=this._calcSelection(t),n=0;n<=1;n++)e[0][n]=Math.floor(e[0][n]/this.g.zoomer.get("boxRectWidth"));for(var n=0;n<=1;n++)e[1][n]=Math.floor(e[1][n]/this.g.zoomer.get("boxRectHeight"));e[0][1]=Math.min(this.model.getMaxLength()-1,e[0][1]),e[1][1]=Math.min(this.model.length-1,e[1][1]);for(var i=[],r=e[1][0];e[1][0]<e[1][1]?r<=e[1][1]:r>=e[1][1];e[1][0]<e[1][1]?r++:r--){var o={seqId:this.model.at(r).get("id"),xStart:e[0][0],xEnd:e[0][1]};i.push(new s.possel(o))}return this.dragStart=[],this.prolongSelection?this.g.selcol.add(i):this.g.selcol.reset(i),this.g.zoomer.setLeftOffset(e[0][0]),this.g.zoomer.setTopOffset(e[1][0])}},_onmouseup:function(t){return this._endSelection(o.abs(t))},_onmouseout:function(t){return this._endSelection(o.abs(t))},_createCanvas:function(){var t=this.g.zoomer.get("boxRectWidth"),e=this.g.zoomer.get("boxRectHeight");return this.el.height=this.model.length*e,this.el.width=this.model.getMaxLength()*t,this.ctx=this.el.getContext("2d"),this.el.style.overflow="scroll",this.el.style.cursor="crosshair"}})},function(t,e,n){"use strict";var i=n(5),r=(n(1),n(20)),o=(n(6),n(8));t.exports=i.extend({initialize:function(t){return this.g=t.g,this.listenTo(this.g.user,"change:searchText",function(t,e){return this.search(e),this.render()}),this.sel=[],this.selPos=0},events:{scroll:"_sendScrollEvent"},render:function(){this.renderSubviews(),this.el.className="biojs_msa_searchresult";var t=this.g.user.get("searchText");return"undefined"!=typeof t&&null!==t&&t.length>0&&(0===this.sel.length?this.el.textContent="no selection found":(this.resultBox=r.mk("div"),this.resultBox.className="biojs_msa_searchresult_ovbox",this.updateResult(),this.el.appendChild(this.resultBox),this.el.appendChild(this.buildBtns()))),this},updateResult:function(){var t="search pattern: "+this.g.user.get("searchText");t+=", selection: "+(this.selPos+1);var e=this.sel[this.selPos];return t+=" (",t+=e.get("xStart")+" - "+e.get("xEnd"),t+=", id: "+e.get("seqId"),t+=")",this.resultBox.textContent=t},buildBtns:function(){var t=this,e=r.mk("button");e.textContent="Prev",e.addEventListener("click",function(){return t.moveSel(-1)});var n=r.mk("button");n.textContent="Next",n.addEventListener("click",function(){return t.moveSel(1)});var i=r.mk("button");i.textContent="All",i.addEventListener("click",function(){return t.g.selcol.reset(t.sel)});var o=r.mk("div");return o.appendChild(e),o.appendChild(n),o.appendChild(i),o.className="biojs_msa_searchresult_row",o},moveSel:function(t){var e=this.selPos+t;return e<0||e>=this.sel.length?-1:(this.focus(e),this.selPos=e,this.updateResult())},focus:function(t){var e=this.sel[t],n=e.get("xStart");return this.g.zoomer.setLeftOffset(n),this.g.selcol.reset([e])},search:function t(e){var n,t=new RegExp(e,"gi"),i=[],r=n=100042;return this.model.each(function(e){var n=e.get("seq");return function(){for(var s,a=[];s=t.exec(n);){var l=s.index,h={xStart:l,xEnd:l+s[0].length-1,seqId:e.get("id")};i.push(new o.possel(h)),a.push(r=Math.min(l,r))}return a}()}),this.g.selcol.reset(i),r===n&&(r=0),this.g.zoomer.setLeftOffset(r),this.sel=i}})},function(t,e,n){"use strict";var i=n(5),r=n(68),o=n(79),s=n(69),a=n(70),l=n(1);t.exports=i.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.stats,"reset",function(){return this.rerender()}),this.listenTo(this.model,"change:hidden",l.debounce(this.rerender,10)),this.listenTo(this.model,"sort",this.rerender),this.listenTo(this.model,"add",function(){return console.log("seq add")}),this.listenTo(this.g.vis,"change:sequences",this.rerender),this.listenTo(this.g.vis,"change:overviewbox",this.rerender),this.listenTo(this.g.visorder,"change",this.rerender)},draw:function(){if(this.removeViews(),this.g.vis.get("overviewbox")){var t=new s({model:this.model,g:this.g});t.ordering=this.g.visorder.get("overviewBox"),this.addView("overviewBox",t)}var e=new o({model:this.model,g:this.g});e.ordering=this.g.visorder.get("headerBox"),this.addView("headerBox",e);var n=new a({model:this.model,g:this.g});n.ordering=this.g.visorder.get("searchBox"),this.addView("searchbox",n);var i=new r({model:this.model,g:this.g});return i.ordering=this.g.visorder.get("alignmentBody"),this.addView("body",i)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_stage",this},rerender:function(){if(!this.g.config.get("manualRendering"))return this.draw(),this.render()}})},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(18);t.exports=function(){function t(e){i(this,t),this.g=e,this.cache={},this.cacheHeight=0,this.cacheWidth=0}return r(t,[{key:"getFontTile",value:function(t,e,n){return e===this.cacheWidth&&n===this.cacheHeight||(this.cacheHeight=n,this.cacheWidth=e,this.cache={}),void 0===this.cache[t]&&this.createTile(t,e,n),this.cache[t]}},{key:"createTile",value:function(t,e,n){var i=this.cache[t]=document.createElement("canvas");return i.width=e,i.height=n,this.ctx=i.getContext("2d"),this.ctx.font=this.g.zoomer.get("residueFont")+"px mono",this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.fillText(t,e/2,n/2,e)}}]),t}()},function(t,e,n){"use strict";var i,r=n(1),o=n(18),s={setMaxScrollHeight:function(){return this.maxScrollHeight=this.g.zoomer.getMaxAlignmentHeight()-this.g.zoomer.get("alignmentHeight")},setMaxScrollWidth:function(){return this.maxScrollWidth=this.g.zoomer.getMaxAlignmentWidth()-this.g.zoomer.getAlignmentWidth()}};t.exports=i=function(t,e){return this.g=t,this.model=e,this.maxScrollWidth=0,this.maxScrollHeight=0,this.setMaxScrollHeight(),this.setMaxScrollWidth(),this.listenTo(this.g.zoomer,"change:rowHeight",this.setMaxScrollHeight),this.listenTo(this.g.zoomer,"change:columnWidth",this.setMaxScrollWidth),this.listenTo(this.g.zoomer,"change:alignmentWidth",this.setMaxScrollWidth),this.listenTo(this.g.zoomer,"change:alignmentHeight",this.setMaxScrollHeight),this.listenTo(this.model,"add change reset",function(){return this.setMaxScrollHeight(),this.setMaxScrollWidth()},this),this},r.extend(i.prototype,s),o.mixin(i.prototype)},function(t,e,n){"use strict";var i,r=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(1);t.exports=i=function(t,e){return this.g=t,this.ctx=e,this},o.extend(i.prototype,{_getSelection:function(t){var e=t.get("seq").length,n=[],i=this.g.selcol.getSelForRow(t.get("id")),r=o.find(i,function(t){return"row"===t.get("type")});if("undefined"!=typeof r&&null!==r)for(var s=e-1,a=0;a<=s;a++)n.push(a);else if(i.length>0)for(var l,h=0;h<i.length;h++){l=i[h];for(var u=l.get("xStart"),s=l.get("xEnd"),a=u;a<=s;a++)n.push(a)}return n},_appendSelection:function(t){var e=this,n=t.model.get("seq"),i=this._getSelection(t.model),o=this._getPrevNextSelection(t.model),s=r(o,2),a=s[0],l=s[1];this.g.zoomer.get("columnWidth"),this.g.zoomer.get("rowHeight");if(0!==i.length){var h=0;return function(){for(var r=[],o=n.length-1,s=0;0<o?s<=o:s>=o;0<o?s++:s--)r.push(function(){if(t.hidden.indexOf(s)>=0)return h++;var n=s-h;return i.indexOf(s)>=0&&(0===n||i.indexOf(s-1)<0)?e._renderSelection({n:s,k:n,selection:i,mPrevSel:a,mNextSel:l,xZero:t.xZero,yZero:t.yZero,model:t.model}):void 0}());return r}()}},_renderSelection:function(t){for(var e=t.xZero,n=t.yZero,i=t.n,r=t.k,o=t.selection,s=t.mPrevSel,a=t.mNextSel,l=0,h=t.model.get("seq").length-1,u=i;(i<h?u<=h:u>=h)&&o.indexOf(u)>=0;i<h?u++:u--)l++;var c=this.g.zoomer.get("columnWidth"),f=this.g.zoomer.get("rowHeight"),d=c*l+1,g=this.g.columns.get("hidden");this.ctx.beginPath();var p=this.ctx.lineWidth;this.ctx.lineWidth=3;var m=this.ctx.strokeStyle;this.ctx.strokeStyle="#FF0000",e+=r*c;for(var v=0,b=l-1,u=0;0<b?u<=b:u>=b;0<b?u++:u--){var x=i+u;g.indexOf(x)>=0||("undefined"!=typeof s&&null!==s&&s.indexOf(x)>=0||(this.ctx.moveTo(e+v,n),this.ctx.lineTo(v+c+e,n)),"undefined"!=typeof a&&null!==a&&a.indexOf(x)>=0||(this.ctx.moveTo(v+e,f+n),this.ctx.lineTo(v+c+e,f+n)),v+=c)}return this.ctx.moveTo(e,n),this.ctx.lineTo(e,f+n),this.ctx.moveTo(e+d,n),this.ctx.lineTo(e+d,f+n),this.ctx.stroke(),this.ctx.strokeStyle=m,this.ctx.lineWidth=p},_getPrevNextSelection:function(t){var e=t.collection.prev(t),n=t.collection.next(t);if("undefined"!=typeof e&&null!==e)var i=this._getSelection(e);if("undefined"!=typeof n&&null!==n)var r=this._getSelection(n);return[i,r]}})},function(t,e,n){"use strict";var i=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=n(5),o=n(49),s=n(1),a=n(7),l=n(72),h=n(74),u=n(76),c=n(73);t.exports=r.extend({tagName:"canvas",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:_alignmentScrollLeft change:_alignmentScrollTop",function(t,e,n){if(null==("undefined"!=typeof n&&null!==n?n.origin:void 0)||"canvasseq"!==n.origin)return this.render()}),this.listenTo(this.g.columns,"change:hidden",this.render),this.listenTo(this.g.zoomer,"change:alignmentWidth change:alignmentHeight",this.render),this.listenTo(this.g.colorscheme,"change",this.render),this.listenTo(this.g.selcol,"reset add",this.render),this.listenTo(this.model,"reset add",this.render),this.el.style.display="inline-block",this.el.style.overflowX="hidden",this.el.style.overflowY="hidden",this.el.className="biojs_msa_seqblock",this.ctx=this.el.getContext("2d"),this.cache=new l(this.g),this.coordsCache=new c(this.g,this.model),this.listenTo(this.g.zoomer,"change:residueFont",function(){return this.cache=new l(this.g),this.render()}),this.sel=new h(this.g,this.ctx),this._setColor(),this.throttleTime=0,this.throttleCounts=0,null!=document.documentElement.style.webkitAppearance?this.throttledDraw=function(){var t=+new Date;if(this.draw(),this.throttleTime+=+new Date-t,this.throttleCounts++,this.throttleCounts>15){var e=Math.ceil(this.throttleTime/this.throttleCounts);return console.log("avgDrawTime/WebKit",e),this.throttledDraw=this.draw}}:this.throttledDraw=s.throttle(this.throttledDraw,30),this.manageEvents()},throttledDraw:function(){var t=+new Date;if(this.draw(),this.throttleTime+=+new Date-t,this.throttleCounts++,this.throttleCounts>15){var e=Math.ceil(this.throttleTime/this.throttleCounts);return console.log("avgDrawTime",e),e*=1.2,e=Math.max(20,e),this.throttledDraw=s.throttle(this.draw,e)}},manageEvents:function(){var t={};return t.mousedown="_onmousedown",t.touchstart="_ontouchstart",this.g.config.get("registerMouseClicks")&&(t.dblclick="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),t.mousewheel="_onmousewheel",t.DOMMouseScroll="_onmousewheel",this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents),this.dragStart=[]},_setColor:function(){return this.color=this.g.colorscheme.getSelectedScheme()},draw:function(){if(this.el.width=this.el.width,null!=this.seqDrawer&&this.model.length>0)return this.seqDrawer.drawLetters(),this.seqDrawer.drawRows(this.sel._appendSelection,this.sel),this.seqDrawer.drawRows(this.drawFeatures,this)},drawFeatures:function(t){var e=this.g.zoomer.get("columnWidth"),n=this.g.zoomer.get("rowHeight");if(t.model.attributes.height>1){var i=this.ctx;return t.model.attributes.features.each(function(r){i.fillStyle=r.attributes.fillColor||"red";var o=r.attributes.xEnd-r.attributes.xStart+1,s=(r.attributes.row+1)*n;return i.fillRect(r.attributes.xStart*e+t.xZero,s+t.yZero,e*o,n)}),i.fillStyle="black",i.font=this.g.zoomer.get("residueFont")+"px mono",i.textBaseline="middle",i.textAlign="center",t.model.attributes.features.each(function(r){var o=r.attributes.xEnd-r.attributes.xStart+1,s=(r.attributes.row+1)*n;return i.fillText(r.attributes.text,t.xZero+r.attributes.xStart*e+o/2*e,t.yZero+.5*n+s)})}},render:function(){return this.el.setAttribute("height",this.g.zoomer.get("alignmentHeight")+"px"),this.el.setAttribute("width",this.g.zoomer.getAlignmentWidth()+"px"),this.g.zoomer._checkScrolling(this._checkScrolling([this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")]),{header:"canvasseq"}),this._setColor(),this.seqDrawer=new u(this.g,this.ctx,this.model,{width:this.el.width,height:this.el.height,color:this.color,cache:this.cache}),this.throttledDraw(),this},_onmousemove:function(t,e){if(0!==this.dragStart.length){var n=o.abs(t),i=[n[0]-this.dragStart[0],n[1]-this.dragStart[1]],r=this.g.zoomer.get("canvasEventScale");e&&(r=3);for(var s=0;s<=1;s++)i[s]=i[s]*r;for(var a=[this.dragStartScroll[0]-i[0],this.dragStartScroll[1]-i[1]],s=0;s<=1;s++)a[s]=Math.round(a[s]);var l=this._checkScrolling(a);this.g.zoomer._checkScrolling(l,{origin:"canvasseq"});for(var s=0;s<=1;s++)l[s]!==a[s]&&(0===l[s]?(this.dragStart[s]=n[s],this.dragStartScroll[s]=0):this.dragStart[s]=n[s]-l[s]);return this.throttledDraw(),null!=t.preventDefault?(t.preventDefault(),t.stopPropagation()):void 0}},_ontouchmove:function(t){return this._onmousemove(t.changedTouches[0],!0),t.preventDefault(),t.stopPropagation()},_onmousedown:function(t){var e=this;return this.dragStart=o.abs(t),this.dragStartScroll=[this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")],a(document.body).on("mousemove.overmove",function(t){return e._onmousemove(t)}),a(document.body).on("mouseup.overup",function(){return e._cleanup()}),t.preventDefault()},_ontouchstart:function(t){var e=this;return this.dragStart=o.abs(t.changedTouches[0]),this.dragStartScroll=[this.g.zoomer.get("_alignmentScrollLeft"),this.g.zoomer.get("_alignmentScrollTop")],a(document.body).on("touchmove.overtmove",function(t){return e._ontouchmove(t)}),a(document.body).on("touchend.overtend touchleave.overtleave touchcancel.overtcanel",function(t){return e._touchCleanup(t)})},_onmousewinout:function(t){if(t.toElement===document.body.parentNode)return this._cleanup()},_cleanup:function(){return this.dragStart=[],a(document.body).off(".overmove"),a(document.body).off(".overup"),a(document.body).off(".overout")},_touchCleanup:function(t){return t.changedTouches.length>0&&this._onmousemove(t.changedTouches[0],!0),this.dragStart=[],a(document.body).off(".overtmove"),a(document.body).off(".overtend"),a(document.body).off(".overtleave"),a(document.body).off(".overtcancel")},_onmousewheel:function(t){var e=o.wheelDelta(t);return this.g.zoomer.set("_alignmentScrollLeft",this.g.zoomer.get("_alignmentScrollLeft")+e[0]),t.preventDefault()},_onclick:function(t){var e=this._getClickPos(t);return"undefined"!=typeof e&&null!==e&&(null!=e.feature?this.g.trigger("feature:click",e):this.g.trigger("residue:click",e)),this.throttledDraw()},_onmousein:function(t){var e=this._getClickPos(t);return"undefined"!=typeof e&&null!==e&&(null!=e.feature?this.g.trigger("feature:mousein",e):this.g.trigger("residue:mousein",e)),this.throttledDraw()},_onmouseout:function(t){var e=this._getClickPos(t);return"undefined"!=typeof e&&null!==e&&(null!=e.feature?this.g.trigger("feature:mouseout",e):this.g.trigger("residue:mouseout",e)),this.throttledDraw()},_getClickPos:function(t){var e=o.rel(t);e[0]+=this.g.zoomer.get("_alignmentScrollLeft");var n=Math.floor(e[0]/this.g.zoomer.get("columnWidth")),r=this.seqDrawer._getSeqForYClick(e[1]),s=i(r,2),a=s[0],l=s[1];n+=this.g.columns.calcHiddenColumns(n),a+=this.model.calcHiddenSeqs(a),n=Math.max(0,n),a=Math.max(0,a);var h=this.model.at(a).get("id");if(!(l>0))return{seqId:h,rowPos:n,evt:t};var u=this.model.at(a).get("features").getFeatureOnRow(l-1,n);if(0!==u.length){var c=u[0];return console.log(u[0].attributes),{seqId:h,feature:c,rowPos:n,evt:t}}},_checkScrolling:function(t){for(var e=[this.coordsCache.maxScrollWidth,this.coordsCache.maxScrollHeight],n=0;n<=1;n++)t[n]>e[n]&&(t[n]=e[n]),t[n]<0&&(t[n]=0);return t}})},function(t,e,n){"use strict";var i,r=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=n(1),s={drawLetters:function(){this.rectHeight;return this.ctx.globalAlpha=this.g.colorscheme.get("opacity"),this.drawSeqs(function(t){return this.drawSeq(t,this._drawRect)}),this.ctx.globalAlpha=1,this.drawSeqs(function(t){return this.drawSeq(t,this._drawLetter)})},drawSeqs:function(t,e){var n=this.g.columns.get("hidden");e=e||this;for(var i=this.getStartSeq(),o=r(i,2),s=o[0],a=o[1],l=s;l<this.model.length;l++){var h=this.model.at(l);if(!h.get("hidden")){t.call(e,{model:h,yPos:a,y:l,hidden:n});var u=(h.attributes.height||1)*this.rectHeight;if(a+=u,a>this.height)break}}},drawRows:function(t,e){return this.drawSeqs(function(n){return this.drawRow(n,t,e)})},drawRow:function(t,e,n){var i=this.g.zoomer.get("columnWidth"),r=Math.max(0,Math.abs(Math.ceil(-this.g.zoomer.get("_alignmentScrollLeft")/i))),o=-Math.abs(-this.g.zoomer.get("_alignmentScrollLeft")%i),s=o-r*i,a=t.yPos;return e.call(n,{model:t.model,xZero:s,yZero:a,hidden:t.hidden})},getStartSeq:function(){for(var t=Math.max(0,Math.floor(this.g.zoomer.get("_alignmentScrollTop")/this.rectHeight))+1,e=0,n=0;e<t&&n<this.model.length;)e+=this.model.at(n).attributes.height||1,n++;var i=Math.max(0,this.g.zoomer.get("_alignmentScrollTop")-e*this.rectHeight+(this.model.at(n-1).attributes.height||1)*this.rectHeight);return[n-1,-i]},_getSeqForYClick:function(t){for(var e=this.getStartSeq(),n=r(e,2),i=n[0],o=n[1],s=o%this.rectHeight,a=Math.max(0,Math.floor((t-s)/this.rectHeight))+1,l=0,h=i;l<a&&h<this.model.length;)l+=this.model.at(h).attributes.height||1,h++;var u=Math.max(0,Math.floor(t/this.rectHeight)-l+(this.model.at(h-1).get("height")||1));return[h-1,u]},drawSeq:function(t,e){for(var n=t.model.get("seq"),i=t.yPos,r=this.rectWidth,o=this.rectHeight,s=Math.max(0,Math.abs(Math.ceil(-this.g.zoomer.get("_alignmentScrollLeft")/r))),a=-Math.abs(-this.g.zoomer.get("_alignmentScrollLeft")%r),l={rectWidth:r,rectHeight:o,yPos:i,y:t.y},h=this.width,u=s;u<n.length;u++){var c=n[u];if(c=c.toUpperCase(),l.x=u,l.c=c,l.xPos=a,t.hidden.indexOf(u)<0&&(e(this,l),a+=r,a>h))break}},_drawRect:function(t,e){var n=t.color.getColor(e.c,{pos:e.x,y:e.y});if("undefined"!=typeof n&&null!==n)return t.ctx.fillStyle=n,t.ctx.fillRect(e.xPos,e.yPos,e.rectWidth,e.rectHeight)},_drawLetter:function(t,e){return t.ctx.drawImage(t.cache.getFontTile(e.c,e.rectWidth,e.rectHeight),e.xPos,e.yPos,e.rectWidth,e.rectHeight)}};t.exports=i=function(t,e,n,i){return this.g=t,this.ctx=e,this.model=n,this.width=i.width,this.height=i.height,this.color=i.color,this.cache=i.cache,this.rectHeight=this.g.zoomer.get("rowHeight"),this.rectWidth=this.g.zoomer.get("columnWidth"),this},o.extend(i.prototype,s)},function(t,e,n){"use strict";var i=n(3),r=n(6),o=n(10),s=i.extend({className:"biojs_msa_conserv",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.listenTo(this.g.columns,"change:scaling",this.render),this.listenTo(this.g.stats,"reset",this.render),this.manageEvents()},render:function(){var t=this.g.stats.scale(this.g.stats.conservation());r.removeAllChilds(this.el);var e=this.model.getMaxLength(),n=this.g.zoomer.get("columnWidth"),i=20,s=n*(e-this.g.columns.get("hidden").length),a=o.base({height:i,width:s});a.style.display="inline-block",a.style.cursor="pointer";for(var l=this.g.zoomer.get("stepSize"),h=this.g.columns.get("hidden"),u=0,c=0;c<e;)if(h.indexOf(c)>=0)c+=l;else{s=n*l;for(var f=0,d=l-1,g=0;0<d?g<=d:g>=d;0<d?g++:g--)f+=t[c];
var p=i*(f/l),m=o.rect({x:u,y:i-p,width:s-n/4,height:p,style:"stroke:red;stroke-width:1;"});m.rowPos=c,a.appendChild(m),u+=s,c+=l}return this.el.appendChild(a),this},_onclick:function(t){var e=this,n=t.target.rowPos,i=this.g.zoomer.get("stepSize");return function(){for(var r=[],o=i-1,s=0;0<o?s<=o:s>=o;0<o?s++:s--)r.push(e.g.trigger("bar:click",{rowPos:n+s,evt:t}));return r}()},manageEvents:function(){var t={};return this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onmousein:function(t){var e=this.g.zoomer.get("stepSize"*t.rowPos);return this.g.trigger("bar:mousein",{rowPos:e,evt:t})},_onmouseout:function(t){var e=this.g.zoomer.get("stepSize"*t.rowPos);return this.g.trigger("bar:mouseout",{rowPos:e,evt:t})}});t.exports=s},function(t,e,n){"use strict";var i=n(3),r=n(6),o=n(10),s=i.extend({className:"biojs_msa_gapview",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.listenTo(this.g.columns,"change:scaling",this.render),this.listenTo(this.model,"reset",this.render),this.manageEvents()},render:function(){var t=this.g.stats.gaps();r.removeAllChilds(this.el);var e=this.model.getMaxLength(),n=this.g.zoomer.get("columnWidth"),i=20,s=n*(e-this.g.columns.get("hidden").length),a=o.base({height:i,width:s});a.style.display="inline-block",a.style.cursor="pointer";for(var l=this.g.zoomer.get("stepSize"),h=this.g.columns.get("hidden"),u=0,c=0;c<e;)if(h.indexOf(c)>=0)c+=l;else{s=n*l;for(var f=0,d=l-1,g=0;0<d?g<=d:g>=d;0<d?g++:g--)f+=t[c];var p=i*(f/l),m=o.rect({x:u,y:i-p,width:s-n/4,height:p,style:"stroke:red;stroke-width:1;"});m.rowPos=c,a.appendChild(m),u+=s,c+=l}return this.el.appendChild(a),this},_onclick:function(t){var e=this,n=t.target.rowPos,i=this.g.zoomer.get("stepSize");return function(){for(var r=[],o=i-1,s=0;0<o?s<=o:s>=o;0<o?s++:s--)r.push(e.g.trigger("gap:click",{rowPos:n+s,evt:t}));return r}()},manageEvents:function(){var t={};return this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onmousein:function(t){var e=this.g.zoomer.get("stepSize"*t.rowPos);return this.g.trigger("gap:mousein",{rowPos:e,evt:t})},_onmouseout:function(t){var e=this.g.zoomer.get("stepSize"*t.rowPos);return this.g.trigger("gap:mouseout",{rowPos:e,evt:t})}});t.exports=s},function(t,e,n){"use strict";var i=n(5),r=n(80),o=n(82);t.exports=i.extend({initialize:function(t){var e=this;return this.g=t.g,this.draw(),this.listenTo(this.g.vis,"change:labels change:metacell change:leftHeader",function(){return e.draw(),e.render()})},draw:function(){if(this.removeViews(),this.g.vis.get("leftHeader")&&(this.g.vis.get("labels")||this.g.vis.get("metacell"))){var t=new r({model:this.model,g:this.g});t.ordering=-50,this.addView("lHeader",t)}var e=new o({model:this.model,g:this.g});return e.ordering=0,this.addView("rHeader",e)},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_header"}})},function(t,e,n){"use strict";var i,r=n(20),o=n(3),s=n(6);t.exports=i=o.extend({className:"biojs_msa_headers",initialize:function(t){return this.g=t.g,this.listenTo(this.g.vis,"change:metacell change:labels",this.render),this.listenTo(this.g.zoomer,"change:labelWidth change:metaWidth",this.render)},render:function(){s.removeAllChilds(this.el);var t=0;return t+=this.g.zoomer.getLeftBlockWidth(),this.el.style.width=t+"px",this.g.vis.get("labels")&&this.el.appendChild(this.labelDOM()),this.g.vis.get("metacell")&&this.el.appendChild(this.metaDOM()),this.el.style.display="inline-block",this.el.style.fontSize=this.g.zoomer.get("markerFontsize"),this},labelDOM:function(){var t=r.mk("div");if(t.style.width=this.g.zoomer.getLabelWidth(),t.style.display="inline-block",this.g.vis.get("labelCheckbox")&&t.appendChild(this.addEl(".",10)),this.g.vis.get("labelId")&&t.appendChild(this.addEl("ID",this.g.zoomer.get("labelIdLength"))),this.g.vis.get("labelPartition")&&t.appendChild(this.addEl("part",15)),this.g.vis.get("labelName")){var e=this.addEl("Label");t.appendChild(e)}return t},addEl:function(t,e){var n=document.createElement("span");return n.textContent=t,"undefined"!=typeof e&&null!==e&&(n.style.width=e+"px"),n.style.display="inline-block",n},metaDOM:function(){var t=r.mk("div");return t.style.width=this.g.zoomer.getMetaWidth(),t.style.display="inline-block",this.g.vis.get("metaGaps")&&t.appendChild(this.addEl("Gaps",this.g.zoomer.get("metaGapWidth"))),this.g.vis.get("metaIdentity")&&t.appendChild(this.addEl("Ident",this.g.zoomer.get("metaIdentWidth"))),t}})},function(t,e,n){"use strict";var i=n(3),r=n(6),o=n(10),s=n(7),a=i.extend({className:"biojs_msa_marker",initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:stepSize change:labelWidth change:columnWidth change:markerStepSize change:markerFontsize",this.render),this.listenTo(this.g.vis,"change:labels change:metacell",this.render),this.manageEvents()},render:function(){r.removeAllChilds(this.el),this.el.style.fontSize=this.g.zoomer.get("markerFontsize");for(var t=document.createElement("span"),e=0,n=this.g.zoomer.get("columnWidth"),i=this.model.getMaxLength(),o=this.g.zoomer.get("stepSize"),s=this.g.columns.get("hidden");e<i;)if(s.indexOf(e)>=0)this.markerHidden(a,e,o),e+=o;else{var a=document.createElement("span");a.style.width=n*o+"px",a.style.display="inline-block",(e+1)%this.g.zoomer.get("markerStepSize")===0?a.textContent=e+1:a.textContent=".",a.rowPos=e,e+=o,t.appendChild(a)}return this.el.appendChild(t),this},markerHidden:function(t,e,n){for(var i=this,r=this.g.columns.get("hidden").slice(0),a=Math.max(0,e-n),l=!0,h=a;a<e?h<=e:h>=e;a<e?h++:h--)l&=r.indexOf(h)>=0;if(!l){for(var u=this.model.getMaxLength(),c=0,f=-1,e=e;(e<u?e<=u:e>=u)&&(f>=0||(f=r.indexOf(e)),r.indexOf(e)>=0);e<u?e++:e--)c++;var d=o.base({height:10,width:10});d.style.position="relative";var g=o.polygon({points:"0,0 5,5 10,0",style:"fill:lime;stroke:purple;stroke-width:1"});return s(g).on("click",function(t){return r.splice(f,c),i.g.columns.set("hidden",r)}),d.appendChild(g),t.appendChild(d),d}},manageEvents:function(){var t={};return this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents)},_onclick:function(t){var e=t.target.rowPos,n=this.g.zoomer.get("stepSize");return this.g.trigger("column:click",{rowPos:e,stepSize:n,evt:t})},_onmousein:function(t){var e=this.g.zoomer.get("stepSize"*t.rowPos),n=this.g.zoomer.get("stepSize");return this.g.trigger("column:mousein",{rowPos:e,stepSize:n,evt:t})},_onmouseout:function(t){var e=this.g.zoomer.get("stepSize"*t.rowPos),n=this.g.zoomer.get("stepSize");return this.g.trigger("column:mouseout",{rowPos:e,stepSize:n,evt:t})}});t.exports=a},function(t,e,n){"use strict";var i=n(81),r=n(77),o=n(5),s=(n(1),n(83)),a=n(78);t.exports=o.extend({initialize:function(t){return this.g=t.g,this.blockEvents=!1,this.listenTo(this.g.vis,"change:header",function(){return this.draw(),this.render()}),this.listenTo(this.g.vis,"change",this._setSpacer),this.listenTo(this.g.zoomer,"change:alignmentWidth",this._setWidth),this.listenTo(this.g.zoomer,"change:_alignmentScrollLeft",this._adjustScrollingLeft),this.listenTo(this.g.columns,"change:hidden",function(){return this.draw(),this.render()}),this.draw(),this.g.vis.once("change:loaded",this._adjustScrollingLeft,this)},events:{scroll:"_sendScrollEvent"},draw:function(){if(this.removeViews(),this.g.vis.get("conserv")){var t=new r({model:this.model,g:this.g});t.ordering=-20,this.addView("conserv",t)}if(this.g.vis.get("markers")){var e=new i({model:this.model,g:this.g});e.ordering=-10,this.addView("marker",e)}if(this.g.vis.get("seqlogo")){var n=new s({model:this.model,g:this.g});n.ordering=-30,this.addView("seqlogo",n)}if(this.g.vis.get("gapHeader")){var o=new a({model:this.model,g:this.g});return o.ordering=-25,this.addView("gapview",o)}},render:function(){return this.renderSubviews(),this._setSpacer(),this.el.className="biojs_msa_rheader",this.el.style.overflowX="auto",this.el.style.display="inline-block",this._setWidth(),this._adjustScrollingLeft(),this},_sendScrollEvent:function(){return this.blockEvents||this.g.zoomer.set("_alignmentScrollLeft",this.el.scrollLeft,{origin:"header"}),this.blockEvents=!1},_adjustScrollingLeft:function(t,e,n){if(null==("undefined"!=typeof n&&null!==n?n.origin:void 0)||"header"!==n.origin){var i=this.g.zoomer.get("_alignmentScrollLeft");return this.blockEvents=!0,this.el.scrollLeft=i}},_setSpacer:function(){return this.el.style.marginLeft=this._getLabelWidth()+"px"},_getLabelWidth:function(){var t=0;return this.g.vis.get("leftHeader")||(t+=this.g.zoomer.getLeftBlockWidth()),t},_setWidth:function(){return this.el.style.width=this.g.zoomer.getAlignmentWidth()+"px"}})},function(t,e,n){"use strict";var i=n(97),r=n(3),o=n(6);t.exports=r.extend({initialize:function(t){return this.g=t.g,this.listenTo(this.g.zoomer,"change:alignmentWidth",this.render),this.listenTo(this.g.colorscheme,"change",function(){var t=this.g.colorscheme.getSelectedScheme();return this.seqlogo.changeColors(t),this.render()}),this.listenTo(this.g.zoomer,"change:columnWidth",function(){return this.seqlogo.column_width=this.g.zoomer.get("columnWidth"),this.render()}),this.listenTo(this.g.stats,"reset",function(){return this.draw(),this.render()}),this.draw()},draw:function(){o.removeAllChilds(this.el),console.log("redraw seqlogo");var t=this.g.stats.conservResidue({scaled:!0});t=_.map(t,function(t){return _.pick(t,function(t,e){return"-"!==e})});var e={alphabet:"aa",heightArr:t},n=this.g.colorscheme.getSelectedScheme();return this.seqlogo=new i({model:this.model,g:this.g,data:e,yaxis:!1,scroller:!1,xaxis:!1,height:100,column_width:this.g.zoomer.get("columnWidth"),positionMarker:!1,zoom:1,el:this.el,colors:n})},render:function(){return this.seqlogo.render()}})},function(t,e,n){"use strict";var i=n(85),r=n(5);t.exports=r.extend({initialize:function(t){var e=this;return this.g=t.g,this.draw(),this.listenTo(this.g.zoomer,"change:_alignmentScrollTop",this._adjustScrollingTop),this.g.vis.once("change:loaded",this._adjustScrollingTop,this),this.listenTo(this.g.zoomer,"change:alignmentHeight",this._setHeight),this.listenTo(this.model,"change:reference",this.draw),this.listenTo(this.model,"reset add remove",function(){return e.draw(),e.render()})},draw:function(){this.removeViews(),console.log("redraw columns",this.model.length);for(var t=0;t<this.model.length;t++)if(!this.model.at(t).get("hidden")){var e=new i({model:this.model.at(t),g:this.g});e.ordering=t,this.addView("row_"+t,e)}},events:{scroll:"_sendScrollEvent"},_sendScrollEvent:function(){return this.g.zoomer.set("_alignmentScrollTop",this.el.scrollTop,{origin:"label"})},_adjustScrollingTop:function(){return this.el.scrollTop=this.g.zoomer.get("_alignmentScrollTop")},render:function(){return this.renderSubviews(),this.el.className="biojs_msa_labelblock",this.el.style.display="inline-block",this.el.style.verticalAlign="top",this.el.style.overflowY="auto",this.el.style.overflowX="hidden",this.el.style.fontSize=this.g.zoomer.get("labelFontsize")+"px",this.el.style.lineHeight=""+this.g.zoomer.get("labelLineHeight"),this._setHeight(),this},_setHeight:function(){return this.el.style.height=this.g.zoomer.get("alignmentHeight")+"px"}})},function(t,e,n){"use strict";var i=n(5),r=n(86),o=n(87);t.exports=i.extend({initialize:function(t){return this.g=t.g,this.draw(),this.listenTo(this.g.vis,"change:labels",this.drawR),this.listenTo(this.g.vis,"change:metacell",this.drawR),this.listenTo(this.g.zoomer,"change:rowHeight",function(){return this.el.style.height=this.g.zoomer.get("rowHeight")+"px"}),this.listenTo(this.g.selcol,"change reset add",this.setSelection)},draw:function(){if(this.removeViews(),this.g.vis.get("labels")&&this.addView("labels",new r({model:this.model,g:this.g})),this.g.vis.get("metacell")){var t=new o({model:this.model,g:this.g});return this.addView("metacell",t)}},drawR:function(){return this.draw(),this.render()},render:function(){return this.renderSubviews(),this.el.setAttribute("class","biojs_msa_labelrow"),this.el.style.height=this.g.zoomer.get("rowHeight")*(this.model.attributes.height||1)+"px",this.setSelection(),this},setSelection:function(){var t=this.g.selcol.getSelForRow(this.model.id);return t.length>0?this.el.style.fontWeight="bold":this.el.style.fontWeight="normal"}})},function(t,e,n){"use strict";var i=n(3),r=n(6),o=i.extend({initialize:function(t){return this.seq=t.seq,this.g=t.g,this.manageEvents()},manageEvents:function(){var t={};return this.g.config.get("registerMouseClicks")&&(t.click="_onclick"),this.g.config.get("registerMouseHover")&&(t.mousein="_onmousein",t.mouseout="_onmouseout"),this.delegateEvents(t),this.listenTo(this.g.config,"change:registerMouseHover",this.manageEvents),this.listenTo(this.g.config,"change:registerMouseClick",this.manageEvents),this.listenTo(this.g.vis,"change:labelName change:labelId change:labelPartition change:labelCheckbox",this.render),this.listenTo(this.g.zoomer,"change:labelIdLength change:labelNameLength change:labelPartLength change:labelCheckLength",this.render),this.listenTo(this.g.zoomer,"change:labelFontSize change:labelLineHeight change:labelWidth change:rowHeight",this.render)},render:function(){if(r.removeAllChilds(this.el),this.el.style.width=this.g.zoomer.getLabelWidth()+"px",this.el.setAttribute("class","biojs_msa_labels"),this.g.vis.get("labelCheckbox")){var t=document.createElement("input");t.setAttribute("type","checkbox"),t.value=this.model.get("id"),t.name="seq",t.style.width=this.g.zoomer.get("labelCheckLength")+"px",this.el.appendChild(t)}if(this.g.vis.get("labelId")){var e=document.createElement("span"),n=this.model.get("id");isNaN(n)||n++,e.textContent=n,e.style.width=this.g.zoomer.get("labelIdLength")+"px",e.style.display="inline-block",this.el.appendChild(e)}if(this.g.vis.get("labelPartition")){var i=document.createElement("span");i.style.width=this.g.zoomer.get("labelPartLength")+"px",i.textContent=this.model.get("partition"),i.style.display="inline-block",this.el.appendChild(e),this.el.appendChild(i)}if(this.g.vis.get("labelName")){var o=document.createElement("span");o.textContent=this.model.get("name"),this.model.get("ref")&&this.g.config.get("hasRef")&&(o.style.fontWeight="bold"),o.style.width=this.g.zoomer.get("labelNameLength")+"px",this.el.appendChild(o)}return this.el.style.overflow=scroll,this.el.style.fontSize=this.g.zoomer.get("labelFontsize")+"px",this},_onclick:function(t){var e=this.model.get("id");return this.g.trigger("row:click",{seqId:e,evt:t})},_onmousein:function(t){var e=this.model.get("id");return this.g.trigger("row:mouseout",{seqId:e,evt:t})},_onmouseout:function(t){var e=this.model.get("id");return this.g.trigger("row:mouseout",{seqId:e,evt:t})}});t.exports=o},function(t,e,n){"use strict";var i,r=n(3),o=n(4),s=n(1),a=n(6),l=n(39);t.exports=i=r.extend({className:"biojs_msa_metaview",initialize:function(t){return this.g=t.g,this.listenTo(this.g.vis,"change:metacell",this.render),this.listenTo(this.g.zoomer,"change:metaWidth",this.render)},events:{click:"_onclick",mousein:"_onmousein",mouseout:"_onmouseout"},render:function(){a.removeAllChilds(this.el),this.el.style.display="inline-block";var t=this.g.zoomer.getMetaWidth();if(this.el.style.width=t-10,this.el.style.paddingRight=5,this.el.style.paddingLeft=5,this.el.style.fontSize=this.g.zoomer.get("labelFontsize")-2+"px",this.g.vis.get("metaGaps")){var e=this.model.get("seq"),n=s.reduce(e,function(t,e){return"-"===e?++t:void 0},0);n=(100*n/e.length).toFixed(0)+"%";var i=document.createElement("span");i.textContent=n,i.style.display="inline-block",i.style.width=35,this.el.appendChild(i)}if(this.g.vis.get("metaIdentity")){var r=this.g.stats.identity()[this.model.id],h=document.createElement("span");this.model.get("ref")&&this.g.config.get("hasRef")?h.textContent="ref.":"undefined"!=typeof r&&null!==r&&(h.textContent=r.toFixed(2)),h.style.display="inline-block",h.style.width=40,this.el.appendChild(h)}if(this.g.vis.get("metaLinks")&&this.model.attributes.ids){var u=l.buildLinks(this.model.attributes.ids);if(s.keys(u).length>0){var c=new o({name:""});console.log(s.keys(u)),s.each(u,function(t,e){return c.addNode(e,function(e){return window.open(t)})});var f=c.buildDOM();return f.style.cursor="pointer",this.el.appendChild(f)}}},_onclick:function(t){return this.g.trigger("meta:click",{seqId:this.model.get("id",{evt:t})})},_onmousein:function(t){return this.g.trigger("meta:mousein",{seqId:this.model.get("id",{evt:t})})},_onmouseout:function(t){return this.g.trigger("meta:mouseout",{seqId:this.model.get("id",{evt:t})})}})},function(t,e,n){!function(){function n(){return{keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object");var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n},uniqueId:function(t){var e=++a+"";return t?t+e:e},has:function(t,e){return o.call(t,e)},each:function(t,e,n){if(null!=t)if(r&&t.forEach===r)t.forEach(e,n);else if(t.length===+t.length)for(var i=0,o=t.length;i<o;i++)e.call(n,t[i],i,t);else for(var s in t)this.has(t,s)&&e.call(n,t[s],s,t)},once:function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}}}var i,r=Array.prototype.forEach,o=Object.prototype.hasOwnProperty,s=Array.prototype.slice,a=0,l=n();i={on:function(t,e,n){if(!u(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var i=this,r=l.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,o,s,a,h,c,f;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(s=t?[t]:l.keys(this._events),a=0,h=s.length;a<h;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=i=[],e||n)for(c=0,f=o.length;c<f;c++)r=o[c],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!u(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&c(n,e),i&&c(i,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var o in i)i[o].off(e,n,this),r&&delete this._listeners[o];return this}};var h=/\s+/,u=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(h.test(n)){for(var o=n.split(h),s=0,a=o.length;s<a;s++)t[e].apply(t,[o[s]].concat(i));return!1}return!0},c=function(t,e){var n,i=-1,r=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},f={listenTo:"on",listenToOnce:"once"};l.each(f,function(t,e){i[e]=function(e,n,i){var r=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=l.uniqueId("l"));return r[o]=e,"object"==typeof n&&(i=this),e[t](n,i,this),this}}),i.bind=i.on,i.unbind=i.off,i.mixin=function(t){var e=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return l.each(e,function(e){t[e]=this[e]},this),t},"undefined"!=typeof t&&t.exports&&(e=t.exports=i),e.BackboneEvents=i}(this)},function(t,e,n){var i=n(11),r=n(17),o=n(1),s=n(43),a=[],l=a.slice,h=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,o.extend({silent:!0},e))},u={add:!0,remove:!0,merge:!0},c={add:!0,remove:!1};o.extend(h.prototype,i,{model:s,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.extend({merge:!1},e,c))},remove:function(t,e){var n=!o.isArray(t);t=n?[t]:o.clone(t),e||(e={});for(var i=0,r=t.length;i<r;i++){var s=t[i]=this.get(t[i]);if(s){var a=this.modelId(s.attributes);null!=a&&delete this._byId[a],delete this._byId[s.cid];var l=this.indexOf(s);this.models.splice(l,1),this.length--,e.silent||(e.index=l,s.trigger("remove",s,this,e)),this._removeReference(s,e)}}return n?t[0]:t},set:function(t,e){e=o.defaults({},e,u),e.parse&&(t=this.parse(t,e));var n=!o.isArray(t);t=n?t?[t]:[]:t.slice();for(var i,r,s,a,l,h=e.at,c=this.comparator&&null==h&&e.sort!==!1,f=o.isString(this.comparator)?this.comparator:null,d=[],g=[],p={},m=e.add,v=e.merge,b=e.remove,x=!(c||!m||!b)&&[],y=0,w=t.length;y<w;y++){if(s=t[y],a=this.get(s))b&&(p[a.cid]=!0),v&&s!==a&&(s=this._isModel(s)?s.attributes:s,e.parse&&(s=a.parse(s,e)),a.set(s,e),c&&!l&&a.hasChanged(f)&&(l=!0)),t[y]=a;else if(m){if(r=t[y]=this._prepareModel(s,e),!r)continue;d.push(r),this._addReference(r,e)}r=a||r,r&&(i=this.modelId(r.attributes),!x||!r.isNew()&&p[i]||x.push(r),p[i]=!0)}if(b){for(var y=0,w=this.length;y<w;y++)p[(r=this.models[y]).cid]||g.push(r);g.length&&this.remove(g,e)}if(d.length||x&&x.length)if(c&&(l=!0),this.length+=d.length,null!=h)for(var y=0,w=d.length;y<w;y++)this.models.splice(h+y,0,d[y]);else{x&&(this.models.length=0);for(var _=x||d,y=0,w=_.length;y<w;y++)this.models.push(_[y])}if(l&&this.sort({silent:!0}),!e.silent){for(var S=null!=h?o.clone(e):e,y=0,w=d.length;y<w;y++)null!=h&&(S.index=h+y),(r=d[y]).trigger("add",r,this,S);(l||x&&x.length)&&this.trigger("sort",this,e)}return n?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,o.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,o.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return l.apply(this.models,arguments)},get:function(t){if(null!=t){var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]}},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return o.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),o.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(o.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},wrapError(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?o.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(t,r){e.wait&&n.add(t,e),i&&i(t,r,e)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?o.clone(e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_isModel:function(t){return t instanceof s},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if("add"!==t&&"remove"!==t||n===this){if("destroy"===t&&this.remove(e,i),"change"===t){var r=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);r!==o&&(null!=r&&delete this._byId[r],null!=o&&(this._byId[o]=e))}this.trigger.apply(this,arguments)}}});var f=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];o.each(f,function(t){o[t]&&(h.prototype[t]=function(){var e=l.call(arguments);return e.unshift(this.models),o[t].apply(o,e)})});var d=["groupBy","countBy","sortBy","indexBy"];o.each(d,function(t){o[t]&&(h.prototype[t]=function(e,n){var i=o.isFunction(e)?e:function(t){return t.get(e)};return o[t](this.models,i,n)})}),h.extend=r,t.exports=h},function(t,e){t.exports=function(t){var e,n,i,r,o,s,a;for(t=t||{},e=i=0,s=arguments.length;0<=s?i<s:i>s;e=0<=s?++i:--i)if(arguments[e])for(a=arguments[e],r=0,o=a.length;r<o;r++)n=a[r],arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t}},function(t,e,n){var i,r,o;o=n(39),r=n(90),t.exports=i={getMeta:o.getMeta,extend:function(t){var e;return e=r(i),i.getMeta=t,e},parse:function(t){var e,n,r,s,a,l,h,u,c;if(h=[],!t||0===t.length)return[];for("[object Array]"!==Object.prototype.toString.call(t)&&(t=t.split("\n")),n=i.getMeta,u=0,c=t.length;u<c;u++)a=t[u],">"===a[0]||";"===a[0]?(s=a.slice(1),l=n(s),s=l.name,r=l.id||h.length,e=new o.model("",l.name,r),e.ids=l.ids||{},e.details=l.details||{},h.push(e)):e.seq+=a;return h},write:function(t,e){var n,i,r,s;for(i="",r=0,s=t.length;r<s;r++)n=t[r],null!=e&&(n=e(n)),i+=">"+n.name+"\n",i+=o.splitNChars(n.seq,80).join("\n"),i+="\n";return i}}},function(t,e,n){var i={};t.exports=i;var r=n(45);i.readHeader=function(t){for(var e,n={},r=0,o=[];r<t.length;r++){var s=t[r];if(s.indexOf("#")>=0)break;var a=s.split(/\t/),l=a[0].trim();if("GFF"===l)break;if(2===a.length)if("startgroup"===l)e=a[1].trim();else{if("endgroup"===l){e="";continue}n[a[0]]=i.parseColor(a[1])}else if(a.length>=5){var h=i.parseLine(a);e&&(h.attributes.Parent=e),o.push(h)}}return{offset:r,colors:n,features:o}},i.parseColor=function(t){return t.indexOf(",")>=0?r.rgbToHex(t.split(",").map(function(t){return parseInt(t)})):6===t.length&&parseInt(t.charAt(0),16)<=16&&"bisque"!==t?"#"+t:t},i.parseLine=function(t){var e={attributes:{}};return e.attributes.Name=t[0].trim(),e.seqname=t[1].trim(),e.start=parseInt(t[3]),e.end=parseInt(t[4]),e.feature=t[5].trim(),"ID_NOT_SPECIFIED"===e.seqname&&(e.seqname=t[2].trim()),e}},function(t,e){(function(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(e,function(){return this}())},function(t,e,n){"use strict";function i(t,e){for(var n=0;n<t.length;n++)e(t[n])}function r(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function o(t,e,n){var i=t;return c(e)?(n=e,"string"==typeof t&&(i={uri:t})):i=d(e,{uri:t}),i.callback=n,i}function s(t,e,n){return e=o(t,e,n),a(e)}function a(t){function e(){4===u.readyState&&setTimeout(o,0)}function n(){var t=void 0;if(t=u.response?u.response:u.responseText||l(u),y)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(g),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,h(t,w)}function o(){if(!d){var e;clearTimeout(g),e=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var i=w,r=null;return 0!==e?(i={body:n(),statusCode:e,method:m,headers:{},url:p,rawRequest:u},u.getAllResponseHeaders&&(i.headers=f(u.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),h(r,i,i.body)}}if("undefined"==typeof t.callback)throw new Error("callback argument missing");var a=!1,h=function(e,n,i){a||(a=!0,t.callback(e,n,i))},u=t.xhr||null;u||(u=t.cors||t.useXDR?new s.XDomainRequest:new s.XMLHttpRequest);var c,d,g,p=u.url=t.uri||t.url,m=u.method=t.method||"GET",v=t.body||t.data,b=u.headers=t.headers||{},x=!!t.sync,y=!1,w={body:void 0,headers:{},statusCode:0,method:m,url:p,rawRequest:u};if("json"in t&&t.json!==!1&&(y=!0,b.accept||b.Accept||(b.Accept="application/json"),"GET"!==m&&"HEAD"!==m&&(b["content-type"]||b["Content-Type"]||(b["Content-Type"]="application/json"),v=JSON.stringify(t.json===!0?v:t.json))),u.onreadystatechange=e,u.onload=o,u.onerror=i,u.onprogress=function(){},u.onabort=function(){d=!0},u.ontimeout=i,u.open(m,p,!x,t.username,t.password),x||(u.withCredentials=!!t.withCredentials),!x&&t.timeout>0&&(g=setTimeout(function(){if(!d){d=!0,u.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}},t.timeout)),u.setRequestHeader)for(c in b)b.hasOwnProperty(c)&&u.setRequestHeader(c,b[c]);else if(t.headers&&!r(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(v||null),u}function l(t){try{if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!e)return t.responseXML}catch(t){}return null}function h(){}var u=n(93),c=n(114),f=n(50),d=n(140);t.exports=s,t.exports.default=s,s.XMLHttpRequest=u.XMLHttpRequest||h,s.XDomainRequest="withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:u.XDomainRequest,i(["get","put","post","patch","head","delete"],function(t){s["delete"===t?"del":t]=function(e,n,i){return n=o(e,n,i),n.method=t.toUpperCase(),a(n)}})},function(t,e,n){t.exports.seq=n(96)},function(t,e){t.exports=function(t,e,n){this.seq=t,this.name=e,this.id=n,this.meta={}}},function(t,e,n){t.exports=n(103)},function(t,e){t.exports={render_x_axis_label:function(){var t="Model Position";this.display_ali_map&&(t="Alignment Column"),this.called_on.find(".logo_xaxis").remove(),this.called_on.prepend('<div class="logo_xaxis" class="centered" style="margin-left:40px"><p class="xaxis_text" style="width:10em;margin:1em auto">'+t+"</p></div>")},render_y_axis_label:function(){this.dom_element.parent().before('<canvas class="logo_yaxis" height="'+this.options.height+'" width="55"></canvas>');var t=this.called_on.find(".logo_yaxis"),e=(Math.abs(this.data.max_height),isNaN(this.data.min_height_obs)?0:parseInt(this.data.min_height_obs,10),null),n="Information Content (bits)";e=t[0].getContext("2d"),e.beginPath(),e.moveTo(55,1),e.lineTo(40,1),e.moveTo(55,this.info_content_height),e.lineTo(40,this.info_content_height),e.moveTo(55,this.info_content_height/2),e.lineTo(40,this.info_content_height/2),e.lineWidth=1,e.strokeStyle="#666666",e.stroke(),e.fillStyle="#666666",e.textAlign="right",e.font="bold 10px Arial",
e.textBaseline="top",e.fillText(parseFloat(this.data.max_height).toFixed(1),38,0),e.textBaseline="middle",e.fillText(parseFloat(this.data.max_height/2).toFixed(1),38,this.info_content_height/2),e.fillText("0",38,this.info_content_height),"score"===this.data.height_calc&&(n="Score (bits)"),e.save(),e.translate(5,this.height/2-20),e.rotate(-Math.PI/2),e.textAlign="center",e.font="normal 12px Arial",e.fillText(n,1,0),e.restore(),e.fillText("occupancy",55,this.info_content_height+7),this.show_inserts&&(e.fillText("ins. prob.",50,280),e.fillText("ins. len.",46,296))}}},function(t,e){var n=null;t.exports=function(){if(!n){var t=document.createElement("canvas");n=!(!t.getContext||!t.getContext("2d"))}return n}},function(t,e){t.exports={A:"#FF9966",C:"#009999",D:"#FF0000",E:"#CC0033",F:"#00FF00",G:"#f2f20c",H:"#660033",I:"#CC9933",K:"#663300",L:"#FF9933",M:"#CC99CC",N:"#336666",P:"#0099FF",Q:"#6666CC",R:"#990000",S:"#0000FF",T:"#00FFFF",V:"#FFCC33",W:"#66CC66",Y:"#006600"}},function(t,e){t.exports={A:"#cbf751",C:"#5ec0cc",G:"#ffdf59",T:"#b51f16",U:"#b51f16"}},function(t,e,n){var i=n(7);t.exports=function(t,e,n){t.find(".logo_settings_switch, .logo_settings .close").on("click",function(t){t.preventDefault(),i(".logo_settings").toggle()}),t.find(".logo_reset").on("click",function(t){t.preventDefault(),e.changeZoom({target:e.default_zoom})}),t.find(".logo_change").on("click",function(t){t.preventDefault()}),t.find(".logo_zoomin").on("click",function(t){t.preventDefault(),e.changeZoom({distance:.1,direction:"+"})}),t.find(".logo_zoomout").on("click",function(t){t.preventDefault(),e.changeZoom({distance:.1,direction:"-"})}),t.find(".logo_scale").on("change",function(t){e.toggleScale(this.value)}),t.find(".logo_color").on("change",function(t){e.toggleColorscheme(this.value)}),t.find(".logo_ali_map").on("change",function(t){e.toggleAliMap(this.value)}),t.find(".logo_position").on("change",function(){this.value.match(/^\d+$/m)&&e.scrollToColumn(this.value,1)}),n.on("dblclick",function(n){console.log("dblclick",e),offset=e.logo_graphic.offset(),x=parseInt(n.pageX-offset.left,10),window_position=n.pageX-t.parent().offset().left,col=e.columnFromCoordinates(x),console.log("col",col),current=e.zoom,current<1?e.changeZoom({target:1,offset:window_position,column:col}):e.changeZoom({target:.3,offset:window_position,column:col})}),i(document).on(t.attr("id")+".scrolledTo",function(t,n,i,r){e.render({target:n})}),i(document).on("keydown",function(t){t.ctrlKey||(61!==t.which&&107!==t.which||(zoom+=.1,e.changeZoom({distance:.1,direction:"+"})),109!==t.which&&0!==t.which||(zoom-=.1,e.changeZoom({distance:.1,direction:"-"})))})}},function(t,e,n){_=n(1);var i=n(99),r=n(106),o=n(105),s=n(3),a=n(98),l=n(102),h=n(104),u=n(7);t.exports=s.extend({options:{xaxis:!0,yaxis:!0,height:300,column_width:34,debug:!0,scale_height_enabled:!0,scaled_max:!0,zoom_buttons:!0,colorscheme:"default",data:void 0,start:1,end:void 0,zoom:.4,colors:void 0,divider:!1,show_probs:!1,divider_step:5,show_divider:!1,border:!1,settings:!1,scroller:!0,positionMarker:!0},loadDefault:function(t){this.data=t.data,this.display_ali_map=0,this.alphabet=t.data.alphabet||"dna",this.start=t.start,this.zoom=parseFloat(t.zoom)||.4,this.default_zoom=this.zoom,this.column_width=t.column_width,this.height=t.height,this.canvas_width=5e3,this.scale_height_enabled=t.scale_height_enabled,this.scrollme=null,this.previous_target=0,this.rendered=[],this.previous_zoom=0,void 0==this.data.max_height&&(this.data.max_height=this.calcMaxHeight(this.data.heightArr)),this.data.insert_probs&&this.data.delete_probs||(this.options.show_probs=!1),t.scaled_max?this.data.max_height=t.data.max_height_obs||this.data.max_height||2:this.data.max_height=t.data.max_height_theory||this.data.max_height||2,t.colors?this.changeColors(t.colors):"aa"===this.alphabet?(this.aa_colors=n(100),this.changeColors(this.aa_colors)):(this.dna_colors=n(101),this.changeColors(this.dna_colors))},initialize:function(t){if(!i())return void(this.el.textContent="Your browser doesn't support canvas.");void 0==t.data&&(this.el.textContent="No data added."),_.extend(this.options,t);var e=this.options;if(this.loadDefault(e),this.options.show_probs?this.data.processing&&/^observed|weighted/.test(this.data.processing)?(this.show_inserts=0,this.info_content_height=this.height-14):(this.show_inserts=1,this.info_content_height=this.height-44):this.info_content_height=this.height,this.$el=u(this.el),this.initDivs(),this.options.settings){var n=h(this,e);this.$el.append(n)}l(this.$el,this,this.logo_graphic)},initDivs:function(){var t=c("div");t.className="logo_graphic",this.logo_graphic=u(t);var e=c("div");if(e.className="logo_container",e.style.height=this.height,this.container=u(e),this.container.append(t),this.$el.append(e),this.options.divider){var n=c("div");n.className="logo_divider",this.$el.append(n)}this.dom_element=u(t),this.called_on=this.$el,this.options.xaxis&&a.render_x_axis_label.call(this),this.options.yaxis?a.render_y_axis_label.call(this):this.container[0].style.marginLeft="0px"},render:function(){return r.call(this),this},changeColors:function(t){this.colors=t;var e=void 0!=t&&void 0!=t.type;e&&(this.colorscheme="dynamic"),this.buildAlphabet()},buildAlphabet:function(){this.letters={};var t=this.colors;if("dynamic"==this.colorscheme){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");t={},e.forEach(function(e){t[e]=""})}for(var n in t)if(t.hasOwnProperty(n)){var i={color:t[n]};this.letters[n]=new o(n,i)}},toggleColorscheme:function(t){var e=this.currentColumn();t?"default"===t?this.colorscheme="default":this.colorscheme="consensus":"default"===this.colorscheme?this.colorscheme="consensus":this.colorscheme="default",this.rendered=[],this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},toggleScale:function(t){var e=this.currentColumn();t?"obs"===t?this.data.max_height=this.data.max_height_obs:this.data.max_height=this.data.max_height_theory:this.data.max_height===this.data.max_height_obs?this.data.max_height=this.data.max_height_theory:this.data.max_height=this.data.max_height_obs,this.rendered=[],this.logoYAxis&&this.logoYAxis.remove(),a.render_y_axis_label.call(this),this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},toggleAliMap:function(t){var e=this.currentColumn();t?"model"===t?this.display_ali_map=0:this.display_ali_map=1:1===this.display_ali_map?this.display_ali_map=0:this.display_ali_map=1,a.render_x_axis_label(this),this.rendered=[],this.scrollme.reflow(),this.scrollToColumn(e+1),this.scrollToColumn(e)},currentColumn:function(){var t=this.scrollme.scroller.getValues().left,e=this.column_width*this.zoom,n=t/e,i=this.container.width()/e/2,r=Math.ceil(n+i);return r},changeZoom:function(t){var e=.3,n=null;if(t.target?e=t.target:t.distance&&(e=(parseFloat(this.zoom)-parseFloat(t.distance)).toFixed(1),"+"===t.direction&&(e=(parseFloat(this.zoom)+parseFloat(t.distance)).toFixed(1))),e>1?e=1:e<.1&&(e=.1),n=this.logo_graphic.width()*e/this.zoom,n>this.container.width())if(t.column){this.zoom=e,this.render({zoom:this.zoom}),this.scrollme.reflow();var i=this.coordinatesFromColumn(t.column);this.scrollme.scroller.scrollTo(i-t.offset)}else{var r=this.currentColumn();this.zoom=e,this.render({zoom:this.zoom}),this.scrollme.reflow(),this.scrollToColumn(r)}return this.zoom},columnFromCoordinates:function(t){var e=Math.ceil(t/(this.column_width*this.zoom));return e},coordinatesFromColumn:function(t){var e=t-1,n=e*(this.column_width*this.zoom)+this.column_width*this.zoom/2;return n},scrollToColumn:function(t,e){var n=this.logo_container.width()/2,i=this.coordinatesFromColumn(t);this.scrollme.scroller.scrollTo(i-n,0,e)},calcMaxHeight:function(t){return t.reduce(function(t,e){var n=0;for(var i in e)n+=e[i];return n>t?n:t},0)}});var c=function(t){return document.createElement(t)}},function(t,e,n){var i=n(7);t.exports=function(t,e){var n=i('<form class="logo_form"><fieldset><label for="position">Column number</label><input type="text" name="position" class="logo_position"></input><button class="button logo_change">Go</button></fieldset></form>'),r=i('<div class="logo_settings"></div>');if(r.append('<span class="close">x</span>'),t.scale_height_enabled&&t.data.max_height_obs<t.data.max_height_theory){var o="",s="",a="",l="";t.data.max_height_obs===t.data.max_height?o="checked":s="checked"}var h='<fieldset><legend>Scale</legend><label><input type="radio" name="scale" class="logo_scale" value="obs" '+o+"/>Maximum Observed "+l+'</label></br><label><input type="radio" name="scale" class="logo_scale" value="theory" '+s+"/>Maximum Theoretical "+a+"</label></fieldset>";if(r.append(h),"score"!==t.data.height_calc&&"aa"===t.data.alphabet&&t.data.probs_arr){var u=null,c=null,f="",d="";"default"===t.colorscheme?u="checked":c="checked",e.help&&(f='<a class="help" href="/help#colors_default" title="Each letter receives its own color."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>',d='<a class="help" href="/help#colors_consensus" title="Letters are colored as in Clustalx and Jalview, with colors depending on composition of the column."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>');var g='<fieldset><legend>Color Scheme</legend><label><input type="radio" name="color" class="logo_color" value="default" '+u+"/>Default "+f+'</label></br><label><input type="radio" name="color" class="logo_color" value="consensus" '+c+"/>Consensus Colors "+d+"</label></fieldset>";r.append(g)}if(t.data.ali_map){var p=null,m=null,v="",b="";0===t.display_ali_map?p="checked":m="checked",e.help&&(v='<a class="help" href="/help#coords_model" title="The coordinates along the top of the plot show the model position."><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>',b='<a class="help" href="/help#coords_ali" title="The coordinates along the top of the plot show the column in the alignment associated with the model"><span aria-hidden="true" data-icon="?"></span><span class="reader-text">help</span></a>');var x='<fieldset><legend>Coordinates</legend><label><input type="radio" name="coords" class="logo_ali_map" value="model" '+p+"/>Model "+v+'</label></br><label><input type="radio" name="coords" class="logo_ali_map" value="alignment" '+m+"/>Alignment "+b+"</label></fieldset>";r.append(x)}var y=i('<div class="logo_controls"></div>');return t.zoom_enabled&&y.append('<button class="logo_zoomout button">-</button><button class="logo_zoomin button">+</button>'),r.children().length>0&&(y.append('<button class="logo_settings_switch button">Settings</button>'),y.append(r)),n.append(y),n}},function(t,e){t.exports=function(t,e){e=e||{},this.value=t,this.width=parseInt(e.width,10)||100,"W"===this.value&&(this.width+=30*this.width/100),this.height=parseInt(e.height,10)||100,this.color=e.color||"#000000",this.fontSize=e.fontSize||138,this.scaled=function(){},this.draw=function(t,e,n,i,r,o){var s=e/this.height,a=n/this.width,l=t.font;t.transform(a,0,0,s,i,r),t.fillStyle=o||this.color,t.textAlign="center",t.font="bold "+this.fontSize+"px Arial",t.fillText(this.value,0,0),t.setTransform(1,0,0,1,0,0),t.fillStyle="#000000",t.font=l}}},function(t,e,n){function i(t,e,n,i,r){var o=s(t).find("#canv_"+i);return o.length||(s(t).append('<canvas class="canvas_logo" id="canv_'+i+'"  height="'+e+'" width="'+n+'" style="left:'+r*i+'px"></canvas>'),o=s(t).find("#canv_"+i)),s(o).attr("width",n).attr("height",e),o[0]}var r=n(108),o=n(107),s=n(7);t.exports=function(t){if(this.data){t=t||{};var e=t.zoom||this.zoom,n=t.target||1,s=(t.scaled||null,this.dom_element.parent().attr("width")),a=1,l=null,h=null,u=0;if(this.previous_target=n,t.start&&(this.start=t.start),t.end&&(this.end=t.end),e<=.1?e=.1:e>=1&&(e=1),this.zoom=e,l=this.end||this.data.heightArr.length,h=this.start||1,l=l>this.data.heightArr.length?this.data.heightArr.length:l,l=l<h?h:l,h=h>l?l:h,h=h>1?h:1,this.y=this.height-20,this.max_width=this.column_width*(l-h+1),s>this.max_width&&(e=1,this.zoom_enabled=!1),this.zoom=e,this.zoomed_column=this.column_width*e,this.total_width=this.zoomed_column*(l-h+1),e<1)for(;this.total_width<s&&(this.zoom+=.1,this.zoomed_column=this.column_width*this.zoom,this.total_width=this.zoomed_column*(l-h+1),this.zoom_enabled=!1,!(e>=1)););n>this.total_width&&(n=this.total_width),this.dom_element.attr({width:this.total_width+"px"}).css({width:this.total_width+"px"}),this.canvas_width=this.total_width;var c=Math.ceil(this.total_width/this.canvas_width);for(this.columns_per_canvas=Math.ceil(this.canvas_width/this.zoomed_column),this.previous_zoom!==this.zoom&&(this.dom_element.find("canvas").remove(),this.previous_zoom=this.zoom,this.rendered=[]),this.canvases=[],this.contexts=[],u=0;u<c;u++){var f=this.columns_per_canvas*u+h,d=f+this.columns_per_canvas-1;d>l&&(d=l);var g=(d-f+1)*this.zoomed_column;g>a&&(a=g);var p=a*u,m=p+g;if(n<m+m/2&&n>p-p/2)if(this.canvases[u]=i(this.dom_element,this.height,g,u,a),this.contexts[u]=this.canvases[u].getContext("2d"),this.contexts[u].setTransform(1,0,0,1,0,0),this.contexts[u].clearRect(0,0,g,this.height),this.contexts[u].fillStyle="#ffffff",this.contexts[u].fillRect(0,0,m,this.height),this.zoomed_column>12){var v=parseInt(10*e,10);v=v>10?10:v,this.debug&&o.call(this,f,d,u,1),r.call(this,f,d,u,v)}else o.call(this,f,d,u)}!this.scrollme&&this.options.scroller&&(this.scrollme=new EasyScroller(this.dom_element[0],{scrollingX:1,scrollingY:0,eventTarget:this.called_on})),1!==n&&this.scrollme.reflow()}}},function(t,e,n){function i(t,e,n,i,r,o,s,a){var l="#ffffff";a?(r>.1?l="#d7301f":r>.05?l="#fc8d59":r>.03&&(l="#fdcc8a"),t.fillStyle=l,t.fillRect(e,n+15,i,10),l="#ffffff",o>9?l="#d7301f":o>7?l="#fc8d59":o>4&&(l="#fdcc8a"),t.fillStyle=l,t.fillRect(e,n+30,i,10)):n+=30,l="#ffffff",s<.75?l="#2171b5":s<.85?l="#6baed6":s<.95&&(l="#bdd7e7"),t.fillStyle=l,t.fillRect(e,n,i,10)}var r=n(46),o=n(48),s=n(47);t.exports=function(t,e,n,a){var l=0,h=t,u=null,c=0,f=Math.abs(this.data.max_height),d=Math.abs(this.data.min_height_obs),g=f+d,p=Math.round(100*Math.abs(this.data.max_height)/g),m=Math.round(this.info_content_height*p/100),v=(this.info_content_height-m,10);for(c=t;c<=e;c++){if(this.data.mmline&&1===this.data.mmline[c-1])this.contexts[n].fillStyle="#cccccc",this.contexts[n].fillRect(l,10,this.zoomed_column,this.height-40);else{var b=this.data.heightArr[c-1],x=0,y=(b.length,0);for(var y in b)if(values=[y,b[y]],values[1]>.01){var w=parseFloat(values[1])/this.data.max_height,_=l,S=(this.info_content_height-2)*w,C=this.info_content_height-2-x-S,E=null;E="dynamic"===this.colorscheme?this.colors.getColor(values[0],{pos:c-1}):"consensus"===this.colorscheme?this.cmap[c-1][values[0]]||"#7a7a7a":this.colors[values[0]],a?(this.contexts[n].strokeStyle=E,this.contexts[n].strokeRect(_,C,this.zoomed_column,S)):(this.contexts[n].fillStyle=E,this.contexts[n].fillRect(_,C,this.zoomed_column,S)),x+=S}}this.zoom<.2?v=20:this.zoom<.3&&(v=10),this.options.positionMarker&&c%v===0&&(this.options.show_probs&&o(this.contexts[n],l+this.zoomed_column,this.height-30,parseFloat(this.height),"#dddddd"),o(this.contexts[n],l+this.zoomed_column,0,5),u=this.display_ali_map?this.data.ali_map[c-1]:h,s(this.contexts[n],l-2,10,this.zoomed_column,u,10,!0)),this.options.show_probs&&i(this.contexts[n],l,this.height-42,this.zoomed_column,this.data.insert_probs[c-1],this.data.insert_lengths[c-1],this.data.delete_probs[c-1],this.show_inserts),this.options.show_probs&&(this.show_inserts?r(this.contexts[n],this.height-45,this.total_width):r(this.contexts[n],this.height-15,this.total_width)),this.options.border&&r(this.contexts[n],0,this.total_width),l+=this.zoomed_column,h++}}},function(t,e,n){function i(t,e,n,i,o,s,a){var l=n-4,h="#ffffff",u="#555555";a&&(l=n-35),o<.75?(h="#2171b5",u="#ffffff"):o<.85?h="#6baed6":o<.95&&(h="#bdd7e7"),r(t,e,l,o,s,i,h,u)}function r(t,e,n,i,r,o,s,a){t.font=r+"px Arial",t.fillStyle=s,t.fillRect(e,n-10,o,14),t.textAlign="center",t.fillStyle=a,t.fillText(i,e+o/2,n)}function o(t,e){var n=e.ralign?e.x+t.zoomed_column:e.x,i=e.ralign?e.x+2:e.x;h(t.contexts[e.context_num],n,t.height-30,-30-t.height,"#dddddd"),h(t.contexts[e.context_num],n,0,5),u(t.contexts[e.context_num],i,10,t.zoomed_column,e.column_num,e.fontsize,e.ralign)}function s(t,e,n,i,o,s){var a=n-20,l="#ffffff",u="#555555";o>.1?(l="#d7301f",u="#ffffff"):o>.05?l="#fc8d59":o>.03&&(l="#fdcc8a"),r(t,e,a,o,s,i,l,u),o>.03&&h(t,e+i,n-30,-30-n,l)}function a(t,e,n,i,o,s){var a="#ffffff",l="#555555";o>9?(a="#d7301f",l="#ffffff"):o>7?a="#fc8d59":o>4&&(a="#fdcc8a"),r(t,e,n,o,s,i,a,l)}var l=n(46),h=n(48),u=n(47);t.exports=function(t,e,n,r){var u=0,c=t,f=null,d=0,g=Math.abs(this.data.max_height),p=isNaN(this.data.min_height_obs)?0:parseInt(this.data.min_height_obs,10),m=g+Math.abs(p),v=Math.round(100*Math.abs(this.data.max_height)/m),b=Math.round(this.info_content_height*v/100),x=this.info_content_height-b;b/this.info_content_height,x/this.info_content_height;for(e+3<=this.end&&(e+=3),d=t;d<=e;d++){if(this.data.mmline&&1===this.data.mmline[d-1])this.contexts[n].fillStyle="#cccccc",this.contexts[n].fillRect(u,10,this.zoomed_column,this.height-40);else{var y=this.data.heightArr[d-1],w=[];if(y){var _=0,S=(y.length,0),C=null;for(var S in y){var E=y[S],k=[S,E];if(x_pos=u+this.zoomed_column/2,letter_height=null,k[1]>.01){letter_height=parseFloat(k[1])/this.data.max_height;var z=this.info_content_height-2-_,T=(this.info_content_height-2)*letter_height;w[S]=[T,this.zoomed_column,x_pos,z],_+=T}}for(var S in y)w[S]&&this.letters[S]&&(C="dynamic"===this.colorscheme?this.colors.getColor(S,{pos:d-1}):"consensus"===this.colorscheme?this.cmap[d-1][S]||"#7a7a7a":null,this.letters[S].draw(this.contexts[n],w[S][0],w[S][1],w[S][2],w[S][3],C))}}f=this.display_ali_map?this.data.ali_map[d-1]:c,this.options.show_divider&&(this.zoom<.7?d%this.options.divider_step===0&&o(this,{context_num:n,x:u,fontsize:10,column_num:f,ralign:!0}):o(this,{context_num:n,x:u,fontsize:r,column_num:f})),this.options.show_probs&&(i(this.contexts[n],u,this.height,this.zoomed_column,this.data.delete_probs[d-1],r,this.show_inserts),h(this.contexts[n],u,this.height-15,5),this.show_inserts&&(s(this.contexts[n],u,this.height,this.zoomed_column,this.data.insert_probs[d-1],r),a(this.contexts[n],u,this.height-5,this.zoomed_column,this.data.insert_lengths[d-1],r),h(this.contexts[n],u,this.height-45,5),h(this.contexts[n],u,this.height-30,5))),u+=this.zoomed_column,c++}this.options.show_probs&&(this.show_inserts&&(l(this.contexts[n],this.height-30,this.total_width),l(this.contexts[n],this.height-45,this.total_width)),l(this.contexts[n],this.height-15,this.total_width)),this.options.border&&l(this.contexts[n],0,this.total_width)}},function(t,e){var n=window.HTMLCanvasElement&&window.HTMLCanvasElement.prototype,i=window.Blob&&function(){try{return Boolean(new Blob)}catch(t){return!1}}(),r=i&&window.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(t){return!1}}(),o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,s=(i||o)&&window.atob&&window.ArrayBuffer&&window.Uint8Array&&function(t){var e,n,s,a,l,h;for(e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):decodeURIComponent(t.split(",")[1]),n=new ArrayBuffer(e.length),s=new Uint8Array(n),a=0;a<e.length;a+=1)s[a]=e.charCodeAt(a);return l=t.split(",")[0].split(":")[1].split(";")[0],i?new Blob([r?s:n],{type:l}):(h=new o,h.append(n),h.getBlob(l))};window.HTMLCanvasElement&&!n.toBlob&&(n.mozGetAsFile?n.toBlob=function(t,e,i){t(i&&n.toDataURL&&s?s(this.toDataURL(e,i)):this.mozGetAsFile("blob",e))}:n.toDataURL&&s&&(n.toBlob=function(t,e,n){t(s(this.toDataURL(e,n)))})),t.exports=s},function(t,e,n){(function(t){/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var e=e||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(t){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r=!t.externalHost&&"download"in i,o=function(n){var i=e.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)},s=t.webkitRequestFileSystem,a=t.requestFileSystem||s||t.mozRequestFileSystem,l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},h="application/octet-stream",u=0,c=[],f=function(){for(var t=c.length;t--;){var e=c[t];"string"==typeof e?n().revokeObjectURL(e):e.remove()}c.length=0},d=function(t,e,n){e=[].concat(e);for(var i=e.length;i--;){var r=t["on"+e[i]];if("function"==typeof r)try{r.call(t,n||t)}catch(t){l(t)}}},g=function(e,l){var f,g,p,m=this,v=e.type,b=!1,x=function(){var t=n().createObjectURL(e);return c.push(t),t},y=function(){d(m,"writestart progress write writeend".split(" "))},w=function(){!b&&f||(f=x(e)),g?g.location.href=f:window.open(f,"_blank"),m.readyState=m.DONE,y()},_=function(t){return function(){if(m.readyState!==m.DONE)return t.apply(this,arguments)}},S={create:!0,exclusive:!1};return m.readyState=m.INIT,l||(l="download"),r?(f=x(e),i.href=f,i.download=l,o(i),m.readyState=m.DONE,void y()):(t.chrome&&v&&v!==h&&(p=e.slice||e.webkitSlice,e=p.call(e,0,e.size,h),b=!0),s&&"download"!==l&&(l+=".download"),(v===h||s)&&(g=t),a?(u+=e.size,void a(t.TEMPORARY,u,_(function(t){t.root.getDirectory("saved",S,_(function(t){var n=function(){t.getFile(l,S,_(function(t){t.createWriter(_(function(n){n.onwriteend=function(e){g.location.href=t.toURL(),c.push(t),m.readyState=m.DONE,d(m,"writeend",e)},n.onerror=function(){var t=n.error;t.code!==t.ABORT_ERR&&w()},"writestart progress write abort".split(" ").forEach(function(t){n["on"+t]=m["on"+t]}),n.write(e),m.abort=function(){n.abort(),m.readyState=m.DONE},m.readyState=m.WRITING}),w)}),w)};t.getFile(l,{create:!1},_(function(t){t.remove(),n()}),_(function(t){t.code===t.NOT_FOUND_ERR?n():w()}))}),w)}),w)):void w())},p=g.prototype,m=function(t,e){return new g(t,e)};return p.abort=function(){var t=this;t.readyState=t.DONE,d(t,"abort")},p.readyState=p.INIT=0,p.WRITING=1,p.DONE=2,p.error=p.onwritestart=p.onprogress=p.onwrite=p.onabort=p.onerror=p.onwriteend=null,t.addEventListener("unload",f,!1),m.unload=function(){f(),t.removeEventListener("unload",f,!1)},m}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content),n=window.define;"undefined"==typeof n&&"undefined"!=typeof window.almond&&"define"in window.almond&&(n=window.almond.define),"undefined"!=typeof t&&null!==t?t.exports=e:"undefined"!=typeof n&&null!==n&&null!=n.amd&&n("saveAs",[],function(){return e})}).call(e,n(40)(t))},function(t,e,n){e=t.exports=n(112)(),e.push([t.id,'.biojs_msa_stage{cursor:default;line-height:normal}.biojs_msa_seqblock{cursor:move}.biojs_msa_layer{display:block;white-space:nowrap}.biojs_msa_labels{color:#000;display:inline-block;cursor:pointer;vertical-align:middle;overflow:hidden;text-overflow:clip}.biojs_msa_header,.biojs_msa_labels{white-space:nowrap;text-align:left}.biojs_msa_labelrow:before{content:"";display:inline-block;width:0;height:100%;vertical-align:middle}.biojs_msa_labelrow{height:100%}.biojs_msa_labelblock::-webkit-scrollbar,.biojs_msa_rheader::-webkit-scrollbar{//:none;width:7px;height:7px}.biojs_msa_labelblock::-webkit-scrollbar-thumb,.biojs_msa_rheader::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,.5);box-shadow:0 0 1px hsla(0,0%,100%,.5)}.biojs_msa_marker{color:grey;white-space:nowrap;cursor:pointer}.biojs_msa_marker span{text-align:center}.smenubar .smenubar_alink{background:#3498db;background-image:linear-gradient(180deg,#3498db,#2980b9);border-radius:28px;font-family:Arial;color:#fff;padding:3px 10px;margin-left:10px;text-decoration:none}.smenubar{display:inline-block}.smenubar .smenubar_alink:hover{cursor:pointer}.smenu-dropdown{position:absolute;z-index:9999999;display:none}.smenu-dropdown .smenu-dropdown-menu,.smenu-dropdown .smenu-dropdown-panel{min-width:160px;max-width:360px;list-style:none;background:#fff;border:1px solid #ddd;border:1px solid rgba(0,0,0,.2);border-radius:6px;box-shadow:0 5px 10px rgba(0,0,0,.2);overflow:visible;padding:4px 0;margin:0}.smenu-dropdown .smenu-dropdown-panel{padding:10px}.smenu-dropdown.smenu-dropdown-scroll .smenu-dropdown-menu,.smenu-dropdown.smenu-dropdown-scroll .smenu-dropdown-panel{max-height:358px;overflow:auto}.smenu-dropdown .smenu-dropdown-menu LI{list-style:none;padding:0;margin:0;line-height:18px}.smenu-dropdown .smenu-dropdown-menu LABEL,.smenu-dropdown .smenu-dropdown-menu LI{display:block;color:#555;text-decoration:none;line-height:18px;padding:3px 15px;white-space:nowrap}.smenu-dropdown .smenu-dropdown-menu LABEL:hover,.smenu-dropdown .smenu-dropdown-menu LI:hover{background-color:#08c;color:#fff;cursor:pointer}.smenu-dropdown .smenu-dropdown-menu .smenu-dropdown-divider{font-size:1px;border-top:1px solid #e5e5e5;padding:0;margin:5px 0}',""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<e.length;r++){var s=e[r];"number"==typeof s[0]&&i[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(t,e){(function(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=n}).call(e,function(){return this}())},function(t,e){function n(t){if(!t)return!1;var e=i.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}t.exports=n;var i=Object.prototype.toString},function(t,e,n){t.exports=n(116)},function(t,e,n){var i,r,o;r=n(7),o=n(3),t.exports=i=o.extend({initialize:function(t){this._nodes=[],this.name=t.name||"",this.el.className+="smenubar"},render:function(){for(var t=this.el.firstChild;t;)this.el.removeChild(t),t=this.el.firstChild;this.el.appendChild(this.buildDOM())},setName:function(t){this.name=t},addNode:function(t,e,n){var i;null!=n&&(i=n.style),null==this._nodes&&(this._nodes=[]),this._nodes.push({label:t,callback:e,style:i})},getNode:function(t){var e=void 0;return this._nodes.forEach(function(n){n.label===t&&(e=n)}),e},modifyNode:function(t,e,n){var i=this.getNode(t);i.callback=e||i.callback,n=n||{},i.style=n.style||i.style},renameNode:function(t,e){var n=this.getNode(t);n.label=e||n.label},removeNode:function(t){var e=this.getNode(t);this._nodes.splice(this._nodes.indexOf(e),1)},removeAllNodes:function(){this._nodes=[]},buildDOM:function(){var t=document.createElement("span");return t.appendChild(this._buildM({nodes:this._nodes,name:this.name})),t},_buildM:function(t){var e,n,i,o,s,a,l,h=t.nodes,u=t.name,c=document.createElement("div");c.className="smenu-dropdown smenu-dropdown-tip",c.style.display="none";var f=document.createElement("ul");f.className="smenu-dropdown-menu";for(var d=0,g=h.length;d<g;d++){s=h[d],o=document.createElement("li"),o.textContent=s.label,l=s.style;for(i in l)a=l[i],o.style[i]=a;o.addEventListener("click",s.callback),this.trigger("new:node",o),f.appendChild(o)}return this.trigger("new:menu",f),c.appendChild(f),e=document.createElement("a"),e.textContent=u,e.className="smenubar_alink",this.trigger("new:button",e),r(e).on("click",function(t){return function(n){return t._showMenu(n,c,e),window.setTimeout(function(){return r(document.body).one("click",function(t){return c.style.display="none"})},5)}}(this)),n=document.createDocumentFragment(),n.appendChild(c),n.appendChild(e),n},_showMenu:function(t,e,n){var i;e.style.display="block",e.style.position="absolute",i=n.getBoundingClientRect(),e.style.left=i.left+"px",e.style.top=i.top+n.offsetHeight+"px"}})},function(t,e){t.exports={A:"#00a35c",R:"#00fc03",N:"#00eb14",D:"#00eb14",C:"#0000ff",Q:"#00f10e",E:"#00f10e",G:"#009d62",H:"#00d52a",I:"#0054ab",L:"#007b84",K:"#00ff00",M:"#009768",F:"#008778",P:"#00e01f",S:"#00d52a",T:"#00db24",W:"#00a857",Y:"#00e619",V:"#005fa0",B:"#00eb14",X:"#00b649",Z:"#00f10e"}},function(t,e){t.exports={A:"#BBBBBB",B:"grey",C:"yellow",D:"red",E:"red",F:"magenta",G:"brown",H:"#00FFFF",I:"#BBBBBB",J:"#fff",K:"#00FFFF",L:"#BBBBBB",M:"#BBBBBB",N:"green",O:"#fff",P:"brown",Q:"green",R:"#00FFFF",S:"green",T:"green",U:"#fff",V:"#BBBBBB",W:"magenta",X:"grey",Y:"magenta",Z:"grey",Gap:"grey"}},function(t,e){t.exports={A:"orange",B:"#fff",C:"green",D:"red",E:"red",F:"blue",G:"orange",H:"red",I:"green",J:"#fff",K:"red",L:"green",M:"green",N:"#fff",O:"#fff",P:"orange",Q:"#fff",R:"red",S:"orange",T:"orange",U:"#fff",V:"green",W:"blue",X:"#fff",Y:"blue",Z:"#fff",Gap:"#fff"}},function(t,e){t.exports={A:"#80a0f0",R:"#f01505",N:"#00ff00",D:"#c048c0",C:"#f08080",Q:"#00ff00",E:"#c048c0",G:"#f09048",H:"#15a4a4",I:"#80a0f0",L:"#80a0f0",K:"#f01505",M:"#80a0f0",F:"#80a0f0",P:"#ffff00",S:"#00ff00",T:"#00ff00",W:"#80a0f0",Y:"#15a4a4",V:"#80a0f0",B:"#fff",X:"#fff",Z:"#fff"}},function(t,e){t.exports={A:"#e718e7",R:"#6f906f",N:"#1be41b",D:"#778877",C:"#23dc23",Q:"#926d92",E:"#ff00ff",G:"#00ff00",H:"#758a75",I:"#8a758a",L:"#ae51ae",K:"#a05fa0",M:"#ef10ef",F:"#986798",P:"#00ff00",S:"#36c936",T:"#47b847",W:"#8a758a",Y:"#21de21",V:"#857a85",B:"#49b649",X:"#758a75",Z:"#c936c9"}},function(t,e){t.exports={A:"#ad0052",B:"#0c00f3",C:"#c2003d",D:"#0c00f3",E:"#0c00f3",F:"#cb0034",G:"#6a0095",H:"#1500ea",I:"#ff0000",J:"#fff",K:"#0000ff",L:"#ea0015",M:"#b0004f",N:"#0c00f3",O:"#fff",P:"#4600b9",Q:"#0c00f3",R:"#0000ff",S:"#5e00a1",T:"#61009e",U:"#fff",V:"#f60009",W:"#5b00a4",X:"#680097",Y:"#4f00b0",Z:"#0c00f3"}},function(t,e,n){function i(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var r=n(129),o=r.stat,s=r.dyn,a=n(117),l=n(118),h=n(119),u=n(120),c=n(121),f=n(122),d=n(124),g=n(125),p=n(126),m=n(128),v=n(130),b=n(131),x=n(132),y=n(133),w={buried:a,buried_index:a,cinema:l,clustal2:u,clustal:h,helix:c,helix_propensity:c,hydro:f,lesk:d,mae:g,nucleotide:p,purine:m,purine_pyrimidine:m,strand:v,strand_propensity:v,taylor:b,turn:x,turn_propensity:x,zappo:y},_=n(127),S={pid:_},C=function(t){this.maps=i(w),this.dyn=i(S),this.opt=t};t.exports=C,C.getScheme=function(t){return w[t]},C.prototype.getScheme=function(t){var e=this.maps[t];return void 0===e&&(e={},void 0!=this.dyn[t])?new s(this.dyn[t],this.opt):new o(e)},C.prototype.addStaticScheme=function(t,e){this.maps[t]=e},C.prototype.addDynScheme=function(t,e){this.dyn[t]=e}},function(t,e){t.exports={A:" orange",B:" #fff",C:" green",D:" red",E:" red",F:" green",G:" orange",H:" magenta",I:" green",J:" #fff",K:" red",L:" green",M:" green",N:" magenta",O:" #fff",P:" green",Q:" magenta",R:" red",S:" orange",T:" orange",U:" #fff",V:" green",W:" green",X:" #fff",Y:" green",Z:" #fff",Gap:" #fff"}},function(t,e){t.exports={A:" #77dd88",B:" #fff",C:" #99ee66",D:" #55bb33",E:" #55bb33",F:" #9999ff",G:" #77dd88",H:" #5555ff",I:" #66bbff",J:" #fff",K:" #ffcc77",L:" #66bbff",M:" #66bbff",N:" #55bb33",O:" #fff",P:" #eeaaaa",Q:" #55bb33",R:" #ffcc77",S:" #ff4455",T:" #ff4455",U:" #fff",V:" #66bbff",W:" #9999ff",X:" #fff",Y:" #9999ff",Z:" #fff",Gap:" #fff"}},function(t,e){t.exports={A:" #64F73F",C:" #FFB340",G:" #EB413C",T:" #3C88EE",U:" #3C88EE"}},function(t,e){var n;t.exports=n={},n.init=function(){this.cons=this.opt.conservation()},n.run=function(t,e){var n=this.cons[e.pos];return n>.8?"#6464ff":n>.6?"#9da5ff":n>.4?"#cccccc":"#ffffff"}},function(t,e){t.exports={A:" #FF83FA",C:" #40E0D0",G:" #FF83FA",R:" #FF83FA",T:" #40E0D0",U:" #40E0D0",Y:" #40E0D0"}},function(t,e){var n=function(t){this.defaultColor="#ffffff",this.type="static",this.map=t,this.getColor=function(t){return void 0!==this.map[t]?this.map[t]:this.defaultColor}},i=function(t,e){this.type="dyn",this.opt=e,void 0!==t.init?(t.init.call(this),this.getColor=t.run,this.reset=t.init):this.getColor=t};t.exports.stat=n,t.exports.dyn=i},function(t,e){t.exports={A:"#5858a7",R:"#6b6b94",N:"#64649b",D:"#2121de",C:"#9d9d62",Q:"#8c8c73",E:"#0000ff",G:"#4949b6",H:"#60609f",I:"#ecec13",L:"#b2b24d",K:"#4747b8",M:"#82827d",F:"#c2c23d",P:"#2323dc",S:"#4949b6",T:"#9d9d62",W:"#c0c03f",Y:"#d3d32c",V:"#ffff00",B:"#4343bc",X:"#797986",Z:"#4747b8"}},function(t,e){t.exports={A:"#ccff00",R:"#0000ff",N:"#cc00ff",D:"#ff0000",C:"#ffff00",Q:"#ff00cc",E:"#ff0066",G:"#ff9900",H:"#0066ff",I:"#66ff00",L:"#33ff00",K:"#6600ff",M:"#00ff00",F:"#00ff66",P:"#ffcc00",S:"#ff3300",T:"#ff6600",W:"#00ccff",Y:"#00ffcc",V:"#99ff00",B:"#fff",X:"#fff",Z:"#fff"}},function(t,e){t.exports={A:"#2cd3d3",R:"#708f8f",N:"#ff0000",D:"#e81717",C:"#a85757",Q:"#3fc0c0",E:"#778888",G:"#ff0000",H:"#708f8f",I:"#00ffff",L:"#1ce3e3",K:"#7e8181",M:"#1ee1e1",F:"#1ee1e1",P:"#f60909",S:"#e11e1e",T:"#738c8c",W:"#738c8c",Y:"#9d6262",V:"#07f8f8",B:"#f30c0c",X:"#7c8383",Z:"#5ba4a4"}},function(t,e){t.exports={A:"#ffafaf",R:"#6464ff",N:"#00ff00",D:"#ff0000",C:"#ffff00",Q:"#00ff00",E:"#ff0000",G:"#ff00ff",H:"#6464ff",I:"#ffafaf",L:"#ffafaf",K:"#6464ff",M:"#ffafaf",F:"#ffc800",P:"#ff00ff",S:"#00ff00",T:"#00ff00",W:"#ffc800",Y:"#ffc800",V:"#ffafaf",B:"#fff",X:"#fff",Z:"#fff"}},function(t,e,n){(function(t,e){!function(t,n){"use strict";function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return p[g]=i,d(g),g++}function r(t){delete p[t]}function o(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}function s(t){if(m)setTimeout(s,0,t);else{var e=p[t];if(e){m=!0;try{o(e)}finally{r(t),m=!1}}}}function a(){d=function(t){e.nextTick(function(){s(t)})}}function l(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}function h(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&s(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),d=function(n){t.postMessage(e+n,"*")}}function u(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;s(e)},d=function(e){t.port2.postMessage(e)}}function c(){var t=v.documentElement;d=function(e){var n=v.createElement("script");n.onreadystatechange=function(){s(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}function f(){d=function(t){setTimeout(s,0,t)}}if(!t.setImmediate){var d,g=1,p={},m=!1,v=t.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(t);b=b&&b.setTimeout?b:t,"[object process]"==={}.toString.call(t.process)?a():l()?h():t.MessageChannel?u():v&&"onreadystatechange"in v.createElement("script")?c():f(),b.setImmediate=i,b.clearImmediate=r}}("undefined"==typeof self?"undefined"==typeof t?this:t:self)}).call(e,function(){return this}(),n(51))},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=d[i.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](i.parts[o]);for(;o<i.parts.length;o++)r.parts.push(h(i.parts[o],e))}else{for(var s=[],o=0;o<i.parts.length;o++)s.push(h(i.parts[o],e));d[i.id]={id:i.id,refs:1,parts:s}}}}function r(t){for(var e=[],n={},i=0;i<t.length;i++){var r=t[i],o=r[0],s=r[1],a=r[2],l=r[3],h={css:s,media:a,sourceMap:l};n[o]?n[o].parts.push(h):e.push(n[o]={id:o,parts:[h]})}return e}function o(t,e){var n=m(),i=x[x.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),x.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function s(t){t.parentNode.removeChild(t);var e=x.indexOf(t);e>=0&&x.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function h(t,e){var n,i,r;if(e.singleton){var o=b++;n=v||(v=a(e)),i=u.bind(null,n,o,!1),r=u.bind(null,n,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(e),i=f.bind(null,n),r=function(){s(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),i=c.bind(null,n),r=function(){s(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function u(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function c(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,i=e.sourceMap;i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var r=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(r),o&&URL.revokeObjectURL(o)}var d={},g=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},p=g(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),m=g(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0,x=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=p()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=r(t);return i(n,e),function(t){for(var o=[],s=0;s<n.length;s++){var a=n[s],l=d[a.id];l.refs--,o.push(l)}if(t){var h=r(t);i(h,e)}for(var s=0;s<o.length;s++){var l=o[s];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete d[l.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){var i=n(111);"string"==typeof i&&(i=[[t.id,i,""]]);n(135)(i,{});i.locals&&(t.exports=i.locals)},function(t,e,n){(function(t){function i(t,e){this._id=t,this._clearFn=e}var r="undefined"!=typeof t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(134),e.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(e,function(){return this}())},function(t,e,n){var i;(function(r,o,s){/**
	 * @module vow
	 * @author Filatov Dmitry <dfilatov@yandex-team.ru>
	 * @version 0.4.20
	 * @license
	 * Dual licensed under the MIT and GPL licenses:
	 *   * http://www.opensource.org/licenses/mit-license.php
	 *   * http://www.gnu.org/licenses/gpl.html
	 */
!function(r){var a,l=function(){var t=[],e=function(e){return t.push(e),1===t.length},n=function(){var e=t,n=0,i=t.length;for(t=[];n<i;)e[n++]()},i=r.MutationObserver||r.WebKitMutationObserver;if(i){var a=1,l=document.createTextNode("");return new i(n).observe(l,{characterData:!0}),function(t){e(t)&&(l.data=a*=-1)}}if("object"==typeof o&&o.nextTick)return function(t){e(t)&&o.nextTick(n)};if("function"==typeof s)return function(t){e(t)&&s(n)};if(r.postMessage){var h=!0;if(r.attachEvent){var u=function(){h=!1};r.attachEvent("onmessage",u),r.postMessage("__checkAsync","*"),r.detachEvent("onmessage",u)}if(h){var c="__promise"+Math.random()+"_"+new Date,f=function(t){t.data===c&&(t.stopPropagation&&t.stopPropagation(),n())};return r.addEventListener?r.addEventListener("message",f,!0):r.attachEvent("onmessage",f),function(t){e(t)&&r.postMessage(c,"*")}}}var d=r.document;if("onreadystatechange"in d.createElement("script")){var g=function(){var t=d.createElement("script");t.onreadystatechange=function(){t.parentNode.removeChild(t),t=t.onreadystatechange=null,n()},(d.documentElement||d.body).appendChild(t)};return function(t){e(t)&&g()}}return function(t){e(t)&&setTimeout(n,0)}}(),h=function(t){l(function(){throw t})},u=function(t){return"function"==typeof t},c=function(t){return null!==t&&"object"==typeof t},f=Object.prototype.toString,d=Array.isArray||function(t){return"[object Array]"===f.call(t)},g=function(t){for(var e=[],n=0,i=t.length;n<i;)e.push(n++);return e},p=Object.keys||function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e},m=function(t){var e=function(e){this.name=t,this.message=e};return e.prototype=new Error,e},v=function(t,e){return function(n){t.call(this,n,e)}},b=r.PromiseRejectionEvent?function(t,e){new r.PromiseRejectionEvent("unhandledrejection",{promise:e,reason:t})}:"object"==typeof o&&o.emit?function(t,e){o.emit("unhandledRejection",t,e)}:function(){},x=function(){this._promise=new w};x.prototype={promise:function(){return this._promise},resolve:function(t){this._promise.isResolved()||this._promise._resolve(t)},reject:function(t){this._promise.isResolved()||(C.isPromise(t)?(t=t.then(function(t){var e=C.defer();return e.reject(t),e.promise()}),this._promise._resolve(t)):this._promise._reject(t))},notify:function(t){this._promise.isResolved()||this._promise._notify(t)}};var y={PENDING:0,RESOLVED:1,FULFILLED:2,REJECTED:3},w=function(t){if(this._value=a,this._status=y.PENDING,this._shouldEmitUnhandledRejection=!0,this._fulfilledCallbacks=[],this._rejectedCallbacks=[],this._progressCallbacks=[],t){var e=this,n=t.length;try{t(function(t){e.isResolved()||e._resolve(t)},n>1?function(t){e.isResolved()||e._reject(t)}:a,n>2?function(t){e.isResolved()||e._notify(t)}:a)}catch(t){this._reject(t)}}};w.prototype={valueOf:function(){return this._value},isResolved:function(){return this._status!==y.PENDING},isFulfilled:function(){return this._status===y.FULFILLED},isRejected:function(){return this._status===y.REJECTED},then:function(t,e,n,i){this._shouldEmitUnhandledRejection=!1;var r=new x;return this._addCallbacks(r,t,e,n,i),r.promise()},catch:function(t,e){return this.then(a,t,e)},fail:function(t,e){return this.then(a,t,e)},always:function(t,e){var n=this,i=function(){return t.call(this,n)};return this.then(i,i,e)},finally:function(t,e){var n=this,i=function(){return t.call(this)};return this.then(i,i,e).then(function(){return n})},progress:function(t,e){return this.then(a,a,t,e)},spread:function(t,e,n){return this.then(function(e){return t.apply(this,e)},e,n)},done:function(t,e,n,i){this.then(t,e,n,i).fail(h)},delay:function(t){var e,n=this.then(function(n){var i=new x;return e=setTimeout(function(){i.resolve(n)},t),i.promise()});return n.always(function(){clearTimeout(e)}),n},timeout:function(t){var e=new x,n=setTimeout(function(){e.reject(new C.TimedOutError("timed out"))},t);return this.then(function(t){e.resolve(t)},function(t){e.reject(t)}),e.promise().always(function(){clearTimeout(n)}),e.promise()},_vow:!0,_resolve:function(t){if(!(this._status>y.RESOLVED)){if(t===this)return void this._reject(TypeError("Can't resolve promise with itself"));if(this._status=y.RESOLVED,t&&t._vow)return void(t.isFulfilled()?this._fulfill(t.valueOf()):t.isRejected()?(t._shouldEmitUnhandledRejection=!1,this._reject(t.valueOf())):t.then(this._fulfill,this._reject,this._notify,this));if(c(t)||u(t)){var e;try{e=t.then}catch(t){return void this._reject(t)}if(u(e)){var n=this,i=!1;try{e.call(t,function(t){i||(i=!0,n._resolve(t))},function(t){i||(i=!0,n._reject(t))},function(t){n._notify(t)})}catch(t){i||this._reject(t)}return}}this._fulfill(t)}},_fulfill:function(t){this._status>y.RESOLVED||(this._status=y.FULFILLED,this._value=t,this._callCallbacks(this._fulfilledCallbacks,t),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=a)},_reject:function(t){if(!(this._status>y.RESOLVED)){if(this._status=y.REJECTED,this._value=t,this._callCallbacks(this._rejectedCallbacks,t),!this._rejectedCallbacks.length){var e=this;l(function(){e._shouldEmitUnhandledRejection&&b(t,e)})}this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=a}},_notify:function(t){this._callCallbacks(this._progressCallbacks,t)},_addCallbacks:function(t,e,n,i,r){n&&!u(n)?(r=n,n=a):i&&!u(i)&&(r=i,i=a),n&&(this._shouldEmitUnhandledRejection=!1);var o;this.isRejected()||(o={defer:t,fn:u(e)?e:a,ctx:r},this.isFulfilled()?this._callCallbacks([o],this._value):this._fulfilledCallbacks.push(o)),this.isFulfilled()||(o={defer:t,fn:n,ctx:r},this.isRejected()?this._callCallbacks([o],this._value):this._rejectedCallbacks.push(o)),this._status<=y.RESOLVED&&this._progressCallbacks.push({defer:t,fn:i,ctx:r})},_callCallbacks:function(t,e){var n=t.length;if(n){var i=(this.isResolved(),this.isFulfilled()),r=this.isRejected();l(function(){for(var o,s,a,l=0;l<n;)if(o=t[l++],s=o.defer,a=o.fn){var h,u=o.ctx;try{h=u?a.call(u,e):a(e)}catch(t){s.reject(t);continue}i||r?s.resolve(h):s.notify(h)}else i?s.resolve(e):r?s.reject(e):s.notify(e)})}}};var _={cast:function(t){return C.cast(t)},all:function(t){return C.all(t)},allSettled:function(t){return C.allSettled(t)},race:function(t){return C.anyResolved(t)},resolve:function(t){return C.resolve(t)},reject:function(t){return C.reject(t)}};for(var S in _)_.hasOwnProperty(S)&&(w[S]=_[S]);var C={Deferred:x,Promise:w,defer:function(){return new x},when:function(t,e,n,i,r){return C.cast(t).then(e,n,i,r)},fail:function(t,e,n){return C.when(t,a,e,n)},always:function(t,e,n){return C.when(t).always(e,n)},progress:function(t,e,n){return C.when(t).progress(e,n)},spread:function(t,e,n,i){return C.when(t).spread(e,n,i)},done:function(t,e,n,i,r){C.when(t).done(e,n,i,r)},isPromise:function(t){return c(t)&&u(t.then)},cast:function(t){return t&&t._vow?t:C.resolve(t)},valueOf:function(t){return t&&u(t.valueOf)?t.valueOf():t},isFulfilled:function(t){return!t||!u(t.isFulfilled)||t.isFulfilled()},isRejected:function(t){return!(!t||!u(t.isRejected))&&t.isRejected()},isResolved:function(t){return!t||!u(t.isResolved)||t.isResolved()},resolve:function(t){var e=C.defer();return e.resolve(t),e.promise()},fulfill:function(t){var e=C.defer(),n=e.promise();return e.resolve(t),n.isFulfilled()?n:n.then(null,function(t){return t})},reject:function(t){var e=C.defer();return e.reject(t),e.promise()},invoke:function(t,e){var n,i=Math.max(arguments.length-1,0);if(i){n=Array(i);for(var o=0;o<i;)n[o++]=arguments[o]}try{return C.resolve(n?t.apply(r,n):t.call(r))}catch(t){return C.reject(t)}},all:function(t){var e=new x,n=d(t),i=n?g(t):p(t),r=i.length,o=n?[]:{};if(!r)return e.resolve(o),e.promise();var s=r;return C._forEach(t,function(t,n){o[i[n]]=t,--s||e.resolve(o)},e.reject,e.notify,e,i),e.promise()},allResolved:function(t){var e=new x,n=d(t),i=n?g(t):p(t),r=i.length,o=n?[]:{};if(!r)return e.resolve(o),e.promise();var s=function(){--r||e.resolve(t)};return C._forEach(t,s,s,e.notify,e,i),e.promise()},allSettled:function(t){return C.allResolved(t).then(function(){for(var e,n,i,r=d(t),o=r?g(t):p(t),s=r?[]:{},a=o.length,l=0;l<a;)e=o[l++],promise=t[e],n=promise.valueOf(),i=promise.isRejected()?{status:"rejected",reason:n}:{status:"fulfilled",value:n},r?s.push(i):s[e]=i;return s})},allPatiently:function(t){return C.allResolved(t).then(function(){var e,n,i,r,o=d(t),s=o?g(t):p(t),a=s.length,l=0;if(!a)return o?[]:{};for(;l<a;)i=s[l++],r=t[i],C.isRejected(r)?(e||(e=o?[]:{}),o?e.push(r.valueOf()):e[i]=r.valueOf()):e||((n||(n=o?[]:{}))[i]=C.valueOf(r));if(e)throw e;return n})},any:function(t){var e=new x,n=t.length;if(!n)return e.reject(Error()),e.promise();var i,r=0;return C._forEach(t,e.resolve,function(t){r||(i=t),++r===n&&e.reject(i)},e.notify,e),e.promise()},anyResolved:function(t){var e=new x,n=t.length;return n?(C._forEach(t,e.resolve,e.reject,e.notify,e),e.promise()):(e.reject(Error()),e.promise())},delay:function(t,e){return C.resolve(t).delay(e)},timeout:function(t,e){return C.resolve(t).timeout(e)},_forEach:function(t,e,n,i,r,o){for(var s=o?o.length:t.length,a=0;a<s;)C.when(t[o?o[a]:a],v(e,a),n,i,r),++a},TimedOutError:m("TimedOut")},E=!0;"object"==typeof t&&"object"==typeof t.exports&&(t.exports=C,E=!1),"object"==typeof modules&&u(modules.define)&&(modules.define("vow",function(t){t(C)}),E=!1),i=function(t,e,n){n.exports=C}.call(e,n,e,t),!(void 0!==i&&(t.exports=i)),E=!1,E&&(r.vow=C)}("undefined"!=typeof window?window:r)}).call(e,function(){return this}(),n(51),n(137).setImmediate)},function(t,e){function n(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}t.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},function(t,e){function n(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)i.call(n,r)&&(t[r]=n[r])}return t}t.exports=n;var i=Object.prototype.hasOwnProperty},function(t,e,n){function i(t){return n(r(t))}function r(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./colorscheme":22,"./colorscheme.js":22,"./columns":23,"./columns.js":23,"./config":24,"./config.js":24,"./package":25,"./package.js":25,"./selection/Selection":8,"./selection/Selection.js":8,"./selection/SelectionCol":9,"./selection/SelectionCol.js":9,"./selection/index":41,"./selection/index.js":41,"./user":26,"./user.js":26,"./visOrdering":27,"./visOrdering.js":27,"./visibility":28,"./visibility.js":28,"./zoomer":29,"./zoomer.js":29};i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=141},function(t,e,n){function i(t){return n(r(t))}function r(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./bmath":12,"./bmath.js":12,"./export":13,"./export.js":13,"./file":14,"./file.js":14,"./index":34,"./index.js":34,"./loader":15,"./loader.js":15,"./proxy":16,"./proxy.js":16,"./seqgen":35,"./seqgen.js":35,"./svg":10,"./svg.js":10,"./tree":36,"./tree.js":36};i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=142}]);
//# sourceMappingURL=msa.js.map