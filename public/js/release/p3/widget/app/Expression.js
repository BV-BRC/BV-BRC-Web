require({cache:{
'url:p3/widget/app/templates/Expression.html':"<form dojoAttachPoint=\"containerNode\" class=\"PanelForm App ${baseClass}\"\n      dojoAttachEvent=\"onreset:_onReset,onsubmit:_onSubmit,onchange:validate\">\n\n    <div class=\"appTemplate\" style=\"width: 670px\">\n        <div class=\"appTitle\">\n            <span class=\"breadcrumb\">Services</span>\n            <h3>Differential Expression Import\n              <div name=\"overview\" class=\"infobox iconbox infobutton dialoginfo\">\n                  <i class=\"fa icon-info-circle fa\" title=\"click to open info dialog\"></i>\n              </div>\n              <div class=\"infobox iconbox tutorialButton tutorialInfo\">\n                <i class=\"fa icon-books fa-1x\" title=\"click to open tutorial\"></i>\n              </div>\n            </h3>\n            <p>Transform differential expression data for viewing on PATRIC</p>\n        </div>\n\n        <div class=\"formFieldsContainer\">\n            <table class=\"assemblyblocks\">\n                <tr>\n                    <td>\n                        <div style=\"width:300px\" class=\"appBox appShadow\">\n                            <div class=\"headerrow\">\n                                <div style=\"width:85%;display:inline-block;\">\n                                    <label class=\"appBoxLabel\">Experiment Data</label>\n                                    <div name=\"data-information\" class=\"infobox iconbox infobutton dialoginfo\">\n                                        <i class=\"fa icon-info-circle fa\" title=\"click to open info dialog\"></i>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <div style=\"text-align:left;\">\n                                    <label>Experiment Data File</label><br>\n                                    <div data-dojo-type=\"p3/widget/WorkspaceObjectSelector\"\n                                         data-dojo-attach-point=\"xfile\" name=\"xfile\" style=\"width:100%\" required=\"true\"\n                                         data-dojo-props=\"type:['expression_gene_matrix', 'expression_gene_list', 'diffexp_input_data'],multi:false,promptMessage:'Select or Upload an comparison data file to your workspace',missingMessage:'An comparison file must be provided.'\"></div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <div class=\"halfAppRow\">\n                                    <label>Experiment Type</label><br>\n                                    <select data-dojo-type=\"dijit/form/Select\" name=\"data_type\" style=\"width:100%\"\n                                            required=\"true\"\n                                            data-dojo-props=\"intermediateChanges:true,missingMessage:'Name Must be provided for Folder',trim:true,placeHolder:'MySubFolder'\">\n                                        <option value=\"transcriptomics\">Transcriptomics</option>\n                                        <option value=\"proteomics\">Proteomics</option>\n                                        <option value=\"phenomics\">Phenomics</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div class=\"appRow\">\n                                <div class=\"halfAppRow\">\n                                    <label>Genome Type</label><br>\n                                    <select data-dojo-type=\"dijit/form/Select\" name=\"host\" style=\"width:100%\"\n                                            required=\"true\">\n                                        <option selected=\"true\" value=\"false\">Bacteria or Archaea</option>\n                                        <option value=\"true\">Eukaryotic host</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div class=\"appRow\">\n                                <div class=\"halfAppRow\">\n                                    <label>Source ID Type</label><br>\n                                    <select data-dojo-type=\"dijit/form/Select\" name=\"source_id_type\" style=\"width:100%\"\n                                            required=\"true\">\n                                        <option selected=\"true\" value=\"patric_id\">PATRIC ID</option>\n                                        <option value=\"feature_id\">PATRIC Feature ID</option>\n                                        <option value=\"gi\">NCBI GI Number</option>\n                                        <option value=\"gene_id\">NCBI Gene ID</option>\n                                        <option value=\"protein_id\">NCBI Protein ID</option>\n                                        <option value=\"refseq_locus_tag\">Refseq Locus Tag</option>\n                                        <option value=\"alt_locus_tag\">Alt. Locus Tag</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div class=\"appRow\">\n                                <div class=\"text-align:left;\">\n                                    <label>Target Genome</label><br>\n                                    <div data-dojo-type=\"p3/widget/GenomeNameSelector\" name=\"genome_id\" maxHeight=200\n                                         style=\"width:90%\" data-dojo-props=\"placeHolder: 'Optional'\" , required=\"false\"\n                                         data-dojo-attach-point=\"genome_nameWidget\"></div>\n                                </div>\n                            </div>\n\n                        </div>\n                    </td>\n                    <td rowspan=\"2\">\n                        <div id=\"experimentBox\" style=\"margin-left:0px\" class=\"appBox appShadow\">\n                            <div class=\"headerrow\">\n                                <div style=\"width:85%;display:inline-block;\">\n                                    <label class=\"appBoxLabel\">Experiment Information</label>\n                                    <div name=\"experiment-information\" class=\"infobox iconbox infobutton tooltipinfo\">\n                                        <i class=\"fa icon-question-circle fa\"></i>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <div class=\"appField\">\n                                    <label>Experiment Title</label><br>\n                                    <div data-dojo-attach-point=\"output_nameWidget\"\n                                         data-dojo-type=\"p3/widget/WorkspaceFilenameValidationTextBox\"\n                                         name=\"experiment_title\" style=\"width:100%\" required=\"true\"\n                                         data-dojo-props=\"intermediateChanges:true,promptMessage:'Title of the experiment',missingMessage:'Experiment title must be provided',trim:true,placeHolder:'Title'\"></div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <div class=\"appField\">\n                                    <label>Experiment Description</label><br>\n                                    <div data-dojo-type=\"dijit/form/ValidationTextBox\" name=\"experiment_description\"\n                                         style=\"width:100%\" required=\"true\"\n                                         data-dojo-props=\"intermediateChanges:true,promptMessage:'Description of the experiment.',missingMessage:'Experiment description must be provided.',trim:true,placeHolder:'Description'\"></div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <div class=\"appField\">\n                                    <label>Organism Name</label><br>\n                                    <div data-dojo-type=\"p3/widget/TaxonNameSelector\" name=\"organism\" maxHeight=200\n                                         style=\"width:100%\" required=\"false\"\n                                         data-dojo-attach-point=\"scientific_nameWidget\"></div>\n                                </div>\n                            </div>\n\n                            <div class=\"appRow\">\n                                <div class=\"appField\">\n                                    <label>Pubmed ID</label><br>\n                                    <div data-dojo-type=\"dijit/form/ValidationTextBox\" name=\"pmid\" style=\"width:100%\"\n                                         required=\"false\"\n                                         data-dojo-props=\"intermediateChanges:true,promptMessage:'Pubmed ID is optional',missingMessage:'A taxonmic name must be provided.',trim:true,placeHolder:'Optional'\"></div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <label>Output Folder</label><br>\n                                <div data-dojo-attach-point=\"output_pathWidget\"\n                                     data-dojo-type=\"p3/widget/WorkspaceObjectSelector\" name=\"output_path\"\n                                     style=\"width:100%\" required=\"true\"\n                                     data-dojo-props=\"type:['folder'],multi:false,value:'${activeWorkspacePath}',workspace:'${activeWorkspace}',promptMessage:'The output folder for your Annotation Results',missingMessage:'Output Folder must be selected.'\"\n                                     data-dojo-attach-event=\"onChange:onOutputPathChange\"></div>\n                            </div>\n\n                        </div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>\n                        <div id=\"metaBox\" style=\"width:300px\" class=\"appBox appShadow\">\n                            <div class=\"headerrow\">\n                                <div style=\"width:85%;display:inline-block;\">\n                                    <label class=\"appBoxLabel\">Optional Metadata</label>\n                                    <div name=\"optional-metadata\" class=\"infobox iconbox infobutton dialoginfo\">\n                                        <i class=\"fa icon-info-circle fa\" title=\"click to open info dialog\"></i>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"appRow\">\n                                <label>Metadata File</label><br>\n                                <div data-dojo-type=\"p3/widget/WorkspaceObjectSelector\" name=\"mfile\" style=\"width:100%\"\n                                     required=\"false\"\n                                     data-dojo-props=\"type:['expression_experiment_metadata', 'diffexp_input_metadata'],multi:false,promptMessage:'Select or Upload an comparison data file to your workspace',missingMessage:'Comparison metadata is optional.'\"></div>\n                            </div>\n                        </div>\n                    </td>\n            </table>\n        </div>\n    </div>\n\n    <div class=\"appSubmissionArea\">\n\n        <div data-dojo-attach-point=\"workingMessage\" class=\"messageContainer workingMessage\"\n             style=\"margin-top:10px; text-align:center;\">\n            Converting Expression Data\n        </div>\n\n        <div data-dojo-attach-point=\"errorMessage\" class=\"messageContainer errorMessage\"\n             style=\"margin-top:10px; text-align:center;\">\n            Error Submitting Job\n        </div>\n        <div data-dojo-attach-point=\"submittedMessage\" class=\"messageContainer submittedMessage\"\n             style=\"margin-top:10px; text-align:center;\">\n            Conversion should be finished shortly. Check workspace for results.\n        </div>\n        <div style=\"margin-top: 10px; text-align:center;\">\n            <div data-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"onClick:onCancel\"\n                 data-dojo-type=\"dijit/form/Button\">Cancel\n            </div>\n            <div data-dojo-attach-point=\"resetButton\" type=\"reset\" data-dojo-type=\"dijit/form/Button\">Reset</div>\n            <div data-dojo-attach-point=\"submitButton\" type=\"submit\" data-dojo-type=\"dijit/form/Button\">Submit</div>\n        </div>\n    </div>\n</form>\n"}});
define("p3/widget/app/Expression", [
	"dojo/_base/declare", "dijit/_WidgetBase", "dojo/on",
	"dojo/dom-class", "dijit/_TemplatedMixin", "dijit/_WidgetsInTemplateMixin",
	"dojo/text!./templates/Expression.html", "./AppBase", "p3/widget/WorkspaceFilenameValidationTextBox", "../../WorkspaceManager"
], function(declare, WidgetBase, on,
			domClass, Templated, WidgetsInTemplate,
			Template, AppBase, WorkspaceFilenameValidationTextBox, WorkspaceManager){
	return declare([AppBase], {
		"baseClass": "Expression",
		templateString: Template,
		applicationName: "DifferentialExpression",
		applicationHelp: "user_guide/differential_expression_data_and_tools/expression_data_import_service.html",
		tutorialLink: "tutorial/expression_import/expression_import.html",
		pageTitle: "Differential Expression Import",
		defaultPath: "",
		constructor: function(){
			this._selfSet = true;
		},
		startup: function(){
			var _self = this;
			if(this._started){
				return;
			}
			this.inherited(arguments);
			_self.defaultPath = WorkspaceManager.getDefaultFolder("experiment_folder") || _self.activeWorkspacePath;
			_self.output_pathWidget.set('value', _self.defaultPath);
		},
		getValues: function(){
			var values = this.inherited(arguments);
			var exp_values = {};
			var ustring_keys = ["xformat", "source_id_type", "data_type", "experiment_title", "experiment_description", "organism", "metadata_format", "genome_id","pmid"];
			var ustring = {};
			ustring_keys.forEach(function(k){
				ustring[k] = values[k];
			});
			//get xsetup from object type
			ustring["xsetup"] = this.xfile.searchBox.get("item").type == 'expression_gene_matrix' ? 'gene_matrix' : 'gene_list'; // should be this.xfile.get("selection").type but need to fix on quick drop
			ustring["organism"] = this.scientific_nameWidget.get('displayedValue');
			ustring["host"] = false;
			if (values["host"] == "true"){
				ustring["host"] = true;
			}
			exp_values["ustring"] = JSON.stringify(ustring);
			exp_values["xfile"] = values["xfile"];
			exp_values["mfile"] = values["mfile"];
			exp_values["output_path"] = values["output_path"];
			exp_values["output_file"] = values["experiment_title"];

			return exp_values;
		}

	});
});
